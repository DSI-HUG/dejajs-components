(function(e,n){"use strict";var r=function(e,n){return Reflect.getMetadata(T,e,n)};var t=function(e,n){var t=r(e,n);if(t!=undefined&&t.name!=undefined){return t.name}else{return n}};function a(e){return i(T,e)}function i(e,n){return Reflect.metadata(e,n)}function u(e){switch(e){case o.STRING_TYPE:return true;case o.NUMBER_TYPE:return true;case o.BOOLEAN_TYPE:return true;case o.DATE_TYPE:return true;case o.STRING_TYPE_LOWERCASE:return true;case o.NUMBER_TYPE_LOWERCASE:return true;case o.BOOLEAN_TYPE_LOWERCASE:return true;case o.DATE_TYPE_LOWERCASE:return true;default:false}}function E(e){return e.toString().trim().split(/[\s\()]/g)[1]}function s(e,n){return Reflect.getMetadata("design:type",e,n)}function f(e,n){return Array==s(e,n)}function c(e,n){var r=s(e,n);if(r!=undefined){return E(r)}return r}var o={OBJECT_TYPE:"Object",OBJECT_TYPE_LOWERCASE:"object",STRING_TYPE:"String",STRING_TYPE_LOWERCASE:"string",NUMBER_TYPE:"Number",NUMBER_TYPE_LOWERCASE:"number",BOOLEAN_TYPE:"Boolean",BOOLEAN_TYPE_LOWERCASE:"boolean",DATE_TYPE:"Date",DATE_TYPE_LOWERCASE:"date",ARRAY_TYPE:"Array",ARRAY_TYPE_LOWERCASE:"array",FROM_ARRAY:"fromArray"};var T="JsonProperty";var _;(function(e){e[e["READ_ONLY"]=0]="READ_ONLY";e[e["WRITE_ONLY"]=1]="WRITE_ONLY";e[e["BOTH"]=2]="BOTH"})(_||(_={}));function d(e){if(typeof e==="string"){return a({name:e,required:false,access:_.BOTH})}else{return a(e)}}function v(e,n){this.json=n;this.message=e;this.stack=(new Error).stack}v.prototype=new Error;var A=function(e,n){return n===o.DATE_TYPE?new Date(e):e};var O=function(e,n,r,t,a){try{e[n]=t[a];return[]}catch(r){throw new v("Property '"+n+"' of "+e.constructor["name"]+" does not match datatype of "+a,t)}};var R=function(e,n,r,t,a){try{e[n]=new Date(t[a]);return[]}catch(r){throw new v("Property '"+n+"' of "+e.constructor["name"]+" does not match datatype of "+a,t)}};var Y=function(e,n,r,t,a){var i=t[a].length;var s=new Array;if(i>0){var f=[];e[n]=f;for(var c=0;c<i;c++){var T=E(r);if(!u(T)){var _=new r;s.push({functionName:o.OBJECT_TYPE,instance:_,json:t[a][c]});f.push(_)}else{f.push(P[o.FROM_ARRAY](t[a][c],T))}}}return s};var p=function(e,n,t,a,i){var s=new Array;var T;if(n!=undefined){T=new t;e[n]=T}else{T=e}Object.keys(T).forEach(function(e){var n=r(T,e);if(n===undefined){n={name:e,required:false,access:_.BOTH}}if(_.WRITE_ONLY!=n.access){if(n.required&&a[n.name]===undefined){throw new v("JSON structure does have have required property '"+n.name+"' as required by '"+E(T)+"["+e+"]",a)}var t=n.name!=undefined?n.name:e;if(a[t]!=undefined){if(n.type===undefined){T[e]=a[t]}else{if(!f(T,e)){var i=c(T,e);if(!u(i)){T[e]=new n.type;s.push({functionName:o.OBJECT_TYPE,type:n.type,instance:T[e],json:a[t]})}else{P[i](T,e,i,a,t)}}else{var d=P[o.ARRAY_TYPE](T,e,n.type,a,t);d.forEach(function(e){s.push(e)})}}}}});return s};var P=new Object;P[o.OBJECT_TYPE]=p;P[o.ARRAY_TYPE]=Y;P[o.DATE_TYPE]=R;P[o.STRING_TYPE]=O;P[o.NUMBER_TYPE]=O;P[o.BOOLEAN_TYPE]=O;P[o.FROM_ARRAY]=A;P[o.OBJECT_TYPE_LOWERCASE]=p;P[o.ARRAY_TYPE_LOWERCASE]=Y;P[o.DATE_TYPE_LOWERCASE]=R;P[o.STRING_TYPE_LOWERCASE]=O;P[o.NUMBER_TYPE_LOWERCASE]=O;P[o.BOOLEAN_TYPE_LOWERCASE]=O;var l=function(e,n,r){var t=new Object;var a=n.instance;n.visited=true;a.forEach(function(e){if(e!=undefined){if(!u(typeof e)){var a={id:j(),type:o.OBJECT_TYPE,instance:e,parentIndex:r,values:new Array,key:undefined,visited:false};t[a.id]=a}else{n.values.push(m[typeof e](undefined,e))}}});return y(t)};var y=function(e){var n=new Array;Object.keys(e).forEach(function(r){n.push(e[r])});return n};var h=function(e,n){return(e!=undefined?'"'+e+'":':"")+"{"+n.join()+"}"};var C=function(e,n){return(e!=undefined?'"'+e+'":':"")+"["+n.join()+"]"};var L=function(e,n){N(e);n.values.push(e.values.pop())};var N=function(e){var n;if(e.type===o.OBJECT_TYPE){n=h(e.key,e.values)}else{n=C(e.key,e.values)}e.values=[];e.values.push(n)};var B=function(e,n,a){var i=new Object;n.visited=true;Object.keys(n.instance).forEach(function(e){var E=n.instance[e];if(E!=undefined){var s=r(n.instance,e);if(s!=undefined&&_.READ_ONLY==s.access){}else if(E instanceof Array){var f={id:j(),type:o.ARRAY_TYPE,instance:E,parentIndex:a,values:new Array,key:t(n.instance,e),visited:false};i[f.id]=f}else if(!u(typeof E)){var f={id:j(),type:o.OBJECT_TYPE,instance:E,parentIndex:a,values:new Array,key:t(n.instance,e),visited:false};i[f.id]=f}else{n.values.push(m[typeof E](t(n.instance,e),E))}}});return y(i)};var S=function(e,n){if(e!=undefined){return'"'+e+'":'+n}else{return n}};var w=function(e,n){return S(e,'"'+n+'"')};var W=function(e,n){return S(e,n.getTime())};var m=[];m[o.STRING_TYPE]=w;m[o.NUMBER_TYPE]=S;m[o.BOOLEAN_TYPE]=S;m[o.DATE_TYPE]=W;m[o.ARRAY_TYPE]=l;m[o.OBJECT_TYPE]=B;m[o.STRING_TYPE_LOWERCASE]=w;m[o.NUMBER_TYPE_LOWERCASE]=S;m[o.BOOLEAN_TYPE_LOWERCASE]=S;m[o.DATE_TYPE_LOWERCASE]=W;m[o.ARRAY_TYPE_LOWERCASE]=l;m[o.OBJECT_TYPE_LOWERCASE]=B;var j=function(){return Math.random()+"-"+Date.now()};(function(e){e.deserialize=function(e,n){var r=new e;var t={functionName:o.OBJECT_TYPE,instance:r,json:n};var a=new Array;a.push(t);while(t!=undefined){var i=P[t.functionName](t.instance,t.instanceKey,t.type,t.json,t.jsonKey);i.forEach(function(e){a.push(e)});t=a.pop()}return r};e.serialize=function(e){var n=new Array;var r={id:undefined,type:o.OBJECT_TYPE,instance:e,parentIndex:undefined,values:new Array,key:undefined,visited:false};n.push(r);do{var t=n[n.length-1];var a=n[n.length>1?t.parentIndex:0];if(t.visited){L(t,a);n.pop()}else{var i=m[t.type](a,t,n.length-1);if(i.length>0){i.forEach(function(e){n.push(e)})}else{if(n.length>1){L(t,a)}n.pop()}}}while(n.length>1);N(r);return r.values[0]}})(e.ObjectMapper||(e.ObjectMapper={}));var M={JsonProperty:d,JsonConverstionError:v};e["default"]=M})(this.ObjectMapper=this.ObjectMapper||{},Reflect);