"use strict";(self.webpackChunkdejajs_component=self.webpackChunkdejajs_component||[]).push([[325],{1092:(ce,q,u)=>{u.d(q,{D:()=>ee});var D=u(9947),O=u(6921),V=u(8889),X=u(9985);function ee(Y){return(0,D.e)((te,N)=>{let J=!1,i=null,S=null;const B=()=>{if(null==S||S.unsubscribe(),S=null,J){J=!1;const z=i;i=null,N.next(z)}};te.subscribe(new V.Q(N,z=>{null==S||S.unsubscribe(),J=!0,i=z,S=new V.Q(N,B,O.Z),(0,X.Xf)(Y(z)).subscribe(S)},()=>{B(),N.complete()},void 0,()=>{i=S=null}))})}},8014:(ce,q,u)=>{u.r(q),u.d(q,{DejaTilesDemoModule:()=>qe});var D=u(6019),O=u(9133),V=u(86),X=u(888),ee=u(904),Y=u(2605),te=u(8643),N=u(7858),J=u(8177),i=u(3668),S=u(6731),B=u(348),z=u(928),ge=u(9555);function me(l,g){if(1&l&&(i.O4$(),i._UZ(0,"circle",3)),2&l){const e=i.oxw();i.Udp("animation-name","mat-progress-spinner-stroke-rotate-"+e._spinnerAnimationLabel)("stroke-dashoffset",e._getStrokeDashOffset(),"px")("stroke-dasharray",e._getStrokeCircumference(),"px")("stroke-width",e._getCircleStrokeWidth(),"%"),i.uIk("r",e._getCircleRadius())}}function ue(l,g){if(1&l&&(i.O4$(),i._UZ(0,"circle",3)),2&l){const e=i.oxw();i.Udp("stroke-dashoffset",e._getStrokeDashOffset(),"px")("stroke-dasharray",e._getStrokeCircumference(),"px")("stroke-width",e._getCircleStrokeWidth(),"%"),i.uIk("r",e._getCircleRadius())}}const fe=(0,S.pj)(class{constructor(l){this._elementRef=l}},"primary"),xe=new i.OlP("mat-progress-spinner-default-options",{providedIn:"root",factory:function(){return{diameter:100}}});class A extends fe{constructor(g,e,t,n,s){super(g),this._document=t,this._diameter=100,this._value=0,this.mode="determinate";const o=A._diameters;this._spinnerAnimationLabel=this._getSpinnerAnimationLabel(),o.has(t.head)||o.set(t.head,new Set([100])),this._noopAnimations="NoopAnimations"===n&&!!s&&!s._forceAnimations,s&&(s.diameter&&(this.diameter=s.diameter),s.strokeWidth&&(this.strokeWidth=s.strokeWidth))}get diameter(){return this._diameter}set diameter(g){this._diameter=(0,B.su)(g),this._spinnerAnimationLabel=this._getSpinnerAnimationLabel(),this._styleRoot&&this._attachStyleNode()}get strokeWidth(){return this._strokeWidth||this.diameter/10}set strokeWidth(g){this._strokeWidth=(0,B.su)(g)}get value(){return"determinate"===this.mode?this._value:0}set value(g){this._value=Math.max(0,Math.min(100,(0,B.su)(g)))}ngOnInit(){const g=this._elementRef.nativeElement;this._styleRoot=(0,z.kV)(g)||this._document.head,this._attachStyleNode(),g.classList.add("mat-progress-spinner-indeterminate-animation")}_getCircleRadius(){return(this.diameter-10)/2}_getViewBox(){const g=2*this._getCircleRadius()+this.strokeWidth;return`0 0 ${g} ${g}`}_getStrokeCircumference(){return 2*Math.PI*this._getCircleRadius()}_getStrokeDashOffset(){return"determinate"===this.mode?this._getStrokeCircumference()*(100-this._value)/100:null}_getCircleStrokeWidth(){return this.strokeWidth/this.diameter*100}_attachStyleNode(){const g=this._styleRoot,e=this._diameter,t=A._diameters;let n=t.get(g);if(!n||!n.has(e)){const s=this._document.createElement("style");s.setAttribute("mat-spinner-animation",this._spinnerAnimationLabel),s.textContent=this._getAnimationText(),g.appendChild(s),n||(n=new Set,t.set(g,n)),n.add(e)}}_getAnimationText(){const g=this._getStrokeCircumference();return"\n @keyframes mat-progress-spinner-stroke-rotate-DIAMETER {\n    0%      { stroke-dashoffset: START_VALUE;  transform: rotate(0); }\n    12.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(0); }\n    12.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(72.5deg); }\n    25%     { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(72.5deg); }\n\n    25.0001%   { stroke-dashoffset: START_VALUE;  transform: rotate(270deg); }\n    37.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(270deg); }\n    37.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(161.5deg); }\n    50%     { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(161.5deg); }\n\n    50.0001%  { stroke-dashoffset: START_VALUE;  transform: rotate(180deg); }\n    62.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(180deg); }\n    62.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(251.5deg); }\n    75%     { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(251.5deg); }\n\n    75.0001%  { stroke-dashoffset: START_VALUE;  transform: rotate(90deg); }\n    87.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(90deg); }\n    87.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(341.5deg); }\n    100%    { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(341.5deg); }\n  }\n".replace(/START_VALUE/g,""+.95*g).replace(/END_VALUE/g,""+.2*g).replace(/DIAMETER/g,`${this._spinnerAnimationLabel}`)}_getSpinnerAnimationLabel(){return this.diameter.toString().replace(".","_")}}A._diameters=new WeakMap,A.\u0275fac=function(g){return new(g||A)(i.Y36(i.SBq),i.Y36(z.t4),i.Y36(D.K0,8),i.Y36(ge.Qb,8),i.Y36(xe))},A.\u0275cmp=i.Xpm({type:A,selectors:[["mat-progress-spinner"]],hostAttrs:["role","progressbar","tabindex","-1",1,"mat-progress-spinner"],hostVars:10,hostBindings:function(g,e){2&g&&(i.uIk("aria-valuemin","determinate"===e.mode?0:null)("aria-valuemax","determinate"===e.mode?100:null)("aria-valuenow","determinate"===e.mode?e.value:null)("mode",e.mode),i.Udp("width",e.diameter,"px")("height",e.diameter,"px"),i.ekj("_mat-animation-noopable",e._noopAnimations))},inputs:{color:"color",diameter:"diameter",strokeWidth:"strokeWidth",mode:"mode",value:"value"},exportAs:["matProgressSpinner"],features:[i.qOj],decls:3,vars:8,consts:[["preserveAspectRatio","xMidYMid meet","focusable","false","aria-hidden","true",3,"ngSwitch"],["cx","50%","cy","50%",3,"animation-name","stroke-dashoffset","stroke-dasharray","stroke-width",4,"ngSwitchCase"],["cx","50%","cy","50%",3,"stroke-dashoffset","stroke-dasharray","stroke-width",4,"ngSwitchCase"],["cx","50%","cy","50%"]],template:function(g,e){1&g&&(i.O4$(),i.TgZ(0,"svg",0),i.YNc(1,me,1,9,"circle",1),i.YNc(2,ue,1,7,"circle",2),i.qZA()),2&g&&(i.Udp("width",e.diameter,"px")("height",e.diameter,"px"),i.Q6J("ngSwitch","indeterminate"===e.mode),i.uIk("viewBox",e._getViewBox()),i.xp6(1),i.Q6J("ngSwitchCase",!0),i.xp6(1),i.Q6J("ngSwitchCase",!1))},directives:[D.RF,D.n9],styles:[".mat-progress-spinner{display:block;position:relative;overflow:hidden}.mat-progress-spinner svg{position:absolute;transform:rotate(-90deg);top:0;left:0;transform-origin:center;overflow:visible}.mat-progress-spinner circle{fill:transparent;transform-origin:center;transition:stroke-dashoffset 225ms linear}._mat-animation-noopable.mat-progress-spinner circle{transition:none;animation:none}.cdk-high-contrast-active .mat-progress-spinner circle{stroke:CanvasText}.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate] svg{animation:mat-progress-spinner-linear-rotate 2000ms linear infinite}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate] svg{transition:none;animation:none}.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate] circle{transition-property:stroke;animation-duration:4000ms;animation-timing-function:cubic-bezier(0.35, 0, 0.25, 1);animation-iteration-count:infinite}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate] circle{transition:none;animation:none}@keyframes mat-progress-spinner-linear-rotate{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes mat-progress-spinner-stroke-rotate-100{0%{stroke-dashoffset:268.606171575px;transform:rotate(0)}12.5%{stroke-dashoffset:56.5486677px;transform:rotate(0)}12.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(72.5deg)}25%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(72.5deg)}25.0001%{stroke-dashoffset:268.606171575px;transform:rotate(270deg)}37.5%{stroke-dashoffset:56.5486677px;transform:rotate(270deg)}37.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(161.5deg)}50%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(161.5deg)}50.0001%{stroke-dashoffset:268.606171575px;transform:rotate(180deg)}62.5%{stroke-dashoffset:56.5486677px;transform:rotate(180deg)}62.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(251.5deg)}75%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(251.5deg)}75.0001%{stroke-dashoffset:268.606171575px;transform:rotate(90deg)}87.5%{stroke-dashoffset:56.5486677px;transform:rotate(90deg)}87.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(341.5deg)}100%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(341.5deg)}}\n"],encapsulation:2,changeDetection:0});let be=(()=>{class l{}return l.\u0275fac=function(e){return new(e||l)},l.\u0275mod=i.oAB({type:l}),l.\u0275inj=i.cJS({imports:[[S.BQ,D.ez],S.BQ]}),l})();var le=u(4396),x=u(1850),W=u(4499),ye=u(559),_=u(273);let oe=(()=>{class l{constructor(e){this.cutted$=new W.X(!1),this.dragging$=new W.X(!1),this.dropping$=new W.X(!1),this.pressed$=new W.X(!1),this.selected$=new W.X(!1),this.hidden$=new ye.t(1),this.pixelBounds$=new W.X(null),this.deleted$=new _.x,this.refresh$=new _.x,this.isTemporary=!1,this._isDragging=!1,this._isDropping=!1,this._isPressed=!1,this._isHidden=!1,this._id=e||"#"+l.CURRENT_ID++}get idealBounds(){return new x.U(0,0,15,15)}set pixelBounds(e){x.U.equals(this._pixelBounds,e)||(this._pixelBounds=e,this.pixelBounds$.next(e))}get pixelBounds(){return this._pixelBounds}set percentBounds(e){this._percentBounds=e}get percentBounds(){return this._percentBounds}set templateModel(e){this._templateModel=e}get templateModel(){return this._templateModel}get id(){return this._id}set isCutted(e){this._cutted!==e&&(this._cutted=e,this.cutted$.next(e))}get isCutted(){return this._cutted}set color(e){this._color=e}get color(){return this._color}set isDragging(e){this._isDragging!==e&&(this._isDragging=e,this.dragging$.next(e))}get isDragging(){return this._isDragging}set isDropping(e){this._isDropping!==e&&(this._isDropping=e,this.dropping$.next(e))}get isDropping(){return this._isDropping}set isPressed(e){this._isPressed!==e&&(this._isPressed=e,this.pressed$.next(e))}get isPressed(){return this._isPressed}set isSelected(e){this._selected!==e&&(this._selected=e,this.selected$.next(e))}get isSelected(){return this._selected}set isHidden(e){this._isHidden!==e&&(this._isHidden=e,this.hidden$.next(e))}get isHidden(){return this._isHidden}set isPending(e){this._pending=e}get isPending(){return this._pending}get fading(){return this._fading}set fading(e){this._fading=e}makeId(){this._id="#"+l.CURRENT_ID++}equalsTo(e){return this._templateModel?this._templateModel===e._templateModel:this._id===e._id}clone(e){return e||(e=new l(this.id)),e._percentBounds=this.percentBounds,e._color=this.color,e._templateModel=this.templateModel,e._cutted=this._cutted,e._selected=this._selected,e._pending=this._pending,e._fading=this._fading,e}delete(){this.deleted$.next()}refresh(){this.refresh$.next()}}return l.CURRENT_ID=0,l})();var j=u(4986),y=u(461),U=u(9468),M=u(7384),Q=u(8660),f=u(6263),K=u(9463);function _e(l,g){}function Me(l,g){if(1&l&&i._UZ(0,"mat-progress-spinner",2),2&l){const e=i.oxw();i.Q6J("diameter",e.progressDiameter)}}const we=function(l){return{$implicit:l}};let Ce=(()=>{class l extends j.yl{constructor(e,t){super(),this.changeDetectorRef=t,this.close=new i.vpe,this.progressDiameter=100,this.element=e.nativeElement,this.element.setAttribute("hidden","0")}set tile(e){if(this._tile=e,e){const t=(s,o)=>{o?this.element.setAttribute(s,o.toString()):this.element.removeAttribute(s)};e.fading&&(this.element.setAttribute("fading","0"),this.changeDetectorRef.markForCheck()),e.pixelBounds$.pipe((0,y.h)(s=>!!s),(0,U.q)(1),(0,y.h)(()=>e.fading),(0,M.b)(()=>{this.element.setAttribute("fading","1"),this.changeDetectorRef.markForCheck()}),(0,Q.g)(200),(0,f.R)(this.destroyed$)).subscribe(()=>{this.element.removeAttribute("fading"),this.changeDetectorRef.markForCheck()}),e.pixelBounds$.pipe((0,y.h)(s=>!!s),(0,f.R)(this.destroyed$)).subscribe(s=>{e.isHidden||this.element.removeAttribute("hidden"),this.element.style.left=`${s.left}px`,this.element.style.top=`${s.top}px`,this.element.style.width=`${s.width}px`,this.element.style.height=`${s.height}px`,this.progressDiameter=Math.min(100,Math.round(Math.max(.4*s.width,.4*s.height))),this.changeDetectorRef.markForCheck()}),e.pressed$.pipe((0,M.b)(s=>t("pressed",s)),(0,f.R)(this.destroyed$)).subscribe(()=>this.changeDetectorRef.markForCheck()),e.selected$.pipe((0,M.b)(s=>t("selected",s)),(0,f.R)(this.destroyed$)).subscribe(()=>this.changeDetectorRef.markForCheck()),e.dragging$.pipe((0,M.b)(s=>t("drag",s)),(0,f.R)(this.destroyed$)).subscribe(()=>this.changeDetectorRef.markForCheck()),e.dropping$.pipe((0,M.b)(s=>t("drop",s)),(0,f.R)(this.destroyed$)).subscribe(()=>this.changeDetectorRef.markForCheck()),e.cutted$.pipe((0,M.b)(s=>t("cutted",s)),(0,f.R)(this.destroyed$)).subscribe(()=>this.changeDetectorRef.markForCheck()),e.deleted$.pipe((0,M.b)(()=>this.element.remove()),(0,f.R)(this.destroyed$)).subscribe(()=>this.changeDetectorRef.markForCheck());const n=e.hidden$.pipe((0,M.b)(s=>t("hidden",s?"1":"2")));n.pipe((0,K.b)(1e3),(0,y.h)(s=>s),(0,M.b)(()=>this.element.setAttribute("hidden","0")),(0,f.R)(this.destroyed$)).subscribe(()=>this.changeDetectorRef.markForCheck()),n.pipe((0,K.b)(1),(0,y.h)(s=>!s),(0,M.b)(()=>this.element.removeAttribute("hidden")),(0,f.R)(this.destroyed$)).subscribe(()=>this.changeDetectorRef.markForCheck()),e.refresh$.pipe((0,K.b)(1),(0,f.R)(this.destroyed$)).subscribe(()=>this.changeDetectorRef.markForCheck())}}get tile(){return this._tile}}return l.\u0275fac=function(e){return new(e||l)(i.Y36(i.SBq),i.Y36(i.sBO))},l.\u0275cmp=i.Xpm({type:l,selectors:[["deja-tile"]],inputs:{template:"template",tile:"tile"},outputs:{close:"close"},features:[i.qOj],decls:2,vars:5,consts:[[3,"ngTemplateOutlet","ngTemplateOutletContext"],["mode","indeterminate","class","accent",3,"diameter",4,"ngIf"],["mode","indeterminate",1,"accent",3,"diameter"]],template:function(e,t){1&e&&(i.YNc(0,_e,0,0,"ng-template",0),i.YNc(1,Me,1,1,"mat-progress-spinner",1)),2&e&&(i.Q6J("ngTemplateOutlet",t.template)("ngTemplateOutletContext",i.VKq(3,we,t.tile)),i.xp6(1),i.Q6J("ngIf",t.tile&&t.tile.isPending))},directives:[D.tP,D.O5,A],styles:['[_nghost-%COMP%]{display:block;position:absolute;transition-property:left,top,opacity;transition-duration:.5s;transition-timing-function:ease;opacity:1}[expanded][_nghost-%COMP%]{transition-property:height}[cutted][_nghost-%COMP%]{opacity:.5}[drag][_nghost-%COMP%], [drop][_nghost-%COMP%]{z-index:100}[drag][_nghost-%COMP%]{opacity:.5;-webkit-user-select:none;-moz-user-select:none;user-select:none;transition:none}[fading="0"][_nghost-%COMP%]{opacity:0;transition:none}[fading="1"][_nghost-%COMP%]{opacity:0}[hidden="0"][_nghost-%COMP%]{visibility:hidden;transition:none}[hidden="1"][_nghost-%COMP%]{opacity:0;transition:1s ease-in-out opacity}[hidden="2"][_nghost-%COMP%]{visibility:visible;opacity:0;transition:none}[_nghost-%COMP%]   mat-progress-spinner[_ngcontent-%COMP%]{position:absolute;z-index:1;right:.2rem;bottom:.2rem;transform:translate(-60%,-60%)}'],changeDetection:0}),l})();var w=u(5576),v=(()=>{return(l=v||(v={}))[l.none=0]="none",l[l.left=1]="left",l[l.right=2]="right",l[l.top=4]="top",l[l.bottom=8]="bottom",l[l.horizontal=3]="horizontal",l[l.vertical=12]="vertical",l[l.all=15]="all",v;var l})();class ie{constructor(g,e){this.width=g||0,this.height=e||0}static equals(g,e){return g.width===e.width&&g.height===e.height}clone(){return new ie(this.width,this.height)}}var H=u(4753),se=u(5933),I=u(3067),k=u(5077),re=u(2997),R=u(7867),ae=u(6302),Pe=u(9417);let he=(()=>{class l extends j.yl{constructor(e){super(),this.clipboardService=e,this.refreshTiles$=new _.x,this.ensureVisible$=new _.x,this.ensureBounds$=new _.x,this.dragging$=new W.X(!1),this.dragSelection$=new _.x,this.dragDropInfos$=new _.x,this.selectionRect$=new _.x,this.dragover$=new _.x,this.dragleave$=new _.x,this.deleteTiles$=new _.x,this.designMode=!1,this.layoutCompleted=new _.x,this.layoutChanged=new _.x,this.tilesAdded=new _.x,this.tilesDeleted=new _.x,this.selectionChanged=new _.x,this.contentAdding=new _.x,this.contentRemoving=new _.x,this._tileMinWidth=10,this._tileMinWidthUnit="%",this._tileMaxWidth=100,this._tileMaxWidthUnit="%",this._tileMinHeight=10,this._tileMinHeightUnit="%",this._tileMaxHeight=100,this._tileMaxHeightUnit="%",this._maxWidth=100,this._maxWidthUnit="%",this.tilesDic=new Map,this._targetBounds=new x.U,this.destination=new x.U,this.dragPageOffset=new w.L,this.dragOriginalPosition=new w.L,this.selectedIds=new Array,this.refreshTiles$.pipe((0,K.b)(30),(0,M.b)(()=>{this.container.style.width="",this.container.style.height=""}),(0,Q.g)(10),(0,f.R)(this.destroyed$)).subscribe(s=>{const o=new Array,a=this.container.getBoundingClientRect();((null==s?void 0:s.resetWidth)||!this.hundredPercentWith)&&(this.hundredPercentWith=a.width);let r=a.height,h=a.width,c=0,d=0;const p=this.tiles||new Array,m=new Array;p.forEach(T=>{if(T.percentBounds&&!T.percentBounds.isEmpty()){const P=this.getPixelBounds(T.percentBounds);P.bottom>c&&(c=P.right),P.right>d&&(d=P.bottom),T.isDragging||(T.pixelBounds=P)}else o.push(T);T.isSelected&&!T.isHidden&&m.push(T.id),T.pixelBounds&&T.pixelBounds.bottom>r&&(r=T.pixelBounds.bottom)});let b=d,C=0;if(o.forEach(T=>{T.percentBounds=T.percentBounds||new x.U(this.getPercentSize(C),this.getPercentSize(b),3*this.getTileMinPercentWidth(),3*this.getTileMinPercentHeight());let P=this.getPixelBounds(T.percentBounds);P.right>h&&(b=d,C=0,T.percentBounds.left=0,T.percentBounds.top=this.getPercentSize(b),P=this.getPixelBounds(T.percentBounds)),P.bottom>d&&(d=P.bottom),T.pixelBounds=this.getPixelBounds(T.percentBounds),C+=P.width}),this.dragTarget){const T=this.getPixelBounds(this.dragTarget);r<=T.bottom&&(r=T.bottom+T.height),h<=T.right&&(h=T.right+T.width)}const Z=this.getPixelSize(2*this._tileMinHeight,this._tileMinHeightUnit);r<Z&&(r=Z),this.container.style.width=`${h}px`,this.container.style.height=`${r}px`,(null==s?void 0:s.ensureVisible)&&this.ensureVisible$.next(s.ensureVisible),(null==s?void 0:s.ensureBounds)&&this.ensureBounds$.next(s.ensureBounds),this.selectedTiles=m;const $=new CustomEvent("DejaTilesEvent",{cancelable:!1});o.length>0&&($.tiles=o,this.layoutChanged.next($)),$.tiles=p,this.layoutCompleted.next($)});const t=this.ensureVisible$.pipe((0,Q.g)(1),(0,H.U)(s=>this.tilesDic.get(s)),(0,y.h)(s=>!!s),(0,H.U)(s=>s.percentBounds));this.ensureBounds$.pipe((0,se.b)(t),(0,f.R)(this.destroyed$)).subscribe(s=>{const{left:o,right:a,top:r,bottom:h}=this.getPixelBounds(s),d=(b=>{for(;b&&"DEJA-TILES"!==b.tagName;)b=b.parentElement;return b})(this.container);if(!d)return;const p=this.container.getBoundingClientRect(),m=d.getBoundingClientRect();o+p.left<m.bottom?d.scrollLeft+=o+p.left-m.bottom:a+p.left>m.right&&(d.scrollLeft+=a+p.left-m.right),r+p.top<m.top?d.scrollTop+=r+p.top-m.top:h+p.top>m.bottom&&(d.scrollTop+=h+p.top-m.bottom)}),this.dragSelection$.pipe((0,I.w)(s=>{const o=(0,k.R)(this._container.ownerDocument,"mouseup").pipe((0,M.b)(()=>this.selectionRect$.next(null)));return(0,k.R)(this._container,"mousemove").pipe((0,f.R)(o),(0,y.h)(r=>1===r.buttons),(0,M.b)(r=>{const h=this._container.getBoundingClientRect();s.selectedRect=x.U.fromPoints(s.startPosition,new w.L(r.pageX-h.left,r.pageY-h.top)),this.selectionRect$.next(s.selectedRect);const c=this.hitTest(s.selectedRect);this.selectedTiles=c.map(d=>d.id)}))}),(0,f.R)(this.destroyed$)).subscribe();const n=this.dragleave$;this.dragDropInfos$.pipe((0,I.w)(s=>{var o;const a=s&&((null===(o=s.tiles)||void 0===o?void 0:o.length)&&s.tiles||s.currentTile&&[s.currentTile]);if(!a)return(0,re.of)(null);const r=!s.tiles,h=(0,k.R)(this._container,"mousemove"),d=(0,k.R)(this._container.ownerDocument,"keyup").pipe((0,y.h)($=>$.code===j.mW.Escape)),p=h.pipe((0,y.h)($=>1!==$.buttons)),m=n.pipe((0,se.b)(p,d),(0,M.b)(()=>{this.removeTemporaryTile(),this.cancelDrag(a)})),C=(0,k.R)(this._container.ownerDocument,"mouseup").pipe((0,M.b)(()=>this.drop(a))).pipe((0,se.b)(m)),Z=this.dragover$.pipe((0,H.U)($=>$.originalEvent));return h.pipe((0,se.b)(Z),(0,f.R)(C),(0,M.b)($=>{const T=this._container.getBoundingClientRect(),P=$.pageX-T.left,G=$.pageY-T.top;if(s.enabled)this.drag(a,P,G);else if(Math.abs(s.startX-P)>=15||Math.abs(s.startY-G)>=15)if(r){const E=s.currentTile;this.selectedTiles=[E.id];let L=E.percentBounds;(!L||L.isEmpty())&&(L=new x.U(0,0,15,15));const F=this.getFreePlace(new x.U(this.getPercentSize(P)-L.width/2,this.getPercentSize(G)-L.height/2,L.width,L.height));s.startX=F.left-L.width/2,s.startY=F.top-L.height/2,E.percentBounds=F,E.dragging$.next(!0),this._cursor="move",this.tiles.push(E),this.tilesDic.set(E.id,E),this.dragging$.next(!0),s.enabled=!0,this.startDrag(a,this.getPixelSize(F.left+F.width/2),this.getPixelSize(F.top+F.height/2))}else this.dragging$.next(!0),s.enabled=!0,this.startDrag(a,s.startX,s.startY)}))}),(0,f.R)(this.destroyed$)).subscribe(),this.deleteTiles$.pipe((0,f.R)(this.destroyed$)).subscribe(s=>this.deleteTiles(s))}set container(e){if(this._container=e,this._container){const t=(0,k.R)(e,"mouseleave"),n=(0,k.R)(e.ownerDocument,"mouseup"),s=(0,k.R)(e,"mouseenter");s.pipe((0,I.w)(()=>{if(this.designMode){const o=t.pipe((0,M.b)(()=>this.container.style.cursor=""));return(0,k.R)(e,"mousemove").pipe((0,f.R)(o),(0,y.h)(r=>!!this.container&&0===r.buttons),(0,H.U)(r=>this._cursor=this.getCursorFromHtmlElement(r.pageX,r.pageY,r.target)))}return(0,re.of)("")}),(0,f.R)(this.destroyed$)).subscribe(o=>this.container.style.cursor=o),s.pipe((0,I.w)(()=>(0,k.R)(e,"mousedown").pipe((0,y.h)(r=>1===r.buttons),(0,y.h)(r=>!this.isElementInsideDejaEditor(r.target)),(0,H.U)(r=>({event:r,clickedTile:this.getTileComponentFromHTMLElement(r.target)}))).pipe((0,f.R)(t),(0,I.w)(({event:r,clickedTile:h})=>{const c=r.target;if(this.currentTile&&(this.currentTile.isPressed=!1),this.currentTile=h,this.currentTile){if(this.currentTile.isPressed=!0,!r.ctrlKey&&((!this.currentTile.isSelected||"move"!==this._cursor)&&(this.selectedTiles=[this.currentTile.id]),this.designMode)){const d=this._container.getBoundingClientRect();this.dragDropInfos$.next({enabled:!1,startX:r.pageX-d.left,startY:r.pageY-d.top,currentTile:this.currentTile,tiles:this.tiles.filter(b=>b.isSelected)})}return n.pipe((0,U.q)(1),(0,y.h)(()=>!!this.currentTile))}if(c===this.container||c.parentElement===this.container){if(1===r.buttons){const d=this._container.getBoundingClientRect();this.dragSelection$.next({startPosition:new w.L(r.pageX-d.left,r.pageY-d.top),selectedRect:new x.U})}this.currentTile&&(this.currentTile.isPressed=!1),this.selectedTiles=[]}return(0,re.of)(null)}))),(0,y.h)(o=>!!o),(0,f.R)(this.destroyed$)).subscribe(o=>{this.currentTile.isPressed&&(this.currentTile.isPressed=!1,o.ctrlKey&&(this.currentTile.isSelected=!this.currentTile.isSelected,this.selectedTiles=this.tiles.filter(a=>a.isSelected).map(a=>a.id))),this.designMode&&(this._cursor=this.getCursorFromHtmlElement(o.pageX,o.pageY,o.target),this.container.style.cursor=this._cursor),this.currentTile=void 0})}}get container(){return this._container}set tiles(e){this._tiles=e,this.tilesDic=this.tiles.reduce((t,n)=>t.set(n.id,n),new Map),this.refreshTiles$.next({resetWidth:!0})}get tiles(){return this._tiles||(this._tiles=new Array)}set selectedTiles(e){var t;const n=new Array;let s=!1;const o=e.reduce((r,h)=>r.add(h),new Set),a=this.selectedIds.reduce((r,h)=>r.add(h),new Set);if((null===(t=this.tiles)||void 0===t?void 0:t.length)?this.tiles.forEach(r=>{o.has(r.id)!==a.has(r.id)&&(s=!0),r.isSelected=o.has(r.id),r.isSelected&&n.push(r)}):s=this.selectedIds.length>0,this.selectedIds=e,s){const r=new CustomEvent("DejaTilesAddEvent",{cancelable:!1});r.tiles=n,this.selectionChanged.next(r)}}set tileMinWidth(e){this.extractValueAndUnit("_tileMinWidth",e)}set tileMaxWidth(e){this.extractValueAndUnit("_tileMaxWidth",e)}set tileMinHeight(e){this.extractValueAndUnit("_tileMinHeight",e)}set tileMaxHeight(e){this.extractValueAndUnit("_tileMaxHeight",e)}set maxWidth(e){this.extractValueAndUnit("_maxWidth",e)}get targetBounds(){return this._targetBounds}set targetBounds(e){this._targetBounds=e,this.selectionRect$.next(e?new x.U({height:this.getPixelSize(e.height||0),left:this.getPixelSize(e.left||0),top:this.getPixelSize(e.top||0),width:this.getPixelSize(e.width||0)}):null)}copySelection(){const e=this.tiles.filter(t=>t.isSelected);return e.length&&this.copyTiles(e,!1),e}cutSelection(){const e=this.tiles.filter(t=>t.isSelected);return e.length&&this.copyTiles(e,!0),e}deleteSelection(){const e=this.tiles.filter(t=>t.isSelected);return e.length&&this.removeTiles(e.map(t=>t.id)),e}paste(){if(!this.clipboardService||!this.clipboardService.isAvailable("tiles"))return new Array;const e=this.clipboardService.get("tiles");let t;this.tiles.forEach(o=>o.isSelected=!1),e.forEach(o=>{t=t?x.U.union(t,o.percentBounds):new x.U(o.percentBounds)});const n=this.getFreePlace(new x.U(0,0,t.width,t.height)),s=e.map(o=>{const a=o.clone();return a.percentBounds=new x.U(n.left+o.percentBounds.left-t.left,n.top+o.percentBounds.top-t.top,o.percentBounds.width,o.percentBounds.height),a.isSelected=!0,a});return this.addTiles(s),s}getTileElementFromHTMLElement(e){let t=e;for(;t&&"DEJA-TILE"!==t.tagName;)if(t=t.parentElement,t===this.container)return;if((null==t?void 0:t.parentElement)===this.container)return t}isElementInsideDejaEditor(e){let t=e;for(;t&&t!==this.container;){if("DEJA-EDITOR"===t.tagName)return!0;t=t.parentElement}return!1}getTileComponentFromHTMLElement(e){const t=this.getTileElementFromHTMLElement(e);return t&&this.tilesDic.get(t.id)}deleteTiles(e){if(!e||0===e.length)return;const t=new CustomEvent("DejaTilesDeletedEvent",{cancelable:!1});t.tiles=e,e.forEach(s=>{this.tilesDic.delete(s.id),s.delete()});let n=this.tiles.length;for(;--n>=0;)this.tilesDic.has(this.tiles[n].id)||this.tiles.splice(n,1);this.refreshTiles$.next({resetWidth:!0}),t.tiles=this.tiles,this.tilesDeleted.next(t)}removeTiles(e){if(!e||0===e.length)return;const t=e.map(o=>this.tilesDic.get(o));t.forEach(o=>{o.isHidden=!0});const n=new CustomEvent("DejaTilesRemoveEvent",{cancelable:!0});n.tiles=this.tiles,n.removed=t,n.cancel$=new _.x;const s=n.cancel$.pipe((0,U.q)(1),(0,f.R)(this.destroyed$)).subscribe(o=>{o?t.forEach(a=>a.isHidden=!1):this.deleteTiles(t)});this.contentRemoving.next(n),n.defaultPrevented||(s.unsubscribe(),this.deleteTiles(t))}getFreePlace(e){const t=new Array,n=this.tiles.filter(o=>!o.isDragging);let s=0;n.forEach(o=>{o.percentBounds.bottom>s&&(s=o.percentBounds.bottom)});for(let o=0;o<=this._maxWidth-e.width;o+=this._tileMinWidth)for(let a=0;a<=s-e.height;a+=this._tileMinHeight){const r=new x.U(o,a,e.width,e.height);n.find(h=>h.percentBounds.intersectWith(r))||t.push(r)}return t.length>0?(t.sort((o,a)=>{const r=h=>Math.min(Math.abs(h.left-e.left),Math.abs(h.right-e.right))+200*Math.min(Math.abs(h.top-e.top),Math.abs(h.bottom-e.bottom));return r(o)-r(a)}),t[0]):new x.U(0,s,e.width,e.height)}moveTile(e,t){const n=this.tiles.find(s=>s.id===e);n&&(n.percentBounds=t,this.refreshTiles$.next(null))}hitTest(e){const t=new x.U(this.getPercentSize(e.left),this.getPercentSize(e.top),this.getPercentSize(e.width),this.getPercentSize(e.height));return this.tiles.filter(n=>n.percentBounds.intersectWith(t))}getPercentSize(e){return Math.round(100*e/this.hundredPercentWith)}dragEnter(e,t){if(!this.designMode||!this._container)return!1;const n=e.tile;if(!n)return!1;const s=this._container.getBoundingClientRect(),{pageX:o,pageY:a}=t.originalEvent,r=o-s.left,h=a-s.top,c=n.clone();return c.isTemporary=!0,this.dragDropInfos$.next({enabled:!1,startX:r,startY:h,currentTile:c}),!0}startDrag(e,t,n){const s=this.saveLayout();let o;e.forEach(a=>{o=o?x.U.union(o,a.percentBounds):a.percentBounds,a.isDragging=!0}),this.dragRelativePosition=new Map,e.forEach(a=>this.dragRelativePosition.set(a.id,new w.L(a.percentBounds.left-o.left,a.percentBounds.top-o.top))),this.dragPageOffset=new w.L(t,n),this.dragOriginalPosition=new w.L(o.left,o.top),this.targetBounds=s.targetBounds=s.validBounds=o,this.originalLayout=s,this.validLayout=void 0}cancelDrag(e){this.clearMoveTimer(),(0,R.D)(e).pipe((0,y.h)(t=>!!t),(0,f.R)(this.destroyed$)).subscribe(t=>{t.isDragging=!1,t.isDropping=!0}),this.originalLayout&&this.restoreLayout(this.originalLayout),this.endDrag()}drop(e){let t;if(this.clearMoveTimer(),this.validLayout){if(this.restoreLayout(this.validLayout),"move"!==this._cursor){const n=e[0];n.percentBounds=new x.U(this.validLayout.validBounds),n.isDragging=!1}else(0,R.D)(e).pipe((0,y.h)(n=>!!n),(0,M.b)(n=>{const s=this.validLayout.validBounds.left+this.dragRelativePosition.get(n.id).left,o=this.validLayout.validBounds.top+this.dragRelativePosition.get(n.id).top;n.percentBounds=new x.U(s,o,n.percentBounds.width,n.percentBounds.height),n.isDragging=!1,n.isDropping=!0,n.isTemporary&&(this.tilesDic.delete(n.id),n.makeId(),this.tilesDic.set(n.id,n),this.addTiles([n]))}),(0,Q.g)(1e3),(0,f.R)(this.destroyed$)).subscribe(n=>n.isDropping=!1);t=this.tiles.filter(n=>{const s=this.originalLayout[n.id];return!x.U.equals(n.percentBounds,null==s?void 0:s.bounds)}),this.endDrag()}else this.removeTemporaryTile(),this.cancelDrag(e);if(t){const n=new CustomEvent("DejaTilesEvent",{cancelable:!0});n.tiles=this.tiles,this.layoutChanged.next(n)}return t}endDrag(){this.originalLayout=void 0,this.validLayout=void 0,this.targetBounds=void 0,this.dragging$.next(!1),this.dragDropInfos$.next(null),this.dragTarget=void 0,this.copyTiles(null),this.refreshTiles$.next(null)}drag(e,t,n){const s=new w.L(t-this.dragPageOffset.left,n-this.dragPageOffset.top),o=s.left+this.getPixelSize(this.dragOriginalPosition.left),a=s.top+this.getPixelSize(this.dragOriginalPosition.top),r=this.getTileMinPixelSize(),h=this.getTileMaxPixelSize();if("move"!==this._cursor){const c=e[0],d=this.getPixelBounds(c.percentBounds),p=o+d.width,m=a+d.height,b=d.right,C=d.bottom;switch(this._cursor){case"nw-resize":d.left=Math.max(Math.min(o,d.right-r.width),d.right-h.width),d.right=b,d.top=Math.max(Math.min(a,d.bottom-r.height),d.bottom-h.height),d.bottom=C,this.size(c,new w.L(o,a),v.left+v.top);break;case"sw-resize":d.left=Math.max(Math.min(o,d.right-r.width),d.right-h.width),d.right=b,d.bottom=Math.max(Math.min(m,d.top+h.height),d.top+r.height),this.size(c,new w.L(o,m),v.left+v.bottom);break;case"w-resize":d.left=Math.max(Math.min(o,d.right-r.width),d.right-h.width),d.right=b,this.size(c,new w.L(o,0),v.left);break;case"ne-resize":d.right=Math.max(Math.min(p,d.left+h.width),d.left+r.width),d.top=Math.max(Math.min(a,d.bottom-r.height),d.bottom-h.height),d.bottom=C,this.size(c,new w.L(p,a),v.right+v.top);break;case"se-resize":d.right=Math.max(Math.min(p,d.left+h.width),d.left+r.width),d.bottom=Math.max(Math.min(m,d.top+h.height),d.top+r.height),this.size(c,new w.L(p,m),v.right+v.bottom);break;case"e-resize":d.right=Math.max(Math.min(p,d.left+h.width),d.left+r.width),this.size(c,new w.L(p,0),v.right);break;case"n-resize":d.top=Math.max(Math.min(a,d.bottom-r.height),d.bottom-h.height),d.bottom=C,this.size(c,new w.L(0,a),v.top);break;case"s-resize":d.bottom=Math.max(Math.min(m,d.top+h.height),d.top+r.height),this.size(c,new w.L(0,m),v.bottom)}c.pixelBounds=d}else e.forEach(c=>{c.pixelBounds=new x.U(o+this.getPixelSize(this.dragRelativePosition.get(c.id).left),a+this.getPixelSize(this.dragRelativePosition.get(c.id).top),this.getPixelSize(c.percentBounds.width),this.getPixelSize(c.percentBounds.height))}),this.dragTarget=new x.U(this.getPercentSize(o),this.getPercentSize(a),this.targetBounds.width,this.targetBounds.height),this.move()}addTiles(e){var t;if(!e||0===e.length)return;e.forEach(c=>{this.tiles.find(d=>d.id===c.id)||(this.tiles.find(d=>{var p;return c.percentBounds&&(null===(p=d.percentBounds)||void 0===p?void 0:p.intersectWith(c.percentBounds))})&&(c.percentBounds=void 0),c.percentBounds||(c.percentBounds=this.getFreePlace(c.idealBounds)),this.tiles.push(c),this.tilesDic.set(c.id,c))});const n=new CustomEvent("DejaTilesAddEvent",{cancelable:!0});n.tiles=this.tiles,n.added=e,n.cancel$=new _.x;const s=null===(t=this.clipboardService)||void 0===t?void 0:t.get("tiles-provider");let o;s&&(o=this.clipboardService.get("tiles"),o.forEach(c=>{c.isHidden=!0}));const a=()=>{o&&(s.next(o),this.clipboardService.clear())},r=c=>{a();const d=new CustomEvent("DejaTileAddedEvent",{cancelable:!1});d.tiles=this.tiles,d.added=c,this.tilesAdded.next(d)};let h;e.forEach(c=>{h=h?x.U.union(h,c.percentBounds):new x.U(c.percentBounds)}),this.refreshTiles$.next({ensureBounds:h}),this.contentAdding.next(n),n.defaultPrevented?(n.cancel$.pipe((0,U.q)(1),(0,y.h)(c=>!c),(0,f.R)(this.destroyed$)).subscribe(r),n.cancel$.pipe((0,U.q)(1),(0,y.h)(c=>!!c),(0,I.w)(()=>(o&&o.forEach(c=>{c.isHidden=!1,c.isCutted=!0}),(0,R.D)(e))),(0,M.b)(c=>c.isHidden=!0),(0,Q.g)(1e3),(0,ae.u)((c,d)=>[...c,d],new Array),(0,U.q)(1),(0,f.R)(this.destroyed$)).subscribe(c=>this.deleteTiles(c))):r(e)}size(e,t,n){const s=new w.L(this.getPercentSize(t.left),this.getPercentSize(t.top)),o=e.percentBounds.clone(),a=e.percentBounds.clone();let r,h,c,d;if(n&v.left){r=this.getTileMinPercentWidth(),c=this.getTileMaxPercentWidth();const m=s.left,b=o.left<m?r*Math.ceil(m/r):r*Math.floor(m/r),C=Math.min(c,Math.max(r,a.right-b));o.width=o.right-m,o.left=m,a.left=a.right-C,a.width=C}if(n&v.right){r=r||this.getTileMinPercentWidth(),c=c||this.getTileMaxPercentWidth();const m=s.left,b=o.right<m?r*Math.ceil(m/r):r*Math.floor(m/r);o.width=m-o.left,a.width=Math.min(c,Math.max(r,b-a.left))}if(n&v.top){h=this.getTileMinPercentHeight(),d=this.getTileMaxPercentHeight();const m=s.top,b=o.top<m?h*Math.ceil(m/h):h*Math.floor(m/h),C=Math.min(d,Math.max(h,a.bottom-b));o.height=o.bottom-m,o.top=m,a.top=a.bottom-C,a.height=C}if(n&v.bottom){h=h||this.getTileMinPercentHeight(),d=d||this.getTileMaxPercentHeight();const m=s.top,b=o.bottom<m?h*Math.ceil(m/h):h*Math.floor(m/h);o.height=m-o.top,a.height=Math.min(d,Math.max(h,b-a.top))}if(!x.U.equals(a,this.destination))if(this.restoreLayout(this.originalLayout),this.destination=a.clone(),this.tiles.find(m=>!m.isDragging&&m.percentBounds.intersectWith(a))){if(a){const m=this.ensureTarget(a,o,n);m&&(this.targetBounds=m,this.validLayout=this.saveLayout(),this.validLayout.targetBounds=a,this.validLayout.validBounds=m,this.refreshTiles$.next(null))}}else this.targetBounds=a,this.validLayout=this.saveLayout(),this.validLayout.targetBounds=this.validLayout.validBounds=a,this.refreshTiles$.next(null)}clearMoveTimer(){this.moveTimOut&&(this.moveTimOut.unsubscribe(),this.moveTimOut=void 0)}move(){const e=this.getTileMinPercentWidth(),t=this.getTileMinPercentHeight();let n=this.ensureContainer(new x.U(e*Math.round(this.dragTarget.left/e),t*Math.round(this.dragTarget.top/t),this.dragTarget.width,this.dragTarget.height));if(this.lastTargetBounds&&Math.abs(n.left-this.lastTargetBounds.left)<e&&Math.abs(n.top-this.lastTargetBounds.top)<t)return;this.lastTargetBounds=n;const s=this.tiles.filter(o=>!o.isDragging).reduce((o,a)=>{const r=x.U.overlapInfos(a.percentBounds,n);return Math.max(Math.min(r.height,r.width),o)},0);if(this.tiles.find(o=>{const a=this.originalLayout[o.id];return null==a?void 0:a.bounds.intersectWith(n)})||this.restoreLayout(this.originalLayout),0===s)this.clearMoveTimer(),this.targetBounds=n.clone(),this.destination=n.clone(),this.validLayout=this.saveLayout(),this.validLayout.targetBounds=this.validLayout.validBounds=n,this.refreshTiles$.next(null);else{if(x.U.equals(this.targetBounds,n)||this.clearMoveTimer(),s>3){const r=n.clone();this.moveTimOut=(0,Pe.H)(500).pipe((0,U.q)(1),(0,f.R)(this.destroyed$)).subscribe(()=>{this.restoreLayout(this.originalLayout),this.destination=r;const h=this.ensureTarget(r,this.dragTarget,v.all);h&&(this.targetBounds=h,this.validLayout=this.saveLayout(),this.validLayout.targetBounds=r,this.validLayout.validBounds=h,this.refreshTiles$.next(null))})}const o=new Array,a=this.tiles.filter(r=>!r.isDragging);for(let r=Math.min(this.targetBounds.left,n.left);r<=Math.max(this.targetBounds.left,n.left);r++)for(let h=Math.min(this.targetBounds.top,n.top);h<=Math.max(this.targetBounds.top,n.top);h++){const c=new x.U(r,h,n.width,n.height);a.find(d=>d.percentBounds.intersectWith(c))||o.push(c)}o.length>0&&(o.sort((r,h)=>{const c=d=>Math.min(Math.abs(d.left-n.left),Math.abs(d.right-n.right))+200*Math.min(Math.abs(d.top-n.top),Math.abs(d.bottom-n.bottom));return c(r)-c(h)}),n=o[0],this.targetBounds=n.clone(),this.destination=n.clone(),this.validLayout=this.saveLayout(),this.validLayout.targetBounds=this.validLayout.validBounds=n,this.refreshTiles$.next(null))}}ensureContainer(e){e.left<0&&(e=e.offset(-e.left,0)),e.top<0&&(e=e.offset(0,-e.top));const t=this.getMaxPercentWidth();t&&e.right>t&&(e=e.offset(t-e.right,0));const n=this.getMaxPercentHeight();return n&&e.bottom>n&&(e=e.offset(0,n-e.bottom)),e}ensureTarget(e,t,n,s,o=10){t||(t=e),s||(s=e.clone()),n||(n=v.all);const a=new Array,r=new Array,h=new Array,c=new Array;if(this.tiles.filter(m=>!m.isDragging&&m.percentBounds.intersectWith(e)).find(m=>{const b=new x.U(this.dragOriginalPosition.left,this.dragOriginalPosition.top,e.width,e.height);if(Math.abs(m.percentBounds.left-t.left)<1&&Math.abs(m.percentBounds.top-t.top)<1&&Math.abs(m.percentBounds.width-t.width)<1&&Math.abs(m.percentBounds.height-t.height)<1&&(Math.abs(t.left-b.right)<=4||Math.abs(t.right-b.left)<=4||Math.abs(t.top-b.bottom)<=4||Math.abs(t.bottom-b.top)<=4))return m.percentBounds=b,!0;{const C=m.percentBounds.left-t.left,Z=t.right-m.percentBounds.right,$=m.percentBounds.top-t.top,T=t.bottom-m.percentBounds.bottom,P=Math.max(0,Math.min(m.percentBounds.right,t.right)-Math.max(m.percentBounds.left,t.left))/Math.min(m.percentBounds.width,t.width);let E;switch(Math.max(0,Math.min(m.percentBounds.bottom,t.bottom)-Math.max(m.percentBounds.top,t.top))/Math.min(m.percentBounds.height,t.height)>=P&&n&v.horizontal?E=Z>=C&&n&v.left?v.left:v.right:n&v.vertical&&(E=T>=$&&n&v.top?v.top:v.bottom),E){case v.left:a.push(m);break;case v.top:h.push(m);break;case v.right:r.push(m);break;default:c.push(m)}}}))return e;let p=0;return a.length&&(p=this.pushHorizontal(e,-1,a),p)?(e=this.ensureContainer(e.offset(p,0)),o?this.ensureTarget(e,t,n&~v.left,s,o-1):null):(r.length&&(p=this.pushHorizontal(e,1,r)),p>0?(this.restoreLayout(this.originalLayout),o?this.ensureTarget(s,t,n&v.vertical,void 0,o-1):null):h.length&&(p=this.pushVertical(e,-1,h),p)?(e=this.ensureContainer(e.offset(0,p)),o?this.ensureTarget(e,t,v.bottom,void 0,o-1):null):(p=this.pushVertical(e,1,c),p?null:e))}saveLayout(){const e={};return e.height=this.getTileMinPercentHeight(),this.tiles.forEach(t=>{const n=this.getPixelSize(t.percentBounds.top||0),s=this.getPixelSize(t.percentBounds.height||this._tileMinHeight);n+s>e.height&&(e.height=n+s),e[t.id]={bounds:t.percentBounds.clone(),id:t.id}}),e}getPixelBounds(e){return x.U.fromLTRB(Math.round(e.left*this.hundredPercentWith/100),Math.round(e.top*this.hundredPercentWith/100),Math.round(e.right*this.hundredPercentWith/100),Math.round(e.bottom*this.hundredPercentWith/100))}getPixelSize(e,t){return t&&"%"!==t?e:Math.round(e*this.hundredPercentWith/100)}getSizePercentLimit(e){const t=this,n=t[`${e}Unit`];return n&&"px"!==n?t[e]:this.getPercentSize(t[e])}getSizePixelLimit(e){const t=this,n=t[`${e}Unit`];return n&&"px"!==n?this.getPixelSize(t[e]):t[e]}getTileMinPixelSize(){return new ie(this.getSizePixelLimit("_tileMinWidth"),this.getSizePixelLimit("_tileMinHeight"))}getTileMaxPixelSize(){return new ie(this.getSizePixelLimit("_tileMaxWidth"),this.getSizePixelLimit("_tileMaxHeight"))}getTileMinPercentWidth(){return Math.max(1,this.getSizePercentLimit("_tileMinWidth"))}getTileMaxPercentWidth(){return Math.max(5,this.getSizePercentLimit("_tileMaxWidth"))}getTileMinPercentHeight(){return Math.max(1,this.getSizePercentLimit("_tileMinHeight"))}getTileMaxPercentHeight(){return Math.max(5,this.getSizePercentLimit("_tileMaxHeight"))}getMaxPercentWidth(){return Math.max(5,this.getSizePercentLimit("_maxWidth"))}getMaxPercentHeight(){return Math.max(5,this.getSizePercentLimit("_maxHeight"))}getCursorFromHtmlElement(e,t,n){const s=this.getTileElementFromHTMLElement(n);if(!s)return null;const o=s.getBoundingClientRect();return e<o.left+15?t<o.top+15?"nw-resize":t>o.bottom-15?"sw-resize":"w-resize":e>o.right-15?t<o.top+15?"ne-resize":t>o.bottom-15?"se-resize":"e-resize":t<o.top+15?"n-resize":t>o.bottom-15?"s-resize":"move"}extractValueAndUnit(e,t){const s=/(\d+)(.*)/i.exec(t);if((null==s?void 0:s.length)>=1){const o=this;o[e]=parseInt(s[1],10),o[`${e}Unit`]=s.length>=2?s[2]:"px"}}restoreLayout(e){this.tiles.forEach(t=>{const n=e[t.id];n&&(t.percentBounds=n.bounds.clone())})}calcHorizontalOverflow(e,t,n,s){let o=0;return s=s||new Set,t.forEach(a=>{if(!s.has(a.id)){s.add(a.id);const r=a.percentBounds.offset(e*n,0);let h=0;const c=this.getMaxPercentWidth();r.left<0?h=-r.left:c&&r.right>c&&(h=r.right-c);const d=this.tiles.filter(p=>!p.isDragging&&!p.equalsTo(a)&&p.percentBounds.intersectWith(r));d.length&&(h+=this.calcHorizontalOverflow(e,d,n,s)),h>o&&(o=h)}}),o}moveHorizontal(e,t,n,s){t.forEach(o=>{if(!s.has(o.id)){const a=o.percentBounds.offset(e*n,0);s.set(o.id,a);const r=this.tiles.filter(h=>!h.isDragging&&!h.equalsTo(o)&&h.percentBounds.intersectWith(a));r.length&&this.moveHorizontal(e,r,n,s)}})}pushHorizontal(e,t,n,s){let o=0;const a=new Map;return s||(s=0,n.forEach(r=>{const h=t>0?Math.max(0,e.right-r.percentBounds.left):Math.max(0,r.percentBounds.right-e.left);h>s&&(s=h)})),s>0&&(o=this.calcHorizontalOverflow(t,n,s),(s-=o)>0&&(this.moveHorizontal(t,n,s,a),this.tiles.forEach(r=>{a.has(r.id)&&(r.percentBounds=a.get(r.id))}))),o}calcVerticalOverflow(e,t,n,s){let o=0;return s=s||new Set,t.forEach(a=>{if(!s.has(a.id)){s.add(a.id);const r=a.percentBounds.offset(0,e*n);let h=0;const c=this.getMaxPercentHeight();r.top<0?h=-r.top:c&&r.bottom>c&&(h=r.bottom-c);const d=this.tiles.filter(p=>!p.isDragging&&!p.equalsTo(a)&&p.percentBounds.intersectWith(r));d.length&&(h+=this.calcVerticalOverflow(e,d,n,s)),h>o&&(o=h)}}),o}moveVertical(e,t,n,s){t.forEach(o=>{if(!s.has(o.id)){const a=o.percentBounds.offset(0,e*n);s.set(o.id,a);const r=this.tiles.filter(h=>!h.isDragging&&!h.equalsTo(o)&&h.percentBounds.intersectWith(a));r.length&&this.moveVertical(e,r,n,s)}})}pushVertical(e,t,n,s){let o=0;const a=new Map;return s||(s=0,n.forEach(r=>{const h=t>0?Math.max(0,e.bottom-r.percentBounds.top):Math.max(0,r.percentBounds.bottom-e.top);h>s&&(s=h)})),s>0&&(o=this.calcVerticalOverflow(t,n,s),(s-=o)>0&&(this.moveVertical(t,n,s,a),this.tiles.forEach(r=>a.has(r.id)&&(r.percentBounds=a.get(r.id))))),o}copyTiles(e,t){if(!this.clipboardService){if(!e)return;throw new Error("DejaClipboardService must be imported by your application to use the copyTiles methode of DejaTilesComponent.")}const n=this.clipboardService.get("tiles");n&&n.forEach(s=>s.isCutted=!1),this.clipboardService.set("tiles",e),t?(e.forEach(s=>s.isCutted=!0),this.clipboardService.set("tiles-provider",this.deleteTiles$)):this.clipboardService.set("tiles-provider",void 0)}removeTemporaryTile(){let e=this.tiles.length;for(;--e>=0;){const t=this.tiles[e];t.isTemporary&&(this.tilesDic.delete(t.id),this.tiles.splice(e,1))}}}return l.\u0275fac=function(e){return new(e||l)(i.LFG(j.ST,8))},l.\u0275prov=i.Yz7({token:l,factory:l.\u0275fac}),l})();var de=u(7442);let De=(()=>{class l{constructor(e){this.element=e.nativeElement,this.element.style.display="none"}set bounds(e){if(e){const{left:t,top:n,width:s,height:o}=e;this.element.style.left=`${t}px`,this.element.style.top=`${n}px`,this.element.style.width=`${s}px`,this.element.style.height=`${o}px`,this.element.style.display="block"}else this.element.style.display="none"}}return l.\u0275fac=function(e){return new(e||l)(i.Y36(i.SBq))},l.\u0275dir=i.lG2({type:l,selectors:[["","deja-tile-position",""]],inputs:{bounds:"bounds"}}),l})();const $e=["tileTemplate"],Se=["tilesContainer"];function ke(l,g){if(1&l){const e=i.EpF();i.TgZ(0,"deja-tile",4),i.NdJ("close",function(){const s=i.CHM(e).$implicit;return i.oxw().onTileClosed(s)}),i.qZA()}if(2&l){const e=g.$implicit,t=g.index,n=i.oxw();i.Q6J("id",e.id)("tile",e)("template",n.tileTemplate),i.uIk("tile-index",t)}}let Be=(()=>{class l extends j.yl{constructor(e,t,n,s){super(),this.changeDetectorRef=t,this.layoutProvider=n,this.control=s,this.selectionChanged=new i.vpe,this.layoutChanged=new i.vpe,this.layoutCompleted=new i.vpe,this.contentAdding=new i.vpe,this.contentRemoving=new i.vpe,this.tilesAdded=new i.vpe,this.tilesDeleted=new i.vpe,this.contentCopied=new i.vpe,this.tabIndex=0,this._models=[],this.hasFocus=!1,this.onTouchedCallback=()=>{},this.onChangeCallback=a=>{},this.control&&(this.control.valueAccessor=this);const o=e.nativeElement;(0,R.D)(this.layoutProvider.selectionChanged).pipe((0,f.R)(this.destroyed$)).subscribe(a=>this.selectionChanged.emit(a)),(0,R.D)(this.layoutProvider.contentAdding).pipe((0,f.R)(this.destroyed$)).subscribe(a=>this.contentAdding.emit(a)),(0,R.D)(this.layoutProvider.contentRemoving).pipe((0,f.R)(this.destroyed$)).subscribe(a=>this.contentRemoving.emit(a)),(0,R.D)(this.layoutProvider.tilesAdded).pipe((0,f.R)(this.destroyed$)).subscribe(a=>{this.tilesAdded.emit(a),this.onChangeCallback(a.tiles)}),(0,R.D)(this.layoutProvider.tilesDeleted).pipe((0,f.R)(this.destroyed$)).subscribe(a=>{this.tilesDeleted.emit(a),this.onChangeCallback(a.tiles)}),(0,R.D)(this.layoutProvider.layoutChanged).pipe((0,f.R)(this.destroyed$)).subscribe(a=>{this.layoutChanged.emit(a),this.onChangeCallback(a.tiles)}),(0,R.D)(this.layoutProvider.layoutCompleted).pipe((0,f.R)(this.destroyed$)).subscribe(a=>this.layoutCompleted.emit(a)),this.keyup$=(0,k.R)(o.ownerDocument,"keyup"),(0,k.R)(window,"resize").pipe((0,K.b)(5),(0,f.R)(this.destroyed$)).subscribe(()=>this.refresh({resetWidth:!0}))}get tiles(){return this.layoutProvider.tiles}get selectionRect$(){return this.layoutProvider.selectionRect$}set tileminwidth(e){this.layoutProvider.tileMinWidth=e}set tilemaxwidth(e){this.layoutProvider.tileMaxWidth=e}set tileminheight(e){this.layoutProvider.tileMinHeight=e}set tilemaxheight(e){this.layoutProvider.tileMaxHeight=e}set maxwidth(e){this.layoutProvider.maxWidth=e}set designMode(e){this.layoutProvider.designMode=(0,B.Ig)(e)}get designMode(){return this.layoutProvider.designMode}set models(e){this.writeValue(e)}set canDelete(e){(0,B.Ig)(e)&&!this.delete$sub?this.delete$sub=this.keyup$.pipe((0,y.h)(t=>this.layoutProvider.designMode&&t.code===j.mW.Delete&&this.hasFocus),(0,f.R)(this.destroyed$)).subscribe(()=>this.layoutProvider.deleteSelection()):this.delete$sub&&(this.delete$sub.unsubscribe(),this.delete$sub=void 0)}set canCopy(e){(0,B.Ig)(e)&&!this.copy$sub?this.copy$sub=this.keyup$.pipe((0,y.h)(t=>t.code===j.mW.KeyC&&t.ctrlKey&&this.hasFocus),(0,f.R)(this.destroyed$)).subscribe(()=>this.copySelection()):this.copy$sub&&(this.copy$sub.unsubscribe(),this.copy$sub=void 0)}set canCut(e){(0,B.Ig)(e)&&!this.cut$sub?this.cut$sub=this.keyup$.pipe((0,y.h)(t=>this.layoutProvider.designMode&&t.code===j.mW.KeyX&&t.ctrlKey&&this.hasFocus),(0,f.R)(this.destroyed$)).subscribe(()=>this.cutSelection()):this.cut$sub&&(this.cut$sub.unsubscribe(),this.cut$sub=void 0)}set canPaste(e){(0,B.Ig)(e)&&!this.paste$sub?this.paste$sub=this.keyup$.pipe((0,y.h)(t=>this.layoutProvider.designMode&&t.code===j.mW.KeyV&&t.ctrlKey&&this.hasFocus),(0,f.R)(this.destroyed$)).subscribe(()=>this.paste()):this.paste$sub&&(this.paste$sub.unsubscribe(),this.paste$sub=void 0)}set selectedTiles(e){this.layoutProvider.selectedTiles=e.map(t=>"string"==typeof t?t:t.id)}writeValue(e){this._models=e||[],this.layoutProvider.tiles=this._models,this.changeDetectorRef.markForCheck()}registerOnChange(e){this.onChangeCallback=e}registerOnTouched(e){this.onTouchedCallback=e}ngAfterViewInit(){this.layoutProvider.container=this.tilesContainer.nativeElement,this.refresh({resetWidth:!0})}ngOnDestroy(){super.ngOnDestroy(),this.canCopy=!1,this.canCut=!1,this.canDelete=!1,this.canPaste=!1}copySelection(){const e=this.layoutProvider.copySelection();if(null==e?void 0:e.length){const t=new CustomEvent("DejaTilesCopied",{cancelable:!0});t.tiles=e,this.contentCopied.emit(t)}}cutSelection(){const e=this.layoutProvider.cutSelection();if(null==e?void 0:e.length){const t=new CustomEvent("DejaTilesCutted",{cancelable:!0});t.tiles=e,this.contentCopied.emit(t)}}deleteSelection(){const e=this.layoutProvider.deleteSelection();return this.changeDetectorRef.markForCheck(),e}paste(){const e=this.layoutProvider.paste();return this.changeDetectorRef.markForCheck(),e}ensureVisible(e){this.layoutProvider.ensureVisible$.next(e)}refresh(e){this.layoutProvider.refreshTiles$.next(e)}addTiles(e){this.layoutProvider.addTiles(e)}removeTiles(e){this.layoutProvider.removeTiles(e)}hitTest(e,t){const s=this.tilesContainer.nativeElement.getBoundingClientRect(),o=e-s.left,a=t-s.top;return this.tiles.find(r=>{var h;return null===(h=r.pixelBounds)||void 0===h?void 0:h.containsPoint(new w.L(o,a))})}getFreePlace(e,t,n,s){if(!this._models||0===this._models.length)return new x.U(0,0,n,s);const a=this.tilesContainer.nativeElement.getBoundingClientRect(),h=t?t-a.top:0,c=new x.U(this.layoutProvider.getPercentSize(e?e-a.left:0),this.layoutProvider.getPercentSize(h),n,s);return this.layoutProvider.getFreePlace(c)}moveTile(e,t){this.layoutProvider.moveTile(e,t)}getDropContext(){let e;return{dragEnter:(t,n)=>(e=this.layoutProvider.dragEnter(t,n)?{className:"hidden"}:null,e),dragOver:(t,n)=>(this.layoutProvider.dragover$.next(n),e),dragLeave:t=>{e=null,this.layoutProvider.dragleave$.next()}}}onTileClosed(e){this.layoutProvider.removeTiles([e.id])}onFocus(){this.hasFocus=!0}onBlur(){this.hasFocus=!1}}return l.\u0275fac=function(e){return new(e||l)(i.Y36(i.SBq),i.Y36(i.sBO),i.Y36(he),i.Y36(O.a5,10))},l.\u0275cmp=i.Xpm({type:l,selectors:[["deja-tiles"]],contentQueries:function(e,t,n){if(1&e&&i.Suo(n,$e,5),2&e){let s;i.iGM(s=i.CRH())&&(t.tileTemplate=s.first)}},viewQuery:function(e,t){if(1&e&&i.Gf(Se,7),2&e){let n;i.iGM(n=i.CRH())&&(t.tilesContainer=n.first)}},inputs:{tabIndex:"tabIndex",tileminwidth:"tileminwidth",tilemaxwidth:"tilemaxwidth",tileminheight:"tileminheight",tilemaxheight:"tilemaxheight",maxwidth:"maxwidth",designMode:"designMode",models:"models",canDelete:"canDelete",canCopy:"canCopy",canCut:"canCut",canPaste:"canPaste",selectedTiles:"selectedTiles"},outputs:{selectionChanged:"selectionChanged",layoutChanged:"layoutChanged",layoutCompleted:"layoutCompleted",contentAdding:"contentAdding",contentRemoving:"contentRemoving",tilesAdded:"tilesAdded",tilesDeleted:"tilesDeleted",contentCopied:"contentCopied"},features:[i._Bn([he]),i.qOj],decls:5,vars:8,consts:[["id","tiles",3,"mouse-droppable","focus","blur"],["tilesContainer",""],[3,"id","tile","template","close",4,"ngFor","ngForOf"],["deja-tile-position","",3,"bounds"],[3,"id","tile","template","close"]],template:function(e,t){1&e&&(i.TgZ(0,"div",0,1),i.NdJ("focus",function(){return t.onFocus()})("blur",function(){return t.onBlur()}),i.YNc(2,ke,1,4,"deja-tile",2),i._UZ(3,"div",3),i.ALo(4,"async"),i.qZA()),2&e&&(i.ekj("design",t.designMode),i.Q6J("mouse-droppable",t.getDropContext()),i.uIk("tabindex",t.tabIndex),i.xp6(2),i.Q6J("ngForOf",t.tiles),i.xp6(1),i.Q6J("bounds",i.lcZ(4,6,t.selectionRect$)))},directives:[de.d,D.sg,De,Ce],pipes:[D.Ov],styles:["[_nghost-%COMP%]{position:relative;overflow:auto;margin:0!important}[_nghost-%COMP%]   #tiles[_ngcontent-%COMP%]{display:block;left:0;top:0;min-width:100%;min-height:100%;position:absolute;padding:0!important;margin:0!important}[_nghost-%COMP%]   #tiles.design[_ngcontent-%COMP%]   deja-tile[_ngcontent-%COMP%]{background-color:#0000001a}[_nghost-%COMP%]   #tiles[_ngcontent-%COMP%]   #tile[_ngcontent-%COMP%]:hover{z-index:200}[_nghost-%COMP%]   [deja-tile-position][_ngcontent-%COMP%]{position:absolute;z-index:101;background-color:#00000080}[drag][_nghost-%COMP%]{background-color:#00000080}[drag][_nghost-%COMP%]   [deja-tile-position][_ngcontent-%COMP%]{transition-property:left,top,width,height;transition-duration:.35s;transition-timing-function:ease}"],changeDetection:0}),l})(),Ee=(()=>{class l{}return l.\u0275fac=function(e){return new(e||l)},l.\u0275mod=i.oAB({type:l}),l.\u0275inj=i.cJS({imports:[[D.ez,O.u5,be,le.$Q]]}),l})();var Re=u(6412),Ae=u(3507),je=u(2405),Le=u(8975),Ue=u(5517),Oe=u(2045),ze=u(7991),We=u(4337),He=u(5901),Ie=u(702);function Fe(l,g){1&l&&(i.TgZ(0,"mat-card",5),i._UZ(1,"deja-markdown",6),i.qZA()),2&l&&(i.xp6(1),i.Q6J("url","https://raw.githubusercontent.com/DSI-HUG/dejajs-components/develop/projects/deja-js/component/tiles/readme.txt"))}function Ne(l,g){if(1&l){const e=i.EpF();i.TgZ(0,"button",11),i.NdJ("click",function(){return i.CHM(e),i.oxw(2).$implicit.cancel(!1)}),i._uU(1," Ok "),i.qZA(),i.TgZ(2,"button",12),i.NdJ("click",function(){return i.CHM(e),i.oxw(2).$implicit.cancel(!0)}),i._uU(3," Annuler "),i.qZA()}}function Ze(l,g){if(1&l){const e=i.EpF();i.TgZ(0,"deja-snackbar",8),i.NdJ("onAnimationDone",function(){return i.CHM(e),i.oxw().$implicit.cancel(!1)}),i.TgZ(1,"deja-message-box",9),i._uU(2),i.YNc(3,Ne,4,0,"ng-template",null,10,i.W1O),i.qZA(),i.qZA()}if(2&l){const e=i.oxw().$implicit;i.Q6J("duration",8e3),i.xp6(1),i.Q6J("type",e.type)("title",e.title),i.xp6(1),i.hij(" ",e.content," ")}}function Ve(l,g){1&l&&i.YNc(0,Ze,5,4,"deja-snackbar",7),2&l&&i.Q6J("ngIf",g.$implicit.gate)}function Xe(l,g){if(1&l&&(i.TgZ(0,"div",23),i._uU(1),i.TgZ(2,"span",24),i._uU(3,"Selected"),i.qZA(),i.TgZ(4,"span",25),i._uU(5,"Pressed"),i.qZA(),i.qZA()),2&l){const e=g.$implicit;i.Udp("background-color",e.color),i.xp6(1),i.AsE("",e.templateModel.naqme," (",e.templateModel.code,") ")}}function Ye(l,g){if(1&l&&(i.TgZ(0,"div",23),i._uU(1),i.TgZ(2,"span",24),i._uU(3,"Selected"),i.qZA(),i.TgZ(4,"span",25),i._uU(5,"Pressed"),i.qZA(),i.qZA()),2&l){const e=g.$implicit;i.Udp("background-color",e.color),i.xp6(1),i.AsE("",e.templateModel.naqme," (",e.templateModel.code,") ")}}function Je(l,g){if(1&l){const e=i.EpF();i.TgZ(0,"mat-card",5),i.TgZ(1,"mat-toolbar",13),i._uU(2,"Tiles Demo"),i.qZA(),i.TgZ(3,"mat-card-content",14),i.TgZ(4,"mat-checkbox",15),i.NdJ("ngModelChange",function(n){return i.CHM(e),i.oxw().designMode=n}),i._uU(5,"Design Mode"),i.qZA(),i.qZA(),i.TgZ(6,"mat-card-content"),i.TgZ(7,"span",16,17),i._uU(9," Drop Area "),i.qZA(),i.qZA(),i.TgZ(10,"mat-card-content"),i.TgZ(11,"deja-tiles",18,19),i.NdJ("contentAdding",function(n){return i.CHM(e),i.oxw().onContentAdding(n)})("contentRemoving",function(n){return i.CHM(e),i.oxw().onContentRemoving(n)}),i.ALo(13,"async"),i.YNc(14,Xe,6,4,"ng-template",null,20,i.W1O),i.qZA(),i.qZA(),i.TgZ(16,"mat-card-content"),i.TgZ(17,"deja-tiles",21,22),i.NdJ("contentAdding",function(n){return i.CHM(e),i.oxw().onContentAdding(n)})("contentRemoving",function(n){return i.CHM(e),i.oxw().onContentRemoving(n)}),i.ALo(19,"async"),i.YNc(20,Ye,6,4,"ng-template",null,20,i.W1O),i.qZA(),i.qZA(),i.qZA()}if(2&l){const e=i.MAs(8),t=i.oxw();i.xp6(4),i.Q6J("ngModel",t.designMode),i.xp6(3),i.Q6J("mouse-droppable",t.getDropContext(e)),i.xp6(4),i.Q6J("models",i.lcZ(13,6,t.tiles1$))("mouse-draggable",t.getDragContext()),i.xp6(6),i.Q6J("models",i.lcZ(19,8,t.tiles2$))("designMode",t.designMode)}}const Ge=Ae.Bz.forChild([{path:"",component:(()=>{class l{constructor(e){this.countriesService=e,this.tabIndex=1,this.designMode=!1,this.message$=new _.x,this.messages$=this.message$.pipe((0,je.R)((t,n)=>[...t,n],[]),(0,Le.d)([]))}ngOnInit(){let e=0,t=0,n=0,s=0;this.countriesMap=new Map;const o=this.countriesService.getCountries$().pipe((0,I.w)(a=>a));this.tiles1$=o.pipe((0,U.q)(12),(0,H.U)(a=>{const r=new oe;return r.percentBounds=new x.U(e,t,15,15),r.color=a.color,r.templateModel=a,e+=15,e+15>100&&(e=0,t+=15),this.countriesMap.set(r.id,a),r}),(0,ae.u)((a,r)=>[...a,r],[])),this.tiles2$=o.pipe((0,H.U)(a=>{const r=new oe;return r.percentBounds=new x.U(n,s,15,15),r.color=a.color,r.templateModel=a,n+=15,n+15>100&&(n=0,s+=15),r}),(0,ae.u)((a,r)=>[...a,r],[]))}getDragContext(){return{target:"deja-tile",className:"deja-tile-cursor",dragStart:e=>{const t=this.countriesMap.get(e.id),n=new oe;return n.percentBounds=new x.U(0,0,15,15),n.color=t.color,n.templateModel=t,{country:t,tile:n}}}}getDropContext(e){return{dragEnter:t=>({width:200,height:60,className:"country-target-cursor"}),drop:t=>{const n=t.country;e.innerText=`The dropped country is ${n.naqme} - the code is: ${n.code}`}}}onContentAdding(e){this.message$.next({title:"Tiles added",content:`${e.added.length} tiles added.`,type:"warn",gate:!0,cancel:function(t){this.gate=!1,e.cancel$.next(t)}}),e.preventDefault()}onContentRemoving(e){this.message$.next({title:"Tiles deleted",content:`${e.removed.length} tiles deleted.`,type:"warn",gate:!0,cancel:function(t){this.gate=!1,e.cancel$.next(t)}}),e.preventDefault()}}return l.\u0275fac=function(e){return new(e||l)(i.Y36(Ue.K))},l.\u0275cmp=i.Xpm({type:l,selectors:[["deja-tiles-demo"]],decls:8,vars:6,consts:[[3,"selectedIndex","selectedTabChange"],["label","API REFERENCE"],["label","EXAMPLES"],["class","demo-card demo-basic",4,"ngIf"],["ngFor","",3,"ngForOf"],[1,"demo-card","demo-basic"],[3,"url"],["alignment","bottom right",3,"duration","onAnimationDone",4,"ngIf"],["alignment","bottom right",3,"duration","onAnimationDone"],[3,"type","title"],["actionsTemplate",""],["mat-raised-button","","color","primary",3,"click"],["mat-raised-button","",3,"click"],["color","primary"],["id","actions"],[3,"ngModel","ngModelChange"],["id","droparea",3,"mouse-droppable"],["dropArea",""],["id","tiles1","maxwidth","100%","tileminwidth","5%","tileminheight","5%","tilemaxheight","50%","tilemaxwidth","50%",3,"models","mouse-draggable","contentAdding","contentRemoving"],["tiles1",""],["tileTemplate",""],["id","tiles2","canDelete","","canCopy","","canCut","","canPaste","","maxwidth","100%","tileminwidth","5%","tileminheight","5%","tilemaxheight","50%","tilemaxwidth","50%",3,"models","designMode","contentAdding","contentRemoving"],["tiles2",""],[1,"tile-content","noselect"],["id","selected"],["id","pressed"]],template:function(e,t){1&e&&(i.TgZ(0,"mat-tab-group",0),i.NdJ("selectedTabChange",function(s){return t.tabIndex=s.index}),i._UZ(1,"mat-tab",1),i._UZ(2,"mat-tab",2),i.qZA(),i.YNc(3,Fe,2,1,"mat-card",3),i.YNc(4,Ve,1,1,"ng-template",4),i.ALo(5,"async"),i.YNc(6,Je,22,10,"mat-card",3),i._UZ(7,"mouse-dragdrop-cursor")),2&e&&(i.Q6J("selectedIndex",t.tabIndex),i.xp6(3),i.Q6J("ngIf",0===t.tabIndex),i.xp6(1),i.Q6J("ngForOf",i.lcZ(5,4,t.messages$)),i.xp6(2),i.Q6J("ngIf",1===t.tabIndex))},directives:[Y.SP,Y.uX,D.O5,D.sg,Oe.S,X.a8,ze.F,We.w,He.b,V.lW,te.Ye,X.dn,ee.oG,O.JJ,O.On,de.d,Be,Ie.l],pipes:[D.Ov],styles:["deja-tiles-demo .demo-basic{padding:0}deja-tiles-demo .demo-full-width{width:100%}deja-tiles-demo .demo-icons{font-size:100%;height:inherit;vertical-align:top;width:inherit}deja-tiles-demo .demo-card{margin:16px}deja-tiles-demo .demo-card mat-card-content{display:flex;flex-direction:column;margin:2rem}deja-tiles-demo #actions{display:flex;flex-direction:row;align-items:center;justify-content:space-between}deja-tiles-demo #droparea{height:5rem;background-color:#f57c00;width:50%;display:block}deja-tiles-demo #tiles1{height:370px;display:block}deja-tiles-demo #tiles2{height:1000px;display:block}deja-tiles-demo deja-tile{-webkit-user-select:none;-moz-user-select:none;user-select:none}deja-tiles-demo deja-tile #selected{display:none}deja-tiles-demo deja-tile #pressed{display:none}deja-tiles-demo deja-tile[selected] #selected{display:block}deja-tiles-demo deja-tile[pressed] #pressed{display:block}deja-tiles-demo deja-tile .tile-content{width:100%;height:100%;display:block}@media screen and (min-width: 1401px){deja-tiles-demo deja-tiles{font-size:100%}}@media screen and (max-width: 1400px){deja-tiles-demo deja-tiles{font-size:90%}}@media screen and (max-width: 1200px){deja-tiles-demo deja-tiles{font-size:85%}}@media screen and (max-width: 768px){deja-tiles-demo deja-tiles{font-size:80%}}@media screen and (max-width: 640px){deja-tiles-demo deja-tiles{font-size:70%}}@media screen and (max-width: 320px){deja-tiles-demo deja-tiles{font-size:60%}}.deja-tile-cursor .tile-content{width:100%;height:100%;display:block;opacity:.8}.country-target-cursor .tile-content{background-color:#f4a460!important;width:100%;height:100%;display:block;opacity:.8}\n"],encapsulation:2}),l})()},{path:"**",redirectTo:"",pathMatch:"full"}]);let qe=(()=>{class l{}return l.\u0275fac=function(e){return new(e||l)},l.\u0275mod=i.oAB({type:l}),l.\u0275inj=i.cJS({providers:[],imports:[[D.ez,Re.O,N.J,J.n,Ee,O.u5,V.ot,X.QW,ee.p9,Y.Nh,te.g0,le.$Q,Ge]]}),l})()}}]);