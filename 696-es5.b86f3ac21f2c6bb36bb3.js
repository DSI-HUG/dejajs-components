!function(){function e(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,i){if(!e)return;if("string"==typeof e)return t(e,i);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return t(e,i)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function i(e,t,n){return(i="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,i){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=u(e)););return e}(e,t);if(n){var r=Object.getOwnPropertyDescriptor(n,t);return r.get?r.get.call(i):r.value}})(e,t,n||e)}function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function r(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var i,n=u(e);if(t){var r=u(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return l(this,i)}}function l(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?c(e):t}function c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(self.webpackChunkdejajs_component=self.webpackChunkdejajs_component||[]).push([[696],{31696:function(t,n,s){"use strict";s.r(n),s.d(n,{DejaTilesDemoModule:function(){return Te}});var l=s(61511),h=s(16073),f=s(15980),g=s(27439),p=s(29236),m=s(55109),v=s(33104),y=s(19154),b=s(87320),x=s(31572),k=s(71522),w=s(19861),M=s(11353),_=s(43490);function T(e,t){if(1&e&&(x.O4$(),x._UZ(0,"circle",3)),2&e){var i=x.oxw();x.Udp("animation-name","mat-progress-spinner-stroke-rotate-"+i._spinnerAnimationLabel)("stroke-dashoffset",i._getStrokeDashOffset(),"px")("stroke-dasharray",i._getStrokeCircumference(),"px")("stroke-width",i._getCircleStrokeWidth(),"%"),x.uIk("r",i._getCircleRadius())}}function P(e,t){if(1&e&&(x.O4$(),x._UZ(0,"circle",3)),2&e){var i=x.oxw();x.Udp("stroke-dashoffset",i._getStrokeDashOffset(),"px")("stroke-dasharray",i._getStrokeCircumference(),"px")("stroke-width",i._getCircleStrokeWidth(),"%"),x.uIk("r",i._getCircleRadius())}}var C=(0,k.pj)(function e(t){d(this,e),this._elementRef=t},"primary"),B=new x.OlP("mat-progress-spinner-default-options",{providedIn:"root",factory:function(){return{diameter:100}}}),$=function(){var e=function(e){o(i,e);var t=a(i);function i(e,n,r,o,s){var a;d(this,i),(a=t.call(this,e))._elementRef=e,a._document=r,a._diameter=100,a._value=0,a._fallbackAnimation=!1,a.mode="determinate";var l=i._diameters;return a._spinnerAnimationLabel=a._getSpinnerAnimationLabel(),l.has(r.head)||l.set(r.head,new Set([100])),a._fallbackAnimation=n.EDGE||n.TRIDENT,a._noopAnimations="NoopAnimations"===o&&!!s&&!s._forceAnimations,s&&(s.diameter&&(a.diameter=s.diameter),s.strokeWidth&&(a.strokeWidth=s.strokeWidth)),a}return r(i,[{key:"diameter",get:function(){return this._diameter},set:function(e){this._diameter=(0,w.su)(e),this._spinnerAnimationLabel=this._getSpinnerAnimationLabel(),!this._fallbackAnimation&&this._styleRoot&&this._attachStyleNode()}},{key:"strokeWidth",get:function(){return this._strokeWidth||this.diameter/10},set:function(e){this._strokeWidth=(0,w.su)(e)}},{key:"value",get:function(){return"determinate"===this.mode?this._value:0},set:function(e){this._value=Math.max(0,Math.min(100,(0,w.su)(e)))}},{key:"ngOnInit",value:function(){var e=this._elementRef.nativeElement;this._styleRoot=(0,M.kV)(e)||this._document.head,this._attachStyleNode(),e.classList.add("mat-progress-spinner-indeterminate".concat(this._fallbackAnimation?"-fallback":"","-animation"))}},{key:"_getCircleRadius",value:function(){return(this.diameter-10)/2}},{key:"_getViewBox",value:function(){var e=2*this._getCircleRadius()+this.strokeWidth;return"0 0 ".concat(e," ").concat(e)}},{key:"_getStrokeCircumference",value:function(){return 2*Math.PI*this._getCircleRadius()}},{key:"_getStrokeDashOffset",value:function(){return"determinate"===this.mode?this._getStrokeCircumference()*(100-this._value)/100:this._fallbackAnimation&&"indeterminate"===this.mode?.2*this._getStrokeCircumference():null}},{key:"_getCircleStrokeWidth",value:function(){return this.strokeWidth/this.diameter*100}},{key:"_attachStyleNode",value:function(){var e=this._styleRoot,t=this._diameter,n=i._diameters,r=n.get(e);if(!r||!r.has(t)){var o=this._document.createElement("style");o.setAttribute("mat-spinner-animation",this._spinnerAnimationLabel),o.textContent=this._getAnimationText(),e.appendChild(o),r||(r=new Set,n.set(e,r)),r.add(t)}}},{key:"_getAnimationText",value:function(){var e=this._getStrokeCircumference();return"\n @keyframes mat-progress-spinner-stroke-rotate-DIAMETER {\n    0%      { stroke-dashoffset: START_VALUE;  transform: rotate(0); }\n    12.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(0); }\n    12.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(72.5deg); }\n    25%     { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(72.5deg); }\n\n    25.0001%   { stroke-dashoffset: START_VALUE;  transform: rotate(270deg); }\n    37.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(270deg); }\n    37.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(161.5deg); }\n    50%     { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(161.5deg); }\n\n    50.0001%  { stroke-dashoffset: START_VALUE;  transform: rotate(180deg); }\n    62.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(180deg); }\n    62.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(251.5deg); }\n    75%     { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(251.5deg); }\n\n    75.0001%  { stroke-dashoffset: START_VALUE;  transform: rotate(90deg); }\n    87.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(90deg); }\n    87.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(341.5deg); }\n    100%    { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(341.5deg); }\n  }\n".replace(/START_VALUE/g,""+.95*e).replace(/END_VALUE/g,""+.2*e).replace(/DIAMETER/g,"".concat(this._spinnerAnimationLabel))}},{key:"_getSpinnerAnimationLabel",value:function(){return this.diameter.toString().replace(".","_")}}]),i}(C);return e.\u0275fac=function(t){return new(t||e)(x.Y36(x.SBq),x.Y36(M.t4),x.Y36(l.K0,8),x.Y36(_.Qb,8),x.Y36(B))},e.\u0275cmp=x.Xpm({type:e,selectors:[["mat-progress-spinner"]],hostAttrs:["role","progressbar","tabindex","-1",1,"mat-progress-spinner"],hostVars:10,hostBindings:function(e,t){2&e&&(x.uIk("aria-valuemin","determinate"===t.mode?0:null)("aria-valuemax","determinate"===t.mode?100:null)("aria-valuenow","determinate"===t.mode?t.value:null)("mode",t.mode),x.Udp("width",t.diameter,"px")("height",t.diameter,"px"),x.ekj("_mat-animation-noopable",t._noopAnimations))},inputs:{color:"color",mode:"mode",diameter:"diameter",strokeWidth:"strokeWidth",value:"value"},exportAs:["matProgressSpinner"],features:[x.qOj],decls:3,vars:8,consts:[["preserveAspectRatio","xMidYMid meet","focusable","false","aria-hidden","true",3,"ngSwitch"],["cx","50%","cy","50%",3,"animation-name","stroke-dashoffset","stroke-dasharray","stroke-width",4,"ngSwitchCase"],["cx","50%","cy","50%",3,"stroke-dashoffset","stroke-dasharray","stroke-width",4,"ngSwitchCase"],["cx","50%","cy","50%"]],template:function(e,t){1&e&&(x.O4$(),x.TgZ(0,"svg",0),x.YNc(1,T,1,9,"circle",1),x.YNc(2,P,1,7,"circle",2),x.qZA()),2&e&&(x.Udp("width",t.diameter,"px")("height",t.diameter,"px"),x.Q6J("ngSwitch","indeterminate"===t.mode),x.uIk("viewBox",t._getViewBox()),x.xp6(1),x.Q6J("ngSwitchCase",!0),x.xp6(1),x.Q6J("ngSwitchCase",!1))},directives:[l.RF,l.n9],styles:[".mat-progress-spinner{display:block;position:relative;overflow:hidden}.mat-progress-spinner svg{position:absolute;transform:rotate(-90deg);top:0;left:0;transform-origin:center;overflow:visible}.mat-progress-spinner circle{fill:transparent;transform-origin:center;transition:stroke-dashoffset 225ms linear}._mat-animation-noopable.mat-progress-spinner circle{transition:none;animation:none}.cdk-high-contrast-active .mat-progress-spinner circle{stroke:currentColor;stroke:CanvasText}.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate] svg{animation:mat-progress-spinner-linear-rotate 2000ms linear infinite}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate] svg{transition:none;animation:none}.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate] circle{transition-property:stroke;animation-duration:4000ms;animation-timing-function:cubic-bezier(0.35, 0, 0.25, 1);animation-iteration-count:infinite}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate] circle{transition:none;animation:none}.mat-progress-spinner.mat-progress-spinner-indeterminate-fallback-animation[mode=indeterminate] svg{animation:mat-progress-spinner-stroke-rotate-fallback 10000ms cubic-bezier(0.87, 0.03, 0.33, 1) infinite}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-fallback-animation[mode=indeterminate] svg{transition:none;animation:none}.mat-progress-spinner.mat-progress-spinner-indeterminate-fallback-animation[mode=indeterminate] circle{transition-property:stroke}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-fallback-animation[mode=indeterminate] circle{transition:none;animation:none}@keyframes mat-progress-spinner-linear-rotate{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes mat-progress-spinner-stroke-rotate-100{0%{stroke-dashoffset:268.606171575px;transform:rotate(0)}12.5%{stroke-dashoffset:56.5486677px;transform:rotate(0)}12.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(72.5deg)}25%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(72.5deg)}25.0001%{stroke-dashoffset:268.606171575px;transform:rotate(270deg)}37.5%{stroke-dashoffset:56.5486677px;transform:rotate(270deg)}37.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(161.5deg)}50%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(161.5deg)}50.0001%{stroke-dashoffset:268.606171575px;transform:rotate(180deg)}62.5%{stroke-dashoffset:56.5486677px;transform:rotate(180deg)}62.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(251.5deg)}75%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(251.5deg)}75.0001%{stroke-dashoffset:268.606171575px;transform:rotate(90deg)}87.5%{stroke-dashoffset:56.5486677px;transform:rotate(90deg)}87.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(341.5deg)}100%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(341.5deg)}}@keyframes mat-progress-spinner-stroke-rotate-fallback{0%{transform:rotate(0deg)}25%{transform:rotate(1170deg)}50%{transform:rotate(2340deg)}75%{transform:rotate(3510deg)}100%{transform:rotate(4680deg)}}\n"],encapsulation:2,changeDetection:0}),e._diameters=new WeakMap,e}(),D=function(){var e=function e(){d(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=x.oAB({type:e}),e.\u0275inj=x.cJS({imports:[[k.BQ,l.ez],k.BQ]}),e}(),A=s(40852),R=s(27312),S=s(43835),L=s(90611),E=s(66599),U=s(60509),z=s(25416),O=s(47701),j=s(79996),W=s(44689),N=s(18863),H=s(55959),I=s(78512),Z=s(31906),q=s(87254),F=s(40878),Q=s(19764),V=s(81110),X=s(66994),Y=s(64762);function J(e,t){}function K(e,t){if(1&e&&x._UZ(0,"mat-progress-spinner",2),2&e){var i=x.oxw();x.Q6J("diameter",i.progressDiameter)}}var G=function(e){return{$implicit:e}},ee=["tileTemplate"],te=["tilesContainer"];function ie(e,t){if(1&e){var i=x.EpF();x.TgZ(0,"deja-tile",4),x.NdJ("close",function(){var e=x.CHM(i).$implicit;return x.oxw().onTileClosed(e)}),x.qZA()}if(2&e){var n=t.$implicit,r=t.index,o=x.oxw();x.Q6J("id",n.id)("tile",n)("template",o.tileTemplate),x.uIk("tile-index",r)}}var ne=function(){var e=function(e){o(i,e);var t=a(i);function i(e,n){var r;return d(this,i),(r=t.call(this)).changeDetectorRef=n,r.close=new x.vpe,r.progressDiameter=100,r.element=e.nativeElement,r.element.setAttribute("hidden","0"),r}return r(i,[{key:"tile",get:function(){return this._tile},set:function(e){var t=this;if(this._tile=e,e){var i=function(e,i){i?t.element.setAttribute(e,i.toString()):t.element.removeAttribute(e)};e.fading&&(this.element.setAttribute("fading","0"),this.changeDetectorRef.markForCheck()),e.pixelBounds$.pipe((0,S.h)(function(e){return!!e}),(0,L.q)(1),(0,S.h)(function(){return e.fading}),(0,E.b)(function(){t.element.setAttribute("fading","1"),t.changeDetectorRef.markForCheck()}),(0,U.g)(200),(0,z.R)(this.destroyed$)).subscribe(function(){t.element.removeAttribute("fading"),t.changeDetectorRef.markForCheck()}),e.pixelBounds$.pipe((0,S.h)(function(e){return!!e}),(0,z.R)(this.destroyed$)).subscribe(function(i){e.isHidden||t.element.removeAttribute("hidden"),t.element.style.left="".concat(i.left,"px"),t.element.style.top="".concat(i.top,"px"),t.element.style.width="".concat(i.width,"px"),t.element.style.height="".concat(i.height,"px"),t.progressDiameter=Math.min(100,Math.round(Math.max(.4*i.width,.4*i.height))),t.changeDetectorRef.markForCheck()}),e.pressed$.pipe((0,E.b)(function(e){return i("pressed",e)}),(0,z.R)(this.destroyed$)).subscribe(function(){return t.changeDetectorRef.markForCheck()}),e.selected$.pipe((0,E.b)(function(e){return i("selected",e)}),(0,z.R)(this.destroyed$)).subscribe(function(){return t.changeDetectorRef.markForCheck()}),e.dragging$.pipe((0,E.b)(function(e){return i("drag",e)}),(0,z.R)(this.destroyed$)).subscribe(function(){return t.changeDetectorRef.markForCheck()}),e.dropping$.pipe((0,E.b)(function(e){return i("drop",e)}),(0,z.R)(this.destroyed$)).subscribe(function(){return t.changeDetectorRef.markForCheck()}),e.cutted$.pipe((0,E.b)(function(e){return i("cutted",e)}),(0,z.R)(this.destroyed$)).subscribe(function(){return t.changeDetectorRef.markForCheck()}),e.deleted$.pipe((0,E.b)(function(){return t.element.remove()}),(0,z.R)(this.destroyed$)).subscribe(function(){return t.changeDetectorRef.markForCheck()});var n=e.hidden$.pipe((0,E.b)(function(e){return i("hidden",e?"1":"2")}));n.pipe((0,O.b)(1e3),(0,S.h)(function(e){return e}),(0,E.b)(function(){return t.element.setAttribute("hidden","0")}),(0,z.R)(this.destroyed$)).subscribe(function(){return t.changeDetectorRef.markForCheck()}),n.pipe((0,O.b)(1),(0,S.h)(function(e){return!e}),(0,E.b)(function(){return t.element.removeAttribute("hidden")}),(0,z.R)(this.destroyed$)).subscribe(function(){return t.changeDetectorRef.markForCheck()}),e.refresh$.pipe((0,O.b)(1),(0,z.R)(this.destroyed$)).subscribe(function(){return t.changeDetectorRef.markForCheck()})}}}]),i}(R.yl);return e.\u0275fac=function(t){return new(t||e)(x.Y36(x.SBq),x.Y36(x.sBO))},e.\u0275cmp=x.Xpm({type:e,selectors:[["deja-tile"]],inputs:{template:"template",tile:"tile"},outputs:{close:"close"},features:[x.qOj],decls:2,vars:5,consts:[[3,"ngTemplateOutlet","ngTemplateOutletContext"],["mode","indeterminate","class","accent",3,"diameter",4,"ngIf"],["mode","indeterminate",1,"accent",3,"diameter"]],template:function(e,t){1&e&&(x.YNc(0,J,0,0,"ng-template",0),x.YNc(1,K,1,1,"mat-progress-spinner",1)),2&e&&(x.Q6J("ngTemplateOutlet",t.template)("ngTemplateOutletContext",x.VKq(3,G,t.tile)),x.xp6(1),x.Q6J("ngIf",t.tile&&t.tile.isPending))},directives:[l.tP,l.O5,$],styles:['[_nghost-%COMP%]{display:block;position:absolute;transition-property:left,top,opacity;transition-duration:.5s;transition-timing-function:ease;opacity:1}[expanded][_nghost-%COMP%]{transition-property:height}[cutted][_nghost-%COMP%]{opacity:.5}[drag][_nghost-%COMP%], [drop][_nghost-%COMP%]{z-index:100}[drag][_nghost-%COMP%]{opacity:.5;-webkit-user-select:none;-moz-user-select:none;user-select:none;transition:none}[fading="0"][_nghost-%COMP%]{opacity:0;transition:none}[fading="1"][_nghost-%COMP%]{opacity:0}[hidden="0"][_nghost-%COMP%]{visibility:hidden;transition:none}[hidden="1"][_nghost-%COMP%]{opacity:0;transition:opacity 1s ease-in-out}[hidden="2"][_nghost-%COMP%]{visibility:visible;opacity:0;transition:none}[_nghost-%COMP%]   mat-progress-spinner[_ngcontent-%COMP%]{position:absolute;z-index:1;right:.2rem;bottom:.2rem;transform:translate(-60%,-60%)}'],changeDetection:0}),e}(),re=function(){var e=function(){function e(t){d(this,e),this.element=t.nativeElement,this.element.style.display="none"}return r(e,[{key:"bounds",set:function(e){if(e){var t=e.left,i=e.top,n=e.width,r=e.height;this.element.style.left="".concat(t,"px"),this.element.style.top="".concat(i,"px"),this.element.style.width="".concat(n,"px"),this.element.style.height="".concat(r,"px"),this.element.style.display="block"}else this.element.style.display="none"}}]),e}();return e.\u0275fac=function(t){return new(t||e)(x.Y36(x.SBq))},e.\u0275dir=x.lG2({type:e,selectors:[["","deja-tile-position",""]],inputs:{bounds:"bounds"}}),e}(),oe=function(){var e=function(e){o(i,e);var t=a(i);function i(e){var n;d(this,i),(n=t.call(this)).clipboardService=e,n.refreshTiles$=new H.xQ,n.ensureVisible$=new H.xQ,n.ensureBounds$=new H.xQ,n.dragging$=new I.X(!1),n.dragSelection$=new H.xQ,n.dragDropInfos$=new H.xQ,n.selectionRect$=new H.xQ,n.dragover$=new H.xQ,n.dragleave$=new H.xQ,n.deleteTiles$=new H.xQ,n.designMode=!1,n.layoutCompleted=new H.xQ,n.layoutChanged=new H.xQ,n.tilesAdded=new H.xQ,n.tilesDeleted=new H.xQ,n.selectionChanged=new H.xQ,n.contentAdding=new H.xQ,n.contentRemoving=new H.xQ,n._tileMinWidth=10,n._tileMinWidthUnit="%",n._tileMaxWidth=100,n._tileMaxWidthUnit="%",n._tileMinHeight=10,n._tileMinHeightUnit="%",n._tileMaxHeight=100,n._tileMaxHeightUnit="%",n._maxWidth=100,n._maxWidthUnit="%",n.tilesDic=new Map,n._targetBounds=new R.UL,n.destination=new R.UL,n.dragPageOffset=new R.Ly,n.dragOriginalPosition=new R.Ly,n.selectedIds=new Array,n.refreshTiles$.pipe((0,O.b)(30),(0,E.b)(function(){n.container.style.width="",n.container.style.height=""}),(0,U.g)(10),(0,z.R)(n.destroyed$)).subscribe(function(e){var t=new Array,i=n.container.getBoundingClientRect();!(null==e?void 0:e.resetWidth)&&n.hundredPercentWith||(n.hundredPercentWith=i.width);var r=i.height,o=i.width,s=0,a=0,l=n.tiles||new Array,c=new Array;l.forEach(function(e){if(e.percentBounds&&!e.percentBounds.isEmpty()){var i=n.getPixelBounds(e.percentBounds);i.bottom>s&&(s=i.right),i.right>a&&(a=i.bottom),e.isDragging||(e.pixelBounds=i)}else t.push(e);e.isSelected&&!e.isHidden&&c.push(e.id),e.pixelBounds&&e.pixelBounds.bottom>r&&(r=e.pixelBounds.bottom)});var u=a,d=0;if(t.forEach(function(e){e.percentBounds=e.percentBounds||new R.UL(n.getPercentSize(d),n.getPercentSize(u),3*n.getTileMinPercentWidth(),3*n.getTileMinPercentHeight());var t=n.getPixelBounds(e.percentBounds);t.right>o&&(u=a,d=0,e.percentBounds.left=0,e.percentBounds.top=n.getPercentSize(u),t=n.getPixelBounds(e.percentBounds)),t.bottom>a&&(a=t.bottom),e.pixelBounds=n.getPixelBounds(e.percentBounds),d+=t.width}),n.dragTarget){var h=n.getPixelBounds(n.dragTarget);r<=h.bottom&&(r=h.bottom+h.height),o<=h.right&&(o=h.right+h.width)}var f=n.getPixelSize(2*n._tileMinHeight,n._tileMinHeightUnit);r<f&&(r=f),n.container.style.width="".concat(o,"px"),n.container.style.height="".concat(r,"px"),(null==e?void 0:e.ensureVisible)&&n.ensureVisible$.next(e.ensureVisible),(null==e?void 0:e.ensureBounds)&&n.ensureBounds$.next(e.ensureBounds),n.selectedTiles=c;var g=new CustomEvent("DejaTilesEvent",{cancelable:!1});t.length>0&&(g.tiles=t,n.layoutChanged.next(g)),g.tiles=l,n.layoutCompleted.next(g)});var r=n.ensureVisible$.pipe((0,U.g)(1),(0,j.U)(function(e){return n.tilesDic.get(e)}),(0,S.h)(function(e){return!!e}),(0,j.U)(function(e){return e.percentBounds}));(0,Z.T)(n.ensureBounds$,r).pipe((0,z.R)(n.destroyed$)).subscribe(function(e){var t=n.getPixelBounds(e),i=t.left,r=t.right,o=t.top,s=t.bottom,a=function(e){for(;e&&"DEJA-TILES"!==e.tagName;)e=e.parentElement;return e}(n.container);if(a){var l=n.container.getBoundingClientRect(),c=a.getBoundingClientRect();i+l.left<c.bottom?a.scrollLeft+=i+l.left-c.bottom:r+l.left>c.right&&(a.scrollLeft+=r+l.left-c.right),o+l.top<c.top?a.scrollTop+=o+l.top-c.top:s+l.top>c.bottom&&(a.scrollTop+=s+l.top-c.bottom)}}),n.dragSelection$.pipe((0,W.w)(function(e){var t=(0,q.R)(n._container.ownerDocument,"mouseup").pipe((0,E.b)(function(){return n.selectionRect$.next(null)}));return(0,q.R)(n._container,"mousemove").pipe((0,z.R)(t),(0,S.h)(function(e){return 1===e.buttons}),(0,E.b)(function(t){var i=n._container.getBoundingClientRect();e.selectedRect=R.UL.fromPoints(e.startPosition,new R.Ly(t.pageX-i.left,t.pageY-i.top)),n.selectionRect$.next(e.selectedRect);var r=n.hitTest(e.selectedRect);n.selectedTiles=r.map(function(e){return e.id})}))}),(0,z.R)(n.destroyed$)).subscribe();var o=n.dragleave$;return n.dragDropInfos$.pipe((0,W.w)(function(e){var t,i=e&&((null===(t=e.tiles)||void 0===t?void 0:t.length)&&e.tiles||e.currentTile&&[e.currentTile]);if(!i)return(0,F.of)(null);var r=!e.tiles,s=(0,q.R)(n._container,"mousemove"),a=(0,q.R)(n._container.ownerDocument,"keyup").pipe((0,S.h)(function(e){return e.code===R.mW.Escape})),l=s.pipe((0,S.h)(function(e){return 1!==e.buttons})),c=(0,Z.T)(o,l,a).pipe((0,E.b)(function(){n.removeTemporaryTile(),n.cancelDrag(i)})),u=(0,q.R)(n._container.ownerDocument,"mouseup").pipe((0,E.b)(function(){return n.drop(i)})),d=(0,Z.T)(u,c),h=n.dragover$.pipe((0,j.U)(function(e){return e.originalEvent}));return(0,Z.T)(s,h).pipe((0,z.R)(d),(0,E.b)(function(t){var o=n._container.getBoundingClientRect(),s=t.pageX-o.left,a=t.pageY-o.top;if(e.enabled)n.drag(i,s,a);else if(Math.abs(e.startX-s)>=15||Math.abs(e.startY-a)>=15)if(r){var l=e.currentTile;n.selectedTiles=[l.id];var c=l.percentBounds;c&&!c.isEmpty()||(c=new R.UL(0,0,15,15));var u=n.getFreePlace(new R.UL(n.getPercentSize(s)-c.width/2,n.getPercentSize(a)-c.height/2,c.width,c.height));e.startX=u.left-c.width/2,e.startY=u.top-c.height/2,l.percentBounds=u,l.dragging$.next(!0),n._cursor="move",n.tiles.push(l),n.tilesDic.set(l.id,l),n.dragging$.next(!0),e.enabled=!0,n.startDrag(i,n.getPixelSize(u.left+u.width/2),n.getPixelSize(u.top+u.height/2))}else n.dragging$.next(!0),e.enabled=!0,n.startDrag(i,e.startX,e.startY)}))}),(0,z.R)(n.destroyed$)).subscribe(),n.deleteTiles$.pipe((0,z.R)(n.destroyed$)).subscribe(function(e){return n.deleteTiles(e)}),n}return r(i,[{key:"container",get:function(){return this._container},set:function(e){var t=this;if(this._container=e,this._container){var i=(0,q.R)(e,"mouseleave"),n=(0,q.R)(e.ownerDocument,"mouseup"),r=(0,q.R)(e,"mouseenter");r.pipe((0,W.w)(function(){if(t.designMode){var n=i.pipe((0,E.b)(function(){return t.container.style.cursor=""}));return(0,q.R)(e,"mousemove").pipe((0,z.R)(n),(0,S.h)(function(e){return!!t.container&&0===e.buttons}),(0,j.U)(function(e){return t._cursor=t.getCursorFromHtmlElement(e.pageX,e.pageY,e.target)}))}return(0,F.of)("")}),(0,z.R)(this.destroyed$)).subscribe(function(e){return t.container.style.cursor=e}),r.pipe((0,W.w)(function(){return(0,q.R)(e,"mousedown").pipe((0,S.h)(function(e){return 1===e.buttons}),(0,S.h)(function(e){return!t.isElementInsideDejaEditor(e.target)}),(0,j.U)(function(e){return{event:e,clickedTile:t.getTileComponentFromHTMLElement(e.target)}})).pipe((0,z.R)(i),(0,W.w)(function(e){var i=e.event,r=e.clickedTile,o=i.target;if(t.currentTile&&(t.currentTile.isPressed=!1),t.currentTile=r,t.currentTile){if(t.currentTile.isPressed=!0,i.ctrlKey);else if(t.currentTile.isSelected&&"move"===t._cursor||(t.selectedTiles=[t.currentTile.id]),t.designMode){var s=t._container.getBoundingClientRect();t.dragDropInfos$.next({enabled:!1,startX:i.pageX-s.left,startY:i.pageY-s.top,currentTile:t.currentTile,tiles:t.tiles.filter(function(e){return e.isSelected})})}return n.pipe((0,L.q)(1),(0,S.h)(function(){return!!t.currentTile}))}if(o===t.container||o.parentElement===t.container){if(1===i.buttons){var a=t._container.getBoundingClientRect();t.dragSelection$.next({startPosition:new R.Ly(i.pageX-a.left,i.pageY-a.top),selectedRect:new R.UL})}t.currentTile&&(t.currentTile.isPressed=!1),t.selectedTiles=[]}return(0,F.of)(null)}))}),(0,S.h)(function(e){return!!e}),(0,z.R)(this.destroyed$)).subscribe(function(e){t.currentTile.isPressed&&(t.currentTile.isPressed=!1,e.ctrlKey&&(t.currentTile.isSelected=!t.currentTile.isSelected,t.selectedTiles=t.tiles.filter(function(e){return e.isSelected}).map(function(e){return e.id}))),t.designMode&&(t._cursor=t.getCursorFromHtmlElement(e.pageX,e.pageY,e.target),t.container.style.cursor=t._cursor),t.currentTile=void 0})}}},{key:"tiles",get:function(){return this._tiles||(this._tiles=new Array)},set:function(e){this._tiles=e,this.tilesDic=this.tiles.reduce(function(e,t){return e.set(t.id,t)},new Map),this.refreshTiles$.next({resetWidth:!0})}},{key:"selectedTiles",set:function(e){var t,i=new Array,n=!1,r=e.reduce(function(e,t){return e.add(t)},new Set),o=this.selectedIds.reduce(function(e,t){return e.add(t)},new Set);if((null===(t=this.tiles)||void 0===t?void 0:t.length)?this.tiles.forEach(function(e){r.has(e.id)!==o.has(e.id)&&(n=!0),e.isSelected=r.has(e.id),e.isSelected&&i.push(e)}):n=this.selectedIds.length>0,this.selectedIds=e,n){var s=new CustomEvent("DejaTilesAddEvent",{cancelable:!1});s.tiles=i,this.selectionChanged.next(s)}}},{key:"tileMinWidth",set:function(e){this.extractValueAndUnit("_tileMinWidth",e)}},{key:"tileMaxWidth",set:function(e){this.extractValueAndUnit("_tileMaxWidth",e)}},{key:"tileMinHeight",set:function(e){this.extractValueAndUnit("_tileMinHeight",e)}},{key:"tileMaxHeight",set:function(e){this.extractValueAndUnit("_tileMaxHeight",e)}},{key:"maxWidth",set:function(e){this.extractValueAndUnit("_maxWidth",e)}},{key:"targetBounds",get:function(){return this._targetBounds},set:function(e){this._targetBounds=e,this.selectionRect$.next(e?new R.UL({height:this.getPixelSize(e.height||0),left:this.getPixelSize(e.left||0),top:this.getPixelSize(e.top||0),width:this.getPixelSize(e.width||0)}):null)}},{key:"copySelection",value:function(){var e=this.tiles.filter(function(e){return e.isSelected});return e.length&&this.copyTiles(e,!1),e}},{key:"cutSelection",value:function(){var e=this.tiles.filter(function(e){return e.isSelected});return e.length&&this.copyTiles(e,!0),e}},{key:"deleteSelection",value:function(){var e=this.tiles.filter(function(e){return e.isSelected});return e.length&&this.removeTiles(e.map(function(e){return e.id})),e}},{key:"paste",value:function(){if(!this.clipboardService||!this.clipboardService.isAvailable("tiles"))return new Array;var e,t=this.clipboardService.get("tiles");this.tiles.forEach(function(e){return e.isSelected=!1}),t.forEach(function(t){e=e?R.UL.union(e,t.percentBounds):new R.UL(t.percentBounds)});var i=this.getFreePlace(new R.UL(0,0,e.width,e.height)),n=t.map(function(t){var n=t.clone();return n.percentBounds=new R.UL(i.left+t.percentBounds.left-e.left,i.top+t.percentBounds.top-e.top,t.percentBounds.width,t.percentBounds.height),n.isSelected=!0,n});return this.addTiles(n),n}},{key:"getTileElementFromHTMLElement",value:function(e){for(var t=e;t&&"DEJA-TILE"!==t.tagName;)if((t=t.parentElement)===this.container)return;if((null==t?void 0:t.parentElement)===this.container)return t}},{key:"isElementInsideDejaEditor",value:function(e){for(var t=e;t&&t!==this.container;){if("DEJA-EDITOR"===t.tagName)return!0;t=t.parentElement}return!1}},{key:"getTileComponentFromHTMLElement",value:function(e){var t=this.getTileElementFromHTMLElement(e);return t&&this.tilesDic.get(t.id)}},{key:"deleteTiles",value:function(e){var t=this;if(e&&0!==e.length){var i=new CustomEvent("DejaTilesDeletedEvent",{cancelable:!1});i.tiles=e,e.forEach(function(e){t.tilesDic.delete(e.id),e.delete()});for(var n=this.tiles.length;--n>=0;)this.tilesDic.has(this.tiles[n].id)||this.tiles.splice(n,1);this.refreshTiles$.next({resetWidth:!0}),i.tiles=this.tiles,this.tilesDeleted.next(i)}}},{key:"removeTiles",value:function(e){var t=this;if(e&&0!==e.length){var i=e.map(function(e){return t.tilesDic.get(e)});i.forEach(function(e){e.isHidden=!0});var n=new CustomEvent("DejaTilesRemoveEvent",{cancelable:!0});n.tiles=this.tiles,n.removed=i,n.cancel$=new H.xQ;var r=n.cancel$.pipe((0,L.q)(1),(0,z.R)(this.destroyed$)).subscribe(function(e){e?i.forEach(function(e){return e.isHidden=!1}):t.deleteTiles(i)});this.contentRemoving.next(n),n.defaultPrevented||(r.unsubscribe(),this.deleteTiles(i))}}},{key:"getFreePlace",value:function(e){var t=new Array,i=this.tiles.filter(function(e){return!e.isDragging}),n=0;i.forEach(function(e){e.percentBounds.bottom>n&&(n=e.percentBounds.bottom)});for(var r=0;r<=this._maxWidth-e.width;r+=this._tileMinWidth)for(var o=function(n){var o=new R.UL(r,n,e.width,e.height);i.find(function(e){return e.percentBounds.intersectWith(o)})||t.push(o)},s=0;s<=n-e.height;s+=this._tileMinHeight)o(s);return t.length>0?(t.sort(function(t,i){var n=function(t){return Math.min(Math.abs(t.left-e.left),Math.abs(t.right-e.right))+200*Math.min(Math.abs(t.top-e.top),Math.abs(t.bottom-e.bottom))};return n(t)-n(i)}),t[0]):new R.UL(0,n,e.width,e.height)}},{key:"moveTile",value:function(e,t){var i=this.tiles.find(function(t){return t.id===e});i&&(i.percentBounds=t,this.refreshTiles$.next(null))}},{key:"hitTest",value:function(e){var t=new R.UL(this.getPercentSize(e.left),this.getPercentSize(e.top),this.getPercentSize(e.width),this.getPercentSize(e.height));return this.tiles.filter(function(e){return e.percentBounds.intersectWith(t)})}},{key:"getPercentSize",value:function(e){return Math.round(100*e/this.hundredPercentWith)}},{key:"dragEnter",value:function(e,t){if(!this.designMode||!this._container)return!1;var i=e.tile;if(!i)return!1;var n=this._container.getBoundingClientRect(),r=t.originalEvent,o=r.pageX,s=r.pageY,a=o-n.left,l=s-n.top,c=i.clone();return c.isTemporary=!0,this.dragDropInfos$.next({enabled:!1,startX:a,startY:l,currentTile:c}),!0}},{key:"startDrag",value:function(e,t,i){var n,r=this,o=this.saveLayout();e.forEach(function(e){n=n?R.UL.union(n,e.percentBounds):e.percentBounds,e.isDragging=!0}),this.dragRelativePosition=new Map,e.forEach(function(e){return r.dragRelativePosition.set(e.id,new R.Ly(e.percentBounds.left-n.left,e.percentBounds.top-n.top))}),this.dragPageOffset=new R.Ly(t,i),this.dragOriginalPosition=new R.Ly(n.left,n.top),this.targetBounds=o.targetBounds=o.validBounds=n,this.originalLayout=o,this.validLayout=void 0}},{key:"cancelDrag",value:function(e){this.clearMoveTimer(),(0,Q.D)(e).pipe((0,S.h)(function(e){return!!e}),(0,z.R)(this.destroyed$)).subscribe(function(e){e.isDragging=!1,e.isDropping=!0}),this.originalLayout&&this.restoreLayout(this.originalLayout),this.endDrag()}},{key:"drop",value:function(e){var t,i=this;if(this.clearMoveTimer(),this.validLayout){if(this.restoreLayout(this.validLayout),"move"!==this._cursor){var n=e[0];n.percentBounds=new R.UL(this.validLayout.validBounds),n.isDragging=!1}else(0,Q.D)(e).pipe((0,S.h)(function(e){return!!e}),(0,E.b)(function(e){var t=i.validLayout.validBounds.left+i.dragRelativePosition.get(e.id).left,n=i.validLayout.validBounds.top+i.dragRelativePosition.get(e.id).top;e.percentBounds=new R.UL(t,n,e.percentBounds.width,e.percentBounds.height),e.isDragging=!1,e.isDropping=!0,e.isTemporary&&(i.tilesDic.delete(e.id),e.makeId(),i.tilesDic.set(e.id,e),i.addTiles([e]))}),(0,U.g)(1e3),(0,z.R)(this.destroyed$)).subscribe(function(e){return e.isDropping=!1});t=this.tiles.filter(function(e){var t=i.originalLayout[e.id];return!R.UL.equals(e.percentBounds,null==t?void 0:t.bounds)}),this.endDrag()}else this.removeTemporaryTile(),this.cancelDrag(e);if(t){var r=new CustomEvent("DejaTilesEvent",{cancelable:!0});r.tiles=this.tiles,this.layoutChanged.next(r)}return t}},{key:"endDrag",value:function(){this.originalLayout=void 0,this.validLayout=void 0,this.targetBounds=void 0,this.dragging$.next(!1),this.dragDropInfos$.next(null),this.dragTarget=void 0,this.copyTiles(null),this.refreshTiles$.next(null)}},{key:"drag",value:function(e,t,i){var n=this,r=new R.Ly(t-this.dragPageOffset.left,i-this.dragPageOffset.top),o=r.left+this.getPixelSize(this.dragOriginalPosition.left),s=r.top+this.getPixelSize(this.dragOriginalPosition.top),a=this.getTileMinPixelSize(),l=this.getTileMaxPixelSize();if("move"!==this._cursor){var c=e[0],u=this.getPixelBounds(c.percentBounds),d=o+u.width,h=s+u.height,f=u.right,g=u.bottom;switch(this._cursor){case"nw-resize":u.left=Math.max(Math.min(o,u.right-a.width),u.right-l.width),u.right=f,u.top=Math.max(Math.min(s,u.bottom-a.height),u.bottom-l.height),u.bottom=g,this.size(c,new R.Ly(o,s),R.Ns.left+R.Ns.top);break;case"sw-resize":u.left=Math.max(Math.min(o,u.right-a.width),u.right-l.width),u.right=f,u.bottom=Math.max(Math.min(h,u.top+l.height),u.top+a.height),this.size(c,new R.Ly(o,h),R.Ns.left+R.Ns.bottom);break;case"w-resize":u.left=Math.max(Math.min(o,u.right-a.width),u.right-l.width),u.right=f,this.size(c,new R.Ly(o,0),R.Ns.left);break;case"ne-resize":u.right=Math.max(Math.min(d,u.left+l.width),u.left+a.width),u.top=Math.max(Math.min(s,u.bottom-a.height),u.bottom-l.height),u.bottom=g,this.size(c,new R.Ly(d,s),R.Ns.right+R.Ns.top);break;case"se-resize":u.right=Math.max(Math.min(d,u.left+l.width),u.left+a.width),u.bottom=Math.max(Math.min(h,u.top+l.height),u.top+a.height),this.size(c,new R.Ly(d,h),R.Ns.right+R.Ns.bottom);break;case"e-resize":u.right=Math.max(Math.min(d,u.left+l.width),u.left+a.width),this.size(c,new R.Ly(d,0),R.Ns.right);break;case"n-resize":u.top=Math.max(Math.min(s,u.bottom-a.height),u.bottom-l.height),u.bottom=g,this.size(c,new R.Ly(0,s),R.Ns.top);break;case"s-resize":u.bottom=Math.max(Math.min(h,u.top+l.height),u.top+a.height),this.size(c,new R.Ly(0,h),R.Ns.bottom)}c.pixelBounds=u}else e.forEach(function(e){e.pixelBounds=new R.UL(o+n.getPixelSize(n.dragRelativePosition.get(e.id).left),s+n.getPixelSize(n.dragRelativePosition.get(e.id).top),n.getPixelSize(e.percentBounds.width),n.getPixelSize(e.percentBounds.height))}),this.dragTarget=new R.UL(this.getPercentSize(o),this.getPercentSize(s),this.targetBounds.width,this.targetBounds.height),this.move()}},{key:"addTiles",value:function(e){var t,i=this;if(e&&0!==e.length){e.forEach(function(e){i.tiles.find(function(t){return t.id===e.id})||(i.tiles.find(function(t){var i;return e.percentBounds&&(null===(i=t.percentBounds)||void 0===i?void 0:i.intersectWith(e.percentBounds))})&&(e.percentBounds=void 0),e.percentBounds||(e.percentBounds=i.getFreePlace(e.idealBounds)),i.tiles.push(e),i.tilesDic.set(e.id,e))});var n=new CustomEvent("DejaTilesAddEvent",{cancelable:!0});n.tiles=this.tiles,n.added=e,n.cancel$=new H.xQ;var r,o=null===(t=this.clipboardService)||void 0===t?void 0:t.get("tiles-provider");o&&(r=this.clipboardService.get("tiles")).forEach(function(e){e.isHidden=!0});var s,a=function(e){r&&(o.next(r),i.clipboardService.clear());var t=new CustomEvent("DejaTileAddedEvent",{cancelable:!1});t.tiles=i.tiles,t.added=e,i.tilesAdded.next(t)};e.forEach(function(e){s=s?R.UL.union(s,e.percentBounds):new R.UL(e.percentBounds)}),this.refreshTiles$.next({ensureBounds:s}),this.contentAdding.next(n),n.defaultPrevented?(n.cancel$.pipe((0,L.q)(1),(0,S.h)(function(e){return!e}),(0,z.R)(this.destroyed$)).subscribe(a),n.cancel$.pipe((0,L.q)(1),(0,S.h)(function(e){return!!e}),(0,W.w)(function(){return r&&r.forEach(function(e){e.isHidden=!1,e.isCutted=!0}),(0,Q.D)(e)}),(0,E.b)(function(e){return e.isHidden=!0}),(0,U.g)(1e3),(0,N.u)(function(e,t){return(0,Y.fl)(e,[t])},new Array),(0,L.q)(1),(0,z.R)(this.destroyed$)).subscribe(function(e){return i.deleteTiles(e)})):a(e)}}},{key:"size",value:function(e,t,i){var n,r,o,s,a=new R.Ly(this.getPercentSize(t.left),this.getPercentSize(t.top)),l=e.percentBounds.clone(),c=e.percentBounds.clone();if(i&R.Ns.left){n=this.getTileMinPercentWidth(),o=this.getTileMaxPercentWidth();var u=a.left,d=l.left<u?n*Math.ceil(u/n):n*Math.floor(u/n),h=Math.min(o,Math.max(n,c.right-d));l.width=l.right-u,l.left=u,c.left=c.right-h,c.width=h}if(i&R.Ns.right){n=n||this.getTileMinPercentWidth(),o=o||this.getTileMaxPercentWidth();var f=a.left,g=l.right<f?n*Math.ceil(f/n):n*Math.floor(f/n);l.width=f-l.left,c.width=Math.min(o,Math.max(n,g-c.left))}if(i&R.Ns.top){r=this.getTileMinPercentHeight(),s=this.getTileMaxPercentHeight();var p=a.top,m=l.top<p?r*Math.ceil(p/r):r*Math.floor(p/r),v=Math.min(s,Math.max(r,c.bottom-m));l.height=l.bottom-p,l.top=p,c.top=c.bottom-v,c.height=v}if(i&R.Ns.bottom){r=r||this.getTileMinPercentHeight(),s=s||this.getTileMaxPercentHeight();var y=a.top,b=l.bottom<y?r*Math.ceil(y/r):r*Math.floor(y/r);l.height=y-l.top,c.height=Math.min(s,Math.max(r,b-c.top))}if(!R.UL.equals(c,this.destination))if(this.restoreLayout(this.originalLayout),this.destination=c.clone(),this.tiles.find(function(e){return!e.isDragging&&e.percentBounds.intersectWith(c)})){if(c){var x=this.ensureTarget(c,l,i);x&&(this.targetBounds=x,this.validLayout=this.saveLayout(),this.validLayout.targetBounds=c,this.validLayout.validBounds=x,this.refreshTiles$.next(null))}}else this.targetBounds=c,this.validLayout=this.saveLayout(),this.validLayout.targetBounds=this.validLayout.validBounds=c,this.refreshTiles$.next(null)}},{key:"clearMoveTimer",value:function(){this.moveTimOut&&(this.moveTimOut.unsubscribe(),this.moveTimOut=void 0)}},{key:"move",value:function(){var e=this,t=this.getTileMinPercentWidth(),i=this.getTileMinPercentHeight(),n=this.ensureContainer(new R.UL(t*Math.round(this.dragTarget.left/t),i*Math.round(this.dragTarget.top/i),this.dragTarget.width,this.dragTarget.height));if(!(this.lastTargetBounds&&Math.abs(n.left-this.lastTargetBounds.left)<t&&Math.abs(n.top-this.lastTargetBounds.top)<i)){this.lastTargetBounds=n;var r=this.tiles.filter(function(e){return!e.isDragging}).reduce(function(e,t){var i=R.UL.overlapInfos(t.percentBounds,n);return Math.max(Math.min(i.height,i.width),e)},0);if(this.tiles.find(function(t){var i=e.originalLayout[t.id];return null==i?void 0:i.bounds.intersectWith(n)})||this.restoreLayout(this.originalLayout),0===r)this.clearMoveTimer(),this.targetBounds=n.clone(),this.destination=n.clone(),this.validLayout=this.saveLayout(),this.validLayout.targetBounds=this.validLayout.validBounds=n,this.refreshTiles$.next(null);else{if(R.UL.equals(this.targetBounds,n)||this.clearMoveTimer(),r>3){var o=n.clone();this.moveTimOut=(0,V.H)(500).pipe((0,L.q)(1),(0,z.R)(this.destroyed$)).subscribe(function(){e.restoreLayout(e.originalLayout),e.destination=o;var t=e.ensureTarget(o,e.dragTarget,R.Ns.all);t&&(e.targetBounds=t,e.validLayout=e.saveLayout(),e.validLayout.targetBounds=o,e.validLayout.validBounds=t,e.refreshTiles$.next(null))})}for(var s=new Array,a=this.tiles.filter(function(e){return!e.isDragging}),l=Math.min(this.targetBounds.left,n.left);l<=Math.max(this.targetBounds.left,n.left);l++)for(var c=function(e){var t=new R.UL(l,e,n.width,n.height);a.find(function(e){return e.percentBounds.intersectWith(t)})||s.push(t)},u=Math.min(this.targetBounds.top,n.top);u<=Math.max(this.targetBounds.top,n.top);u++)c(u);s.length>0&&(s.sort(function(e,t){var i=function(e){return Math.min(Math.abs(e.left-n.left),Math.abs(e.right-n.right))+200*Math.min(Math.abs(e.top-n.top),Math.abs(e.bottom-n.bottom))};return i(e)-i(t)}),n=s[0],this.targetBounds=n.clone(),this.destination=n.clone(),this.validLayout=this.saveLayout(),this.validLayout.targetBounds=this.validLayout.validBounds=n,this.refreshTiles$.next(null))}}}},{key:"ensureContainer",value:function(e){e.left<0&&(e=e.offset(-e.left,0)),e.top<0&&(e=e.offset(0,-e.top));var t=this.getMaxPercentWidth();t&&e.right>t&&(e=e.offset(t-e.right,0));var i=this.getMaxPercentHeight();return i&&e.bottom>i&&(e=e.offset(0,i-e.bottom)),e}},{key:"ensureTarget",value:function(e,t,i,n){var r=this,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:10;t||(t=e),n||(n=e.clone()),i||(i=R.Ns.all);var s=new Array,a=new Array,l=new Array,c=new Array;if(this.tiles.filter(function(t){return!t.isDragging&&t.percentBounds.intersectWith(e)}).find(function(n){var o=new R.UL(r.dragOriginalPosition.left,r.dragOriginalPosition.top,e.width,e.height);if(Math.abs(n.percentBounds.left-t.left)<1&&Math.abs(n.percentBounds.top-t.top)<1&&Math.abs(n.percentBounds.width-t.width)<1&&Math.abs(n.percentBounds.height-t.height)<1&&(Math.abs(t.left-o.right)<=4||Math.abs(t.right-o.left)<=4||Math.abs(t.top-o.bottom)<=4||Math.abs(t.bottom-o.top)<=4))return n.percentBounds=o,!0;var u,d=n.percentBounds.left-t.left,h=t.right-n.percentBounds.right,f=n.percentBounds.top-t.top,g=t.bottom-n.percentBounds.bottom,p=Math.max(0,Math.min(n.percentBounds.right,t.right)-Math.max(n.percentBounds.left,t.left))/Math.min(n.percentBounds.width,t.width);switch(Math.max(0,Math.min(n.percentBounds.bottom,t.bottom)-Math.max(n.percentBounds.top,t.top))/Math.min(n.percentBounds.height,t.height)>=p&&i&R.Ns.horizontal?u=h>=d&&i&R.Ns.left?R.Ns.left:R.Ns.right:i&R.Ns.vertical&&(u=g>=f&&i&R.Ns.top?R.Ns.top:R.Ns.bottom),u){case R.Ns.left:s.push(n);break;case R.Ns.top:l.push(n);break;case R.Ns.right:a.push(n);break;default:c.push(n)}}))return e;var u=0;return s.length&&(u=this.pushHorizontal(e,-1,s))?(e=this.ensureContainer(e.offset(u,0)),o?this.ensureTarget(e,t,i&~R.Ns.left,n,o-1):null):(a.length&&(u=this.pushHorizontal(e,1,a)),u>0?(this.restoreLayout(this.originalLayout),o?this.ensureTarget(n,t,i&R.Ns.vertical,void 0,o-1):null):l.length&&(u=this.pushVertical(e,-1,l))?(e=this.ensureContainer(e.offset(0,u)),o?this.ensureTarget(e,t,R.Ns.bottom,void 0,o-1):null):(u=this.pushVertical(e,1,c))?null:e)}},{key:"saveLayout",value:function(){var e=this,t={};return t.height=this.getTileMinPercentHeight(),this.tiles.forEach(function(i){var n=e.getPixelSize(i.percentBounds.top||0),r=e.getPixelSize(i.percentBounds.height||e._tileMinHeight);n+r>t.height&&(t.height=n+r),t[i.id]={bounds:i.percentBounds.clone(),id:i.id}}),t}},{key:"getPixelBounds",value:function(e){return R.UL.fromLTRB(Math.round(e.left*this.hundredPercentWith/100),Math.round(e.top*this.hundredPercentWith/100),Math.round(e.right*this.hundredPercentWith/100),Math.round(e.bottom*this.hundredPercentWith/100))}},{key:"getPixelSize",value:function(e,t){return t&&"%"!==t?e:Math.round(e*this.hundredPercentWith/100)}},{key:"getSizePercentLimit",value:function(e){var t=this["".concat(e,"Unit")];return t&&"px"!==t?this[e]:this.getPercentSize(this[e])}},{key:"getSizePixelLimit",value:function(e){var t=this["".concat(e,"Unit")];return t&&"px"!==t?this.getPixelSize(this[e]):this[e]}},{key:"getTileMinPixelSize",value:function(){return new R.$u(this.getSizePixelLimit("_tileMinWidth"),this.getSizePixelLimit("_tileMinHeight"))}},{key:"getTileMaxPixelSize",value:function(){return new R.$u(this.getSizePixelLimit("_tileMaxWidth"),this.getSizePixelLimit("_tileMaxHeight"))}},{key:"getTileMinPercentWidth",value:function(){return Math.max(1,this.getSizePercentLimit("_tileMinWidth"))}},{key:"getTileMaxPercentWidth",value:function(){return Math.max(5,this.getSizePercentLimit("_tileMaxWidth"))}},{key:"getTileMinPercentHeight",value:function(){return Math.max(1,this.getSizePercentLimit("_tileMinHeight"))}},{key:"getTileMaxPercentHeight",value:function(){return Math.max(5,this.getSizePercentLimit("_tileMaxHeight"))}},{key:"getMaxPercentWidth",value:function(){return Math.max(5,this.getSizePercentLimit("_maxWidth"))}},{key:"getMaxPercentHeight",value:function(){return Math.max(5,this.getSizePercentLimit("_maxHeight"))}},{key:"getCursorFromHtmlElement",value:function(e,t,i){var n=this.getTileElementFromHTMLElement(i);if(!n)return null;var r=n.getBoundingClientRect();return e<r.left+15?t<r.top+15?"nw-resize":t>r.bottom-15?"sw-resize":"w-resize":e>r.right-15?t<r.top+15?"ne-resize":t>r.bottom-15?"se-resize":"e-resize":t<r.top+15?"n-resize":t>r.bottom-15?"s-resize":"move"}},{key:"extractValueAndUnit",value:function(e,t){var i=/(\d+)(.*)/i.exec(t);if((null==i?void 0:i.length)>=1){this[e]=parseInt(i[1],10),this["".concat(e,"Unit")]=i.length>=2?i[2]:"px"}}},{key:"restoreLayout",value:function(e){this.tiles.forEach(function(t){var i=e[t.id];i&&(t.percentBounds=i.bounds.clone())})}},{key:"calcHorizontalOverflow",value:function(e,t,i,n){var r=this,o=0;return n=n||new Set,t.forEach(function(t){if(!n.has(t.id)){n.add(t.id);var s=t.percentBounds.offset(e*i,0),a=0,l=r.getMaxPercentWidth();s.left<0?a=-s.left:l&&s.right>l&&(a=s.right-l);var c=r.tiles.filter(function(e){return!e.isDragging&&!e.equalsTo(t)&&e.percentBounds.intersectWith(s)});c.length&&(a+=r.calcHorizontalOverflow(e,c,i,n)),a>o&&(o=a)}}),o}},{key:"moveHorizontal",value:function(e,t,i,n){var r=this;t.forEach(function(t){if(!n.has(t.id)){var o=t.percentBounds.offset(e*i,0);n.set(t.id,o);var s=r.tiles.filter(function(e){return!e.isDragging&&!e.equalsTo(t)&&e.percentBounds.intersectWith(o)});s.length&&r.moveHorizontal(e,s,i,n)}})}},{key:"pushHorizontal",value:function(e,t,i,n){var r=0,o=new Map;return n||(n=0,i.forEach(function(i){var r=t>0?Math.max(0,e.right-i.percentBounds.left):Math.max(0,i.percentBounds.right-e.left);r>n&&(n=r)})),n>0&&(r=this.calcHorizontalOverflow(t,i,n),(n-=r)>0&&(this.moveHorizontal(t,i,n,o),this.tiles.forEach(function(e){o.has(e.id)&&(e.percentBounds=o.get(e.id))}))),r}},{key:"calcVerticalOverflow",value:function(e,t,i,n){var r=this,o=0;return n=n||new Set,t.forEach(function(t){if(!n.has(t.id)){n.add(t.id);var s=t.percentBounds.offset(0,e*i),a=0,l=r.getMaxPercentHeight();s.top<0?a=-s.top:l&&s.bottom>l&&(a=s.bottom-l);var c=r.tiles.filter(function(e){return!e.isDragging&&!e.equalsTo(t)&&e.percentBounds.intersectWith(s)});c.length&&(a+=r.calcVerticalOverflow(e,c,i,n)),a>o&&(o=a)}}),o}},{key:"moveVertical",value:function(e,t,i,n){var r=this;t.forEach(function(t){if(!n.has(t.id)){var o=t.percentBounds.offset(0,e*i);n.set(t.id,o);var s=r.tiles.filter(function(e){return!e.isDragging&&!e.equalsTo(t)&&e.percentBounds.intersectWith(o)});s.length&&r.moveVertical(e,s,i,n)}})}},{key:"pushVertical",value:function(e,t,i,n){var r=0,o=new Map;return n||(n=0,i.forEach(function(i){var r=t>0?Math.max(0,e.bottom-i.percentBounds.top):Math.max(0,i.percentBounds.bottom-e.top);r>n&&(n=r)})),n>0&&(r=this.calcVerticalOverflow(t,i,n),(n-=r)>0&&(this.moveVertical(t,i,n,o),this.tiles.forEach(function(e){return o.has(e.id)&&(e.percentBounds=o.get(e.id))}))),r}},{key:"copyTiles",value:function(e,t){if(!this.clipboardService){if(!e)return;throw new Error("DejaClipboardService must be imported by your application to use the copyTiles methode of DejaTilesComponent.")}var i=this.clipboardService.get("tiles");i&&i.forEach(function(e){return e.isCutted=!1}),this.clipboardService.set("tiles",e),t?(e.forEach(function(e){return e.isCutted=!0}),this.clipboardService.set("tiles-provider",this.deleteTiles$)):this.clipboardService.set("tiles-provider",void 0)}},{key:"removeTemporaryTile",value:function(){for(var e=this.tiles.length;--e>=0;){var t=this.tiles[e];t.isTemporary&&(this.tilesDic.delete(t.id),this.tiles.splice(e,1))}}}]),i}(R.yl);return e.\u0275fac=function(t){return new(t||e)(x.LFG(R.ST,8))},e.\u0275prov=x.Yz7({token:e,factory:e.\u0275fac}),e}(),se=function(){var e=function(e){o(n,e);var t=a(n);function n(e,i,r,o){var s;d(this,n),(s=t.call(this)).changeDetectorRef=i,s.layoutProvider=r,s.control=o,s.selectionChanged=new x.vpe,s.layoutChanged=new x.vpe,s.layoutCompleted=new x.vpe,s.contentAdding=new x.vpe,s.contentRemoving=new x.vpe,s.tilesAdded=new x.vpe,s.tilesDeleted=new x.vpe,s.contentCopied=new x.vpe,s.tabIndex=0,s._models=[],s.hasFocus=!1,s.onTouchedCallback=function(){},s.onChangeCallback=function(e){},s.control&&(s.control.valueAccessor=c(s));var a=e.nativeElement;return(0,Q.D)(s.layoutProvider.selectionChanged).pipe((0,z.R)(s.destroyed$)).subscribe(function(e){return s.selectionChanged.emit(e)}),(0,Q.D)(s.layoutProvider.contentAdding).pipe((0,z.R)(s.destroyed$)).subscribe(function(e){return s.contentAdding.emit(e)}),(0,Q.D)(s.layoutProvider.contentRemoving).pipe((0,z.R)(s.destroyed$)).subscribe(function(e){return s.contentRemoving.emit(e)}),(0,Q.D)(s.layoutProvider.tilesAdded).pipe((0,z.R)(s.destroyed$)).subscribe(function(e){s.tilesAdded.emit(e),s.onChangeCallback(e.tiles)}),(0,Q.D)(s.layoutProvider.tilesDeleted).pipe((0,z.R)(s.destroyed$)).subscribe(function(e){s.tilesDeleted.emit(e),s.onChangeCallback(e.tiles)}),(0,Q.D)(s.layoutProvider.layoutChanged).pipe((0,z.R)(s.destroyed$)).subscribe(function(e){s.layoutChanged.emit(e),s.onChangeCallback(e.tiles)}),(0,Q.D)(s.layoutProvider.layoutCompleted).pipe((0,z.R)(s.destroyed$)).subscribe(function(e){return s.layoutCompleted.emit(e)}),s.keyup$=(0,q.R)(a.ownerDocument,"keyup"),(0,q.R)(window,"resize").pipe((0,O.b)(5),(0,z.R)(s.destroyed$)).subscribe(function(){return s.refresh({resetWidth:!0})}),s}return r(n,[{key:"tiles",get:function(){return this.layoutProvider.tiles}},{key:"selectionRect$",get:function(){return this.layoutProvider.selectionRect$}},{key:"tileminwidth",set:function(e){this.layoutProvider.tileMinWidth=e}},{key:"tilemaxwidth",set:function(e){this.layoutProvider.tileMaxWidth=e}},{key:"tileminheight",set:function(e){this.layoutProvider.tileMinHeight=e}},{key:"tilemaxheight",set:function(e){this.layoutProvider.tileMaxHeight=e}},{key:"maxwidth",set:function(e){this.layoutProvider.maxWidth=e}},{key:"designMode",get:function(){return this.layoutProvider.designMode},set:function(e){this.layoutProvider.designMode=(0,w.Ig)(e)}},{key:"models",set:function(e){this.writeValue(e)}},{key:"canDelete",set:function(e){var t=this;(0,w.Ig)(e)&&!this.delete$sub?this.delete$sub=this.keyup$.pipe((0,S.h)(function(e){return t.layoutProvider.designMode&&e.code===R.mW.Delete&&t.hasFocus}),(0,z.R)(this.destroyed$)).subscribe(function(){return t.layoutProvider.deleteSelection()}):this.delete$sub&&(this.delete$sub.unsubscribe(),this.delete$sub=void 0)}},{key:"canCopy",set:function(e){var t=this;(0,w.Ig)(e)&&!this.copy$sub?this.copy$sub=this.keyup$.pipe((0,S.h)(function(e){return e.code===R.mW.KeyC&&e.ctrlKey&&t.hasFocus}),(0,z.R)(this.destroyed$)).subscribe(function(){return t.copySelection()}):this.copy$sub&&(this.copy$sub.unsubscribe(),this.copy$sub=void 0)}},{key:"canCut",set:function(e){var t=this;(0,w.Ig)(e)&&!this.cut$sub?this.cut$sub=this.keyup$.pipe((0,S.h)(function(e){return t.layoutProvider.designMode&&e.code===R.mW.KeyX&&e.ctrlKey&&t.hasFocus}),(0,z.R)(this.destroyed$)).subscribe(function(){return t.cutSelection()}):this.cut$sub&&(this.cut$sub.unsubscribe(),this.cut$sub=void 0)}},{key:"canPaste",set:function(e){var t=this;(0,w.Ig)(e)&&!this.paste$sub?this.paste$sub=this.keyup$.pipe((0,S.h)(function(e){return t.layoutProvider.designMode&&e.code===R.mW.KeyV&&e.ctrlKey&&t.hasFocus}),(0,z.R)(this.destroyed$)).subscribe(function(){return t.paste()}):this.paste$sub&&(this.paste$sub.unsubscribe(),this.paste$sub=void 0)}},{key:"selectedTiles",set:function(e){this.layoutProvider.selectedTiles=e.map(function(e){return"string"==typeof e?e:e.id})}},{key:"writeValue",value:function(e){this._models=e||[],this.layoutProvider.tiles=this._models,this.changeDetectorRef.markForCheck()}},{key:"registerOnChange",value:function(e){this.onChangeCallback=e}},{key:"registerOnTouched",value:function(e){this.onTouchedCallback=e}},{key:"ngAfterViewInit",value:function(){this.layoutProvider.container=this.tilesContainer.nativeElement,this.refresh({resetWidth:!0})}},{key:"ngOnDestroy",value:function(){i(u(n.prototype),"ngOnDestroy",this).call(this),this.canCopy=!1,this.canCut=!1,this.canDelete=!1,this.canPaste=!1}},{key:"copySelection",value:function(){var e=this.layoutProvider.copySelection();if(null==e?void 0:e.length){var t=new CustomEvent("DejaTilesCopied",{cancelable:!0});t.tiles=e,this.contentCopied.emit(t)}}},{key:"cutSelection",value:function(){var e=this.layoutProvider.cutSelection();if(null==e?void 0:e.length){var t=new CustomEvent("DejaTilesCutted",{cancelable:!0});t.tiles=e,this.contentCopied.emit(t)}}},{key:"deleteSelection",value:function(){var e=this.layoutProvider.deleteSelection();return this.changeDetectorRef.markForCheck(),e}},{key:"paste",value:function(){var e=this.layoutProvider.paste();return this.changeDetectorRef.markForCheck(),e}},{key:"ensureVisible",value:function(e){this.layoutProvider.ensureVisible$.next(e)}},{key:"refresh",value:function(e){this.layoutProvider.refreshTiles$.next(e)}},{key:"addTiles",value:function(e){this.layoutProvider.addTiles(e)}},{key:"removeTiles",value:function(e){this.layoutProvider.removeTiles(e)}},{key:"hitTest",value:function(e,t){var i=this.tilesContainer.nativeElement.getBoundingClientRect(),n=e-i.left,r=t-i.top;return this.tiles.find(function(e){var t;return null===(t=e.pixelBounds)||void 0===t?void 0:t.containsPoint(new R.Ly(n,r))})}},{key:"getFreePlace",value:function(e,t,i,n){if(!this._models||0===this._models.length)return new R.UL(0,0,i,n);var r=this.tilesContainer.nativeElement.getBoundingClientRect(),o=t?t-r.top:0,s=new R.UL(this.layoutProvider.getPercentSize(e?e-r.left:0),this.layoutProvider.getPercentSize(o),i,n);return this.layoutProvider.getFreePlace(s)}},{key:"moveTile",value:function(e,t){this.layoutProvider.moveTile(e,t)}},{key:"getDropContext",value:function(){var e,t=this;return{dragEnter:function(i,n){return e=t.layoutProvider.dragEnter(i,n)?{className:"hidden"}:null},dragOver:function(i,n){return t.layoutProvider.dragover$.next(n),e},dragLeave:function(i){e=null,t.layoutProvider.dragleave$.next()}}}},{key:"onTileClosed",value:function(e){this.layoutProvider.removeTiles([e.id])}},{key:"onFocus",value:function(){this.hasFocus=!0}},{key:"onBlur",value:function(){this.hasFocus=!1}}]),n}(R.yl);return e.\u0275fac=function(t){return new(t||e)(x.Y36(x.SBq),x.Y36(x.sBO),x.Y36(oe),x.Y36(h.a5,10))},e.\u0275cmp=x.Xpm({type:e,selectors:[["deja-tiles"]],contentQueries:function(e,t,i){var n;(1&e&&x.Suo(i,ee,5),2&e)&&(x.iGM(n=x.CRH())&&(t.tileTemplate=n.first))},viewQuery:function(e,t){var i;(1&e&&x.Gf(te,7),2&e)&&(x.iGM(i=x.CRH())&&(t.tilesContainer=i.first))},inputs:{tabIndex:"tabIndex",tileminwidth:"tileminwidth",tilemaxwidth:"tilemaxwidth",tileminheight:"tileminheight",tilemaxheight:"tilemaxheight",maxwidth:"maxwidth",designMode:"designMode",models:"models",canDelete:"canDelete",canCopy:"canCopy",canCut:"canCut",canPaste:"canPaste",selectedTiles:"selectedTiles"},outputs:{selectionChanged:"selectionChanged",layoutChanged:"layoutChanged",layoutCompleted:"layoutCompleted",contentAdding:"contentAdding",contentRemoving:"contentRemoving",tilesAdded:"tilesAdded",tilesDeleted:"tilesDeleted",contentCopied:"contentCopied"},features:[x._Bn([oe]),x.qOj],decls:5,vars:8,consts:[["id","tiles",3,"mouse-droppable","focus","blur"],["tilesContainer",""],[3,"id","tile","template","close",4,"ngFor","ngForOf"],["deja-tile-position","",3,"bounds"],[3,"id","tile","template","close"]],template:function(e,t){1&e&&(x.TgZ(0,"div",0,1),x.NdJ("focus",function(){return t.onFocus()})("blur",function(){return t.onBlur()}),x.YNc(2,ie,1,4,"deja-tile",2),x._UZ(3,"div",3),x.ALo(4,"async"),x.qZA()),2&e&&(x.ekj("design",t.designMode),x.Q6J("mouse-droppable",t.getDropContext()),x.uIk("tabindex",t.tabIndex),x.xp6(2),x.Q6J("ngForOf",t.tiles),x.xp6(1),x.Q6J("bounds",x.lcZ(4,6,t.selectionRect$)))},directives:[A.dY,l.sg,re,ne],pipes:[l.Ov],styles:["[_nghost-%COMP%]{position:relative;overflow:auto;margin:0!important}[_nghost-%COMP%]   #tiles[_ngcontent-%COMP%]{display:block;left:0;top:0;min-width:100%;min-height:100%;position:absolute;padding:0!important;margin:0!important}[_nghost-%COMP%]   #tiles.design[_ngcontent-%COMP%]   deja-tile[_ngcontent-%COMP%]{background-color:rgba(0,0,0,.1)}[_nghost-%COMP%]   #tiles[_ngcontent-%COMP%]   #tile[_ngcontent-%COMP%]:hover{z-index:200}[_nghost-%COMP%]   [deja-tile-position][_ngcontent-%COMP%]{position:absolute;z-index:101;background-color:rgba(0,0,0,.5)}[drag][_nghost-%COMP%]{background-color:rgba(0,0,0,.5)}[drag][_nghost-%COMP%]   [deja-tile-position][_ngcontent-%COMP%]{transition-property:left,top,width,height;transition-duration:.35s;transition-timing-function:ease}"],changeDetection:0}),e}(),ae=function(){var e=function(){function e(t){d(this,e),this.cutted$=new I.X(!1),this.dragging$=new I.X(!1),this.dropping$=new I.X(!1),this.pressed$=new I.X(!1),this.selected$=new I.X(!1),this.hidden$=new X.t(1),this.pixelBounds$=new I.X(null),this.deleted$=new H.xQ,this.refresh$=new H.xQ,this.isTemporary=!1,this._isDragging=!1,this._isDropping=!1,this._isPressed=!1,this._isHidden=!1,this._id=t||"#"+e.CURRENT_ID++}return r(e,[{key:"idealBounds",get:function(){return new R.UL(0,0,15,15)}},{key:"pixelBounds",get:function(){return this._pixelBounds},set:function(e){R.UL.equals(this._pixelBounds,e)||(this._pixelBounds=e,this.pixelBounds$.next(e))}},{key:"percentBounds",get:function(){return this._percentBounds},set:function(e){this._percentBounds=e}},{key:"templateModel",get:function(){return this._templateModel},set:function(e){this._templateModel=e}},{key:"id",get:function(){return this._id}},{key:"isCutted",get:function(){return this._cutted},set:function(e){this._cutted!==e&&(this._cutted=e,this.cutted$.next(e))}},{key:"color",get:function(){return this._color},set:function(e){this._color=e}},{key:"isDragging",get:function(){return this._isDragging},set:function(e){this._isDragging!==e&&(this._isDragging=e,this.dragging$.next(e))}},{key:"isDropping",get:function(){return this._isDropping},set:function(e){this._isDropping!==e&&(this._isDropping=e,this.dropping$.next(e))}},{key:"isPressed",get:function(){return this._isPressed},set:function(e){this._isPressed!==e&&(this._isPressed=e,this.pressed$.next(e))}},{key:"isSelected",get:function(){return this._selected},set:function(e){this._selected!==e&&(this._selected=e,this.selected$.next(e))}},{key:"isHidden",get:function(){return this._isHidden},set:function(e){this._isHidden!==e&&(this._isHidden=e,this.hidden$.next(e))}},{key:"isPending",get:function(){return this._pending},set:function(e){this._pending=e}},{key:"fading",get:function(){return this._fading},set:function(e){this._fading=e}},{key:"makeId",value:function(){this._id="#"+e.CURRENT_ID++}},{key:"equalsTo",value:function(e){return this._templateModel?this._templateModel===e._templateModel:this._id===e._id}},{key:"clone",value:function(t){return t||(t=new e(this.id)),t._percentBounds=this.percentBounds,t._color=this.color,t._templateModel=this.templateModel,t._cutted=this._cutted,t._selected=this._selected,t._pending=this._pending,t._fading=this._fading,t}},{key:"delete",value:function(){this.deleted$.next()}},{key:"refresh",value:function(){this.refresh$.next()}}]),e}();return e.CURRENT_ID=0,e}(),le=function(){var e=function e(){d(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=x.oAB({type:e}),e.\u0275inj=x.cJS({imports:[[l.ez,h.u5,A.$Q,D]]}),e}(),ce=s(7631),ue=s(71398),de=s(2023),he=s(7768),fe=s(32254),ge=s(50246);function pe(e,t){1&e&&(x.TgZ(0,"mat-card",5),x._UZ(1,"deja-markdown",6),x.qZA()),2&e&&(x.xp6(1),x.Q6J("url","https://raw.githubusercontent.com/DSI-HUG/dejajs-components/develop/projects/deja-js/component/tiles/readme.txt"))}function me(e,t){if(1&e){var i=x.EpF();x.TgZ(0,"button",11),x.NdJ("click",function(){return x.CHM(i),x.oxw(2).$implicit.cancel(!1)}),x._uU(1," Ok "),x.qZA(),x.TgZ(2,"button",12),x.NdJ("click",function(){return x.CHM(i),x.oxw(2).$implicit.cancel(!0)}),x._uU(3," Annuler "),x.qZA()}}function ve(e,t){if(1&e){var i=x.EpF();x.TgZ(0,"deja-snackbar",8),x.NdJ("onAnimationDone",function(){return x.CHM(i),x.oxw().$implicit.cancel(!1)}),x.TgZ(1,"deja-message-box",9),x._uU(2),x.YNc(3,me,4,0,"ng-template",null,10,x.W1O),x.qZA(),x.qZA()}if(2&e){var n=x.oxw().$implicit;x.Q6J("duration",8e3),x.xp6(1),x.Q6J("type",n.type)("title",n.title),x.xp6(1),x.hij(" ",n.content," ")}}function ye(e,t){1&e&&x.YNc(0,ve,5,4,"deja-snackbar",7),2&e&&x.Q6J("ngIf",t.$implicit.gate)}function be(e,t){if(1&e&&(x.TgZ(0,"div",23),x._uU(1),x.TgZ(2,"span",24),x._uU(3,"Selected"),x.qZA(),x.TgZ(4,"span",25),x._uU(5,"Pressed"),x.qZA(),x.qZA()),2&e){var i=t.$implicit;x.Udp("background-color",i.color),x.xp6(1),x.AsE("",i.templateModel.naqme," (",i.templateModel.code,") ")}}function xe(e,t){if(1&e&&(x.TgZ(0,"div",23),x._uU(1),x.TgZ(2,"span",24),x._uU(3,"Selected"),x.qZA(),x.TgZ(4,"span",25),x._uU(5,"Pressed"),x.qZA(),x.qZA()),2&e){var i=t.$implicit;x.Udp("background-color",i.color),x.xp6(1),x.AsE("",i.templateModel.naqme," (",i.templateModel.code,") ")}}function ke(e,t){if(1&e){var i=x.EpF();x.TgZ(0,"mat-card",5),x.TgZ(1,"mat-toolbar",13),x._uU(2,"Tiles Demo"),x.qZA(),x.TgZ(3,"mat-card-content",14),x.TgZ(4,"mat-checkbox",15),x.NdJ("ngModelChange",function(e){return x.CHM(i),x.oxw().designMode=e}),x._uU(5,"Design Mode"),x.qZA(),x.qZA(),x.TgZ(6,"mat-card-content"),x.TgZ(7,"span",16,17),x._uU(9," Drop Area "),x.qZA(),x.qZA(),x.TgZ(10,"mat-card-content"),x.TgZ(11,"deja-tiles",18,19),x.NdJ("contentAdding",function(e){return x.CHM(i),x.oxw().onContentAdding(e)})("contentRemoving",function(e){return x.CHM(i),x.oxw().onContentRemoving(e)}),x.ALo(13,"async"),x.YNc(14,be,6,4,"ng-template",null,20,x.W1O),x.qZA(),x.qZA(),x.TgZ(16,"mat-card-content"),x.TgZ(17,"deja-tiles",21,22),x.NdJ("contentAdding",function(e){return x.CHM(i),x.oxw().onContentAdding(e)})("contentRemoving",function(e){return x.CHM(i),x.oxw().onContentRemoving(e)}),x.ALo(19,"async"),x.YNc(20,xe,6,4,"ng-template",null,20,x.W1O),x.qZA(),x.qZA(),x.qZA()}if(2&e){var n=x.MAs(8),r=x.oxw();x.xp6(4),x.Q6J("ngModel",r.designMode),x.xp6(3),x.Q6J("mouse-droppable",r.getDropContext(n)),x.xp6(4),x.Q6J("models",x.lcZ(13,6,r.tiles1$))("mouse-draggable",r.getDragContext()),x.xp6(6),x.Q6J("models",x.lcZ(19,8,r.tiles2$))("designMode",r.designMode)}}var we,Me,_e=ue.Bz.forChild([{path:"",component:(we=function(){function t(i){d(this,t),this.countriesService=i,this.tabIndex=1,this.designMode=!1,this.message$=new H.xQ,this.messages$=this.message$.pipe((0,de.R)(function(t,i){return[].concat(e(t),[i])},[]),(0,he.d)([]))}return r(t,[{key:"ngOnInit",value:function(){var t=this,i=0,n=0,r=0,o=0;this.countriesMap=new Map;var s=this.countriesService.getCountries$().pipe((0,W.w)(function(e){return e}));this.tiles1$=s.pipe((0,L.q)(12),(0,j.U)(function(e){var r=new ae;return r.percentBounds=new R.UL(i,n,15,15),r.color=e.color,r.templateModel=e,(i+=15)+15>100&&(i=0,n+=15),t.countriesMap.set(r.id,e),r}),(0,N.u)(function(t,i){return[].concat(e(t),[i])},[])),this.tiles2$=s.pipe((0,j.U)(function(e){var t=new ae;return t.percentBounds=new R.UL(r,o,15,15),t.color=e.color,t.templateModel=e,(r+=15)+15>100&&(r=0,o+=15),t}),(0,N.u)(function(t,i){return[].concat(e(t),[i])},[]))}},{key:"getDragContext",value:function(){var e=this;return{target:"deja-tile",className:"deja-tile-cursor",dragStart:function(t){var i=e.countriesMap.get(t.id),n=new ae;return n.percentBounds=new R.UL(0,0,15,15),n.color=i.color,n.templateModel=i,{country:i,tile:n}}}}},{key:"getDropContext",value:function(e){return{dragEnter:function(e){return{width:200,height:60,className:"country-target-cursor"}},drop:function(t){var i=t.country;e.innerText="The dropped country is ".concat(i.naqme," - the code is: ").concat(i.code)}}}},{key:"onContentAdding",value:function(e){this.message$.next({title:"Tiles added",content:"".concat(e.added.length," tiles added."),type:"warn",gate:!0,cancel:function(t){this.gate=!1,e.cancel$.next(t)}}),e.preventDefault()}},{key:"onContentRemoving",value:function(e){this.message$.next({title:"Tiles deleted",content:"".concat(e.removed.length," tiles deleted."),type:"warn",gate:!0,cancel:function(t){this.gate=!1,e.cancel$.next(t)}}),e.preventDefault()}}]),t}(),we.\u0275fac=function(e){return new(e||we)(x.Y36(fe.K))},we.\u0275cmp=x.Xpm({type:we,selectors:[["deja-tiles-demo"]],decls:8,vars:6,consts:[[3,"selectedIndex","selectedTabChange"],["label","API REFERENCE"],["label","EXAMPLES"],["class","demo-card demo-basic",4,"ngIf"],["ngFor","",3,"ngForOf"],[1,"demo-card","demo-basic"],[3,"url"],["alignment","bottom right",3,"duration","onAnimationDone",4,"ngIf"],["alignment","bottom right",3,"duration","onAnimationDone"],[3,"type","title"],["actionsTemplate",""],["mat-raised-button","","color","primary",3,"click"],["mat-raised-button","",3,"click"],["color","primary"],["id","actions"],[3,"ngModel","ngModelChange"],["id","droparea",3,"mouse-droppable"],["dropArea",""],["id","tiles1","maxwidth","100%","tileminwidth","5%","tileminheight","5%","tilemaxheight","50%","tilemaxwidth","50%",3,"models","mouse-draggable","contentAdding","contentRemoving"],["tiles1",""],["tileTemplate",""],["id","tiles2","canDelete","","canCopy","","canCut","","canPaste","","maxwidth","100%","tileminwidth","5%","tileminheight","5%","tilemaxheight","50%","tilemaxwidth","50%",3,"models","designMode","contentAdding","contentRemoving"],["tiles2",""],[1,"tile-content","noselect"],["id","selected"],["id","pressed"]],template:function(e,t){1&e&&(x.TgZ(0,"mat-tab-group",0),x.NdJ("selectedTabChange",function(e){return t.tabIndex=e.index}),x._UZ(1,"mat-tab",1),x._UZ(2,"mat-tab",2),x.qZA(),x.YNc(3,pe,2,1,"mat-card",3),x.YNc(4,ye,1,1,"ng-template",4),x.ALo(5,"async"),x.YNc(6,ke,22,10,"mat-card",3),x._UZ(7,"mouse-dragdrop-cursor")),2&e&&(x.Q6J("selectedIndex",t.tabIndex),x.xp6(3),x.Q6J("ngIf",0===t.tabIndex),x.xp6(1),x.Q6J("ngForOf",x.lcZ(5,4,t.messages$)),x.xp6(2),x.Q6J("ngIf",1===t.tabIndex))},directives:[m.SP,m.uX,l.O5,l.sg,A.Sx,g.a8,ge.F,b.w,y.b,f.lW,v.Ye,g.dn,p.oG,h.JJ,h.On,A.dY,se,A.lq],pipes:[l.Ov],styles:["deja-tiles-demo .demo-basic{padding:0}deja-tiles-demo .demo-full-width{width:100%}deja-tiles-demo .demo-icons{font-size:100%;height:inherit;vertical-align:top;width:inherit}deja-tiles-demo .demo-card{margin:16px}deja-tiles-demo .demo-card mat-card-content{display:flex;flex-direction:column;margin:2rem}deja-tiles-demo #actions{display:flex;flex-direction:row;align-items:center;justify-content:space-between}deja-tiles-demo #droparea{height:5rem;background-color:#f57c00;width:50%;display:block}deja-tiles-demo #tiles1{height:370px;display:block}deja-tiles-demo #tiles2{height:1000px;display:block}deja-tiles-demo deja-tile{-webkit-user-select:none;-moz-user-select:none;user-select:none}deja-tiles-demo deja-tile #pressed,deja-tiles-demo deja-tile #selected{display:none}deja-tiles-demo deja-tile[pressed] #pressed,deja-tiles-demo deja-tile[selected] #selected{display:block}deja-tiles-demo deja-tile .tile-content{width:100%;height:100%;display:block}@media screen and (min-width:1401px){deja-tiles-demo deja-tiles{font-size:100%}}@media screen and (max-width:1400px){deja-tiles-demo deja-tiles{font-size:90%}}@media screen and (max-width:1200px){deja-tiles-demo deja-tiles{font-size:85%}}@media screen and (max-width:768px){deja-tiles-demo deja-tiles{font-size:80%}}@media screen and (max-width:640px){deja-tiles-demo deja-tiles{font-size:70%}}@media screen and (max-width:320px){deja-tiles-demo deja-tiles{font-size:60%}}.country-target-cursor .tile-content,.deja-tile-cursor .tile-content{width:100%;height:100%;display:block;opacity:.8}.country-target-cursor .tile-content{background-color:#f4a460!important}"],encapsulation:2}),we)},{path:"**",redirectTo:"",pathMatch:"full"}]),Te=((Me=function e(){d(this,e)}).\u0275fac=function(e){return new(e||Me)},Me.\u0275mod=x.oAB({type:Me}),Me.\u0275inj=x.cJS({providers:[],imports:[[l.ez,h.u5,g.QW,m.Nh,v.g0,f.ot,p.p9,le,ce.O,b.n,A.$Q,y.J,_e]]}),Me)}}])}();