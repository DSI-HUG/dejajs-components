!function(){function e(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,n){if(!e)return;if("string"==typeof e)return t(e,n);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return t(e,n)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function n(e,t,i){return(n="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=d(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,i||e)}function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function r(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=d(e);if(t){var r=d(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return c(this,n)}}function c(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?l(e):t}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{"ToA/":function(t,i,a){"use strict";a.r(i),a.d(i,"DejaTilesDemoModule",(function(){return Pe}));var c=a("SVse"),h=a("s7LF"),p=a("Dxy4"),f=a("PDjf"),g=a("pMoy"),m=a("M9ds"),v=a("l0rg"),b=a("650w"),y=a("PO1J"),x=a("KUKF"),k=a("8Y7J"),w=a("UhP/"),j=a("8LU1"),M=a("SCoL"),O=a("omvX");function _(e,t){if(1&e&&(k["\u0275\u0275namespaceSVG"](),k["\u0275\u0275element"](0,"circle",3)),2&e){var n=k["\u0275\u0275nextContext"]();k["\u0275\u0275styleProp"]("animation-name","mat-progress-spinner-stroke-rotate-"+n._spinnerAnimationLabel)("stroke-dashoffset",n._getStrokeDashOffset(),"px")("stroke-dasharray",n._getStrokeCircumference(),"px")("stroke-width",n._getCircleStrokeWidth(),"%"),k["\u0275\u0275attribute"]("r",n._getCircleRadius())}}function P(e,t){if(1&e&&(k["\u0275\u0275namespaceSVG"](),k["\u0275\u0275element"](0,"circle",3)),2&e){var n=k["\u0275\u0275nextContext"]();k["\u0275\u0275styleProp"]("stroke-dashoffset",n._getStrokeDashOffset(),"px")("stroke-dasharray",n._getStrokeCircumference(),"px")("stroke-width",n._getCircleStrokeWidth(),"%"),k["\u0275\u0275attribute"]("r",n._getCircleRadius())}}var C,T,E=Object(w.u)((function e(t){u(this,e),this._elementRef=t}),"primary"),B=new k.InjectionToken("mat-progress-spinner-default-options",{providedIn:"root",factory:function(){return{diameter:100}}}),S=((T=function(e){o(n,e);var t=s(n);function n(e,i,r,o,a){var s;u(this,n),(s=t.call(this,e))._elementRef=e,s._document=r,s._diameter=100,s._value=0,s._fallbackAnimation=!1,s.mode="determinate";var c=n._diameters;return s._spinnerAnimationLabel=s._getSpinnerAnimationLabel(),c.has(r.head)||c.set(r.head,new Set([100])),s._fallbackAnimation=i.EDGE||i.TRIDENT,s._noopAnimations="NoopAnimations"===o&&!!a&&!a._forceAnimations,a&&(a.diameter&&(s.diameter=a.diameter),a.strokeWidth&&(s.strokeWidth=a.strokeWidth)),s}return r(n,[{key:"ngOnInit",value:function(){var e=this._elementRef.nativeElement;this._styleRoot=Object(M.c)(e)||this._document.head,this._attachStyleNode(),e.classList.add("mat-progress-spinner-indeterminate".concat(this._fallbackAnimation?"-fallback":"","-animation"))}},{key:"_getCircleRadius",value:function(){return(this.diameter-10)/2}},{key:"_getViewBox",value:function(){var e=2*this._getCircleRadius()+this.strokeWidth;return"0 0 ".concat(e," ").concat(e)}},{key:"_getStrokeCircumference",value:function(){return 2*Math.PI*this._getCircleRadius()}},{key:"_getStrokeDashOffset",value:function(){return"determinate"===this.mode?this._getStrokeCircumference()*(100-this._value)/100:this._fallbackAnimation&&"indeterminate"===this.mode?.2*this._getStrokeCircumference():null}},{key:"_getCircleStrokeWidth",value:function(){return this.strokeWidth/this.diameter*100}},{key:"_attachStyleNode",value:function(){var e=this._styleRoot,t=this._diameter,i=n._diameters,r=i.get(e);if(!r||!r.has(t)){var o=this._document.createElement("style");o.setAttribute("mat-spinner-animation",this._spinnerAnimationLabel),o.textContent=this._getAnimationText(),e.appendChild(o),r||(r=new Set,i.set(e,r)),r.add(t)}}},{key:"_getAnimationText",value:function(){var e=this._getStrokeCircumference();return"\n @keyframes mat-progress-spinner-stroke-rotate-DIAMETER {\n    0%      { stroke-dashoffset: START_VALUE;  transform: rotate(0); }\n    12.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(0); }\n    12.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(72.5deg); }\n    25%     { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(72.5deg); }\n\n    25.0001%   { stroke-dashoffset: START_VALUE;  transform: rotate(270deg); }\n    37.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(270deg); }\n    37.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(161.5deg); }\n    50%     { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(161.5deg); }\n\n    50.0001%  { stroke-dashoffset: START_VALUE;  transform: rotate(180deg); }\n    62.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(180deg); }\n    62.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(251.5deg); }\n    75%     { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(251.5deg); }\n\n    75.0001%  { stroke-dashoffset: START_VALUE;  transform: rotate(90deg); }\n    87.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(90deg); }\n    87.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(341.5deg); }\n    100%    { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(341.5deg); }\n  }\n".replace(/START_VALUE/g,""+.95*e).replace(/END_VALUE/g,""+.2*e).replace(/DIAMETER/g,"".concat(this._spinnerAnimationLabel))}},{key:"_getSpinnerAnimationLabel",value:function(){return this.diameter.toString().replace(".","_")}},{key:"diameter",get:function(){return this._diameter},set:function(e){this._diameter=Object(j.e)(e),this._spinnerAnimationLabel=this._getSpinnerAnimationLabel(),!this._fallbackAnimation&&this._styleRoot&&this._attachStyleNode()}},{key:"strokeWidth",get:function(){return this._strokeWidth||this.diameter/10},set:function(e){this._strokeWidth=Object(j.e)(e)}},{key:"value",get:function(){return"determinate"===this.mode?this._value:0},set:function(e){this._value=Math.max(0,Math.min(100,Object(j.e)(e)))}}]),n}(E)).\u0275fac=function(e){return new(e||T)(k["\u0275\u0275directiveInject"](k.ElementRef),k["\u0275\u0275directiveInject"](M.a),k["\u0275\u0275directiveInject"](c.d,8),k["\u0275\u0275directiveInject"](O.a,8),k["\u0275\u0275directiveInject"](B))},T.\u0275cmp=k["\u0275\u0275defineComponent"]({type:T,selectors:[["mat-progress-spinner"]],hostAttrs:["role","progressbar",1,"mat-progress-spinner"],hostVars:10,hostBindings:function(e,t){2&e&&(k["\u0275\u0275attribute"]("aria-valuemin","determinate"===t.mode?0:null)("aria-valuemax","determinate"===t.mode?100:null)("aria-valuenow","determinate"===t.mode?t.value:null)("mode",t.mode),k["\u0275\u0275styleProp"]("width",t.diameter,"px")("height",t.diameter,"px"),k["\u0275\u0275classProp"]("_mat-animation-noopable",t._noopAnimations))},inputs:{color:"color",mode:"mode",diameter:"diameter",strokeWidth:"strokeWidth",value:"value"},exportAs:["matProgressSpinner"],features:[k["\u0275\u0275InheritDefinitionFeature"]],decls:3,vars:8,consts:[["preserveAspectRatio","xMidYMid meet","focusable","false",3,"ngSwitch"],["cx","50%","cy","50%",3,"animation-name","stroke-dashoffset","stroke-dasharray","stroke-width",4,"ngSwitchCase"],["cx","50%","cy","50%",3,"stroke-dashoffset","stroke-dasharray","stroke-width",4,"ngSwitchCase"],["cx","50%","cy","50%"]],template:function(e,t){1&e&&(k["\u0275\u0275namespaceSVG"](),k["\u0275\u0275elementStart"](0,"svg",0),k["\u0275\u0275template"](1,_,1,9,"circle",1),k["\u0275\u0275template"](2,P,1,7,"circle",2),k["\u0275\u0275elementEnd"]()),2&e&&(k["\u0275\u0275styleProp"]("width",t.diameter,"px")("height",t.diameter,"px"),k["\u0275\u0275property"]("ngSwitch","indeterminate"===t.mode),k["\u0275\u0275attribute"]("viewBox",t._getViewBox()),k["\u0275\u0275advance"](1),k["\u0275\u0275property"]("ngSwitchCase",!0),k["\u0275\u0275advance"](1),k["\u0275\u0275property"]("ngSwitchCase",!1))},directives:[c.p,c.q],styles:[".mat-progress-spinner{display:block;position:relative}.mat-progress-spinner svg{position:absolute;transform:rotate(-90deg);top:0;left:0;transform-origin:center;overflow:visible}.mat-progress-spinner circle{fill:transparent;transform-origin:center;transition:stroke-dashoffset 225ms linear}._mat-animation-noopable.mat-progress-spinner circle{transition:none;animation:none}.cdk-high-contrast-active .mat-progress-spinner circle{stroke:currentColor}.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate]{animation:mat-progress-spinner-linear-rotate 2000ms linear infinite}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate]{transition:none;animation:none}.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate] circle{transition-property:stroke;animation-duration:4000ms;animation-timing-function:cubic-bezier(0.35, 0, 0.25, 1);animation-iteration-count:infinite}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate] circle{transition:none;animation:none}.mat-progress-spinner.mat-progress-spinner-indeterminate-fallback-animation[mode=indeterminate]{animation:mat-progress-spinner-stroke-rotate-fallback 10000ms cubic-bezier(0.87, 0.03, 0.33, 1) infinite}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-fallback-animation[mode=indeterminate]{transition:none;animation:none}.mat-progress-spinner.mat-progress-spinner-indeterminate-fallback-animation[mode=indeterminate] circle{transition-property:stroke}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-fallback-animation[mode=indeterminate] circle{transition:none;animation:none}@keyframes mat-progress-spinner-linear-rotate{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes mat-progress-spinner-stroke-rotate-100{0%{stroke-dashoffset:268.606171575px;transform:rotate(0)}12.5%{stroke-dashoffset:56.5486677px;transform:rotate(0)}12.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(72.5deg)}25%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(72.5deg)}25.0001%{stroke-dashoffset:268.606171575px;transform:rotate(270deg)}37.5%{stroke-dashoffset:56.5486677px;transform:rotate(270deg)}37.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(161.5deg)}50%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(161.5deg)}50.0001%{stroke-dashoffset:268.606171575px;transform:rotate(180deg)}62.5%{stroke-dashoffset:56.5486677px;transform:rotate(180deg)}62.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(251.5deg)}75%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(251.5deg)}75.0001%{stroke-dashoffset:268.606171575px;transform:rotate(90deg)}87.5%{stroke-dashoffset:56.5486677px;transform:rotate(90deg)}87.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(341.5deg)}100%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(341.5deg)}}@keyframes mat-progress-spinner-stroke-rotate-fallback{0%{transform:rotate(0deg)}25%{transform:rotate(1170deg)}50%{transform:rotate(2340deg)}75%{transform:rotate(3510deg)}100%{transform:rotate(4680deg)}}\n"],encapsulation:2,changeDetection:0}),T._diameters=new WeakMap,T),D=((C=function e(){u(this,e)}).\u0275mod=k["\u0275\u0275defineNgModule"]({type:C}),C.\u0275inj=k["\u0275\u0275defineInjector"]({factory:function(e){return new(e||C)},imports:[[w.i,c.c],w.i]}),C),$=a("CDpB"),A=a("2Vo4"),R=a("jtHE"),z=a("XNiG"),L=a("Cfvw"),I=a("VRyK"),F=a("xgIS"),W=a("LRne"),V=a("PqYM"),H=a("pLZG"),U=a("IzEk"),X=a("vkgz"),N=a("3E0/"),q=a("1G5W"),Y=a("Kj3r"),K=a("lJxs"),G=a("eIep"),J=a("128B"),Q=a("mrSG");function Z(e,t){}function ee(e,t){if(1&e&&k["\u0275\u0275element"](0,"mat-progress-spinner",2),2&e){var n=k["\u0275\u0275nextContext"]();k["\u0275\u0275property"]("diameter",n.progressDiameter)}}var te=function(e,t){return{$implicit:e,designMode:t}},ne=["tileTemplate"],ie=["tilesContainer"];function re(e,t){if(1&e){var n=k["\u0275\u0275getCurrentView"]();k["\u0275\u0275elementStart"](0,"deja-tile",4),k["\u0275\u0275listener"]("close",(function(){k["\u0275\u0275restoreView"](n);var e=t.$implicit;return k["\u0275\u0275nextContext"]().onTileClosed(e)})),k["\u0275\u0275elementEnd"]()}if(2&e){var i=t.$implicit,r=t.index,o=k["\u0275\u0275nextContext"]();k["\u0275\u0275property"]("id",i.id)("tile",i)("designMode",o.designMode)("template",o.tileTemplate),k["\u0275\u0275attribute"]("tile-index",r)}}var oe=function(){function e(t){u(this,e),this.element=t.nativeElement,this.element.style.display="none"}return r(e,[{key:"bounds",set:function(e){if(e){var t=e.left,n=e.top,i=e.width,r=e.height;this.element.style.left="".concat(t,"px"),this.element.style.top="".concat(n,"px"),this.element.style.width="".concat(i,"px"),this.element.style.height="".concat(r,"px"),this.element.style.display="block"}else this.element.style.display="none"}}]),e}();oe.\u0275fac=function(e){return new(e||oe)(k["\u0275\u0275directiveInject"](k.ElementRef))},oe.\u0275dir=k["\u0275\u0275defineDirective"]({type:oe,selectors:[["","deja-tile-position",""]],inputs:{bounds:"bounds"}}),oe.ctorParameters=function(){return[{type:k.ElementRef}]},oe.propDecorators={bounds:[{type:k.Input}]};var ae=function(){function e(t){u(this,e),this.cutted$=new A.a(!1),this.dragging$=new A.a(!1),this.dropping$=new A.a(!1),this.pressed$=new A.a(!1),this.selected$=new A.a(!1),this.hidden$=new R.a(1),this.pixelBounds$=new A.a(null),this.deleted$=new z.a,this.refresh$=new z.a,this.isTemporary=!1,this._isDragging=!1,this._isDropping=!1,this._isPressed=!1,this._isHidden=!1,this._id=t||"#"+e.CURRENT_ID++}return r(e,[{key:"makeId",value:function(){this._id="#"+e.CURRENT_ID++}},{key:"equalsTo",value:function(e){return this._templateModel?this._templateModel===e._templateModel:this._id===e._id}},{key:"clone",value:function(t){return t||(t=new e(this.id)),t._percentBounds=this.percentBounds,t._color=this.color,t._templateModel=this.templateModel,t._cutted=this._cutted,t._selected=this._selected,t._pending=this._pending,t._fading=this._fading,t}},{key:"delete",value:function(){this.deleted$.next()}},{key:"refresh",value:function(){this.refresh$.next()}},{key:"idealBounds",get:function(){return new $.F(0,0,15,15)}},{key:"pixelBounds",set:function(e){$.F.equals(this._pixelBounds,e)||(this._pixelBounds=e,this.pixelBounds$.next(e))},get:function(){return this._pixelBounds}},{key:"percentBounds",set:function(e){this._percentBounds=e},get:function(){return this._percentBounds}},{key:"templateModel",set:function(e){this._templateModel=e},get:function(){return this._templateModel}},{key:"id",get:function(){return this._id}},{key:"isCutted",set:function(e){this._cutted!==e&&(this._cutted=e,this.cutted$.next(e))},get:function(){return this._cutted}},{key:"color",set:function(e){this._color=e},get:function(){return this._color}},{key:"isDragging",set:function(e){this._isDragging!==e&&(this._isDragging=e,this.dragging$.next(e))},get:function(){return this._isDragging}},{key:"isDropping",set:function(e){this._isDropping!==e&&(this._isDropping=e,this.dropping$.next(e))},get:function(){return this._isDropping}},{key:"isPressed",set:function(e){this._isPressed!==e&&(this._isPressed=e,this.pressed$.next(e))},get:function(){return this._isPressed}},{key:"isSelected",set:function(e){this._selected!==e&&(this._selected=e,this.selected$.next(e))},get:function(){return this._selected}},{key:"isHidden",set:function(e){this._isHidden!==e&&(this._isHidden=e,this.hidden$.next(e))},get:function(){return this._isHidden}},{key:"isPending",set:function(e){this._pending=e},get:function(){return this._pending}},{key:"fading",get:function(){return this._fading},set:function(e){this._fading=e}}]),e}();ae.CURRENT_ID=0;var se=function(e){o(n,e);var t=s(n);function n(e,i){var r;return u(this,n),(r=t.call(this)).changeDetectorRef=i,r.close=new k.EventEmitter,r.progressDiameter=100,r.element=e.nativeElement,r.element.setAttribute("hidden","0"),r}return r(n,[{key:"designMode",set:function(e){this._designMode=Object(j.b)(e)},get:function(){return this._designMode}},{key:"tile",set:function(e){var t=this;if(this._tile=e,e){var n=function(e,n){n?t.element.setAttribute(e,n.toString()):t.element.removeAttribute(e)};e.fading&&(this.element.setAttribute("fading","0"),this.changeDetectorRef.markForCheck()),Object(L.a)(e.pixelBounds$).pipe(Object(H.a)((function(e){return!!e})),Object(U.a)(1),Object(H.a)((function(){return e.fading})),Object(X.a)((function(){t.element.setAttribute("fading","1"),t.changeDetectorRef.markForCheck()})),Object(N.a)(200),Object(q.a)(this.destroyed$)).subscribe((function(){t.element.removeAttribute("fading"),t.changeDetectorRef.markForCheck()})),Object(L.a)(e.pixelBounds$).pipe(Object(H.a)((function(e){return!!e})),Object(q.a)(this.destroyed$)).subscribe((function(n){e.isHidden||t.element.removeAttribute("hidden"),t.element.style.left="".concat(n.left,"px"),t.element.style.top="".concat(n.top,"px"),t.element.style.width="".concat(n.width,"px"),t.element.style.height="".concat(n.height,"px"),t.progressDiameter=Math.min(100,Math.round(Math.max(.4*n.width,.4*n.height))),t.changeDetectorRef.markForCheck()})),Object(L.a)(e.pressed$).pipe(Object(X.a)((function(e){return n("pressed",e)})),Object(q.a)(this.destroyed$)).subscribe((function(){return t.changeDetectorRef.markForCheck()})),Object(L.a)(e.selected$).pipe(Object(X.a)((function(e){return n("selected",e)})),Object(q.a)(this.destroyed$)).subscribe((function(){return t.changeDetectorRef.markForCheck()})),Object(L.a)(e.dragging$).pipe(Object(X.a)((function(e){return n("drag",e)})),Object(q.a)(this.destroyed$)).subscribe((function(){return t.changeDetectorRef.markForCheck()})),Object(L.a)(e.dropping$).pipe(Object(X.a)((function(e){return n("drop",e)})),Object(q.a)(this.destroyed$)).subscribe((function(){return t.changeDetectorRef.markForCheck()})),Object(L.a)(e.cutted$).pipe(Object(X.a)((function(e){return n("cutted",e)})),Object(q.a)(this.destroyed$)).subscribe((function(){return t.changeDetectorRef.markForCheck()})),Object(L.a)(e.deleted$).pipe(Object(X.a)((function(){return t.element.remove()})),Object(q.a)(this.destroyed$)).subscribe((function(){return t.changeDetectorRef.markForCheck()}));var i=Object(L.a)(e.hidden$).pipe(Object(X.a)((function(e){return n("hidden",e?"1":"2")})));i.pipe(Object(Y.a)(1e3),Object(H.a)((function(e){return e})),Object(X.a)((function(){return t.element.setAttribute("hidden","0")})),Object(q.a)(this.destroyed$)).subscribe((function(){return t.changeDetectorRef.markForCheck()})),i.pipe(Object(Y.a)(1),Object(H.a)((function(e){return!e})),Object(X.a)((function(){return t.element.removeAttribute("hidden")})),Object(q.a)(this.destroyed$)).subscribe((function(){return t.changeDetectorRef.markForCheck()})),Object(L.a)(e.refresh$).pipe(Object(Y.a)(1),Object(q.a)(this.destroyed$)).subscribe((function(){return t.changeDetectorRef.markForCheck()}))}},get:function(){return this._tile}}]),n}($.s);se.\u0275fac=function(e){return new(e||se)(k["\u0275\u0275directiveInject"](k.ElementRef),k["\u0275\u0275directiveInject"](k.ChangeDetectorRef))},se.\u0275cmp=k["\u0275\u0275defineComponent"]({type:se,selectors:[["deja-tile"]],inputs:{designMode:"designMode",tile:"tile",template:"template"},outputs:{close:"close"},features:[k["\u0275\u0275InheritDefinitionFeature"]],decls:2,vars:6,consts:[[3,"ngTemplateOutlet","ngTemplateOutletContext"],["mode","indeterminate","class","accent",3,"diameter",4,"ngIf"],["mode","indeterminate",1,"accent",3,"diameter"]],template:function(e,t){1&e&&(k["\u0275\u0275template"](0,Z,0,0,"ng-template",0),k["\u0275\u0275template"](1,ee,1,1,"mat-progress-spinner",1)),2&e&&(k["\u0275\u0275property"]("ngTemplateOutlet",t.template)("ngTemplateOutletContext",k["\u0275\u0275pureFunction2"](3,te,t.tile,t.designMode)),k["\u0275\u0275advance"](1),k["\u0275\u0275property"]("ngIf",t.tile&&t.tile.isPending))},directives:[c.s,c.n,S],styles:['[_nghost-%COMP%]{display:block;opacity:1;position:absolute;transition-duration:.5s;transition-property:left,top,opacity;transition-timing-function:ease}[expanded][_nghost-%COMP%]{transition-property:height}[cutted][_nghost-%COMP%]{opacity:.5}[drag][_nghost-%COMP%], [drop][_nghost-%COMP%]{z-index:100}[drag][_nghost-%COMP%]{-moz-user-select:none;-webkit-user-select:none;opacity:.5;transition:none;user-select:none}[fading="0"][_nghost-%COMP%]{opacity:0;transition:none}[fading="1"][_nghost-%COMP%]{opacity:0}[hidden="0"][_nghost-%COMP%]{transition:none;visibility:hidden}[hidden="1"][_nghost-%COMP%]{opacity:0;transition:opacity 1s ease-in-out}[hidden="2"][_nghost-%COMP%]{opacity:0;transition:none;visibility:visible}[_nghost-%COMP%]   mat-progress-spinner[_ngcontent-%COMP%]{bottom:.2rem;position:absolute;right:.2rem;transform:translate(-60%,-60%);z-index:1}'],changeDetection:0}),se.ctorParameters=function(){return[{type:k.ElementRef},{type:k.ChangeDetectorRef}]},se.propDecorators={template:[{type:k.Input}],close:[{type:k.Output}],designMode:[{type:k.Input}],tile:[{type:k.Input}]};var ce=function(e){o(n,e);var t=s(n);function n(e){var i;u(this,n),(i=t.call(this)).clipboardService=e,i.refreshTiles$=new z.a,i.ensureVisible$=new z.a,i.ensureBounds$=new z.a,i.dragging$=new A.a(!1),i.dragSelection$=new z.a,i.dragDropInfos$=new z.a,i.selectionRect$=new z.a,i.dragover$=new z.a,i.dragleave$=new z.a,i.deleteTiles$=new z.a,i.designMode=!1,i.layoutCompleted=new z.a,i.layoutChanged=new z.a,i.tilesAdded=new z.a,i.tilesDeleted=new z.a,i.selectionChanged=new z.a,i.contentAdding=new z.a,i.contentRemoving=new z.a,i._tileMinWidth=10,i._tileMinWidthUnit="%",i._tileMaxWidth=100,i._tileMaxWidthUnit="%",i._tileMinHeight=10,i._tileMinHeightUnit="%",i._tileMaxHeight=100,i._tileMaxHeightUnit="%",i._maxWidth=100,i._maxWidthUnit="%",i.tilesDic=new Map,i._targetBounds=new $.F,i.destination=new $.F,i.dragPageOffset=new $.E,i.dragOriginalPosition=new $.E,i.selectedIds=new Array,Object(L.a)(i.refreshTiles$).pipe(Object(Y.a)(30),Object(X.a)((function(){i.container.style.width="",i.container.style.height=""})),Object(N.a)(10),Object(q.a)(i.destroyed$)).subscribe((function(e){var t=new Array,n=i.container.getBoundingClientRect();!(null==e?void 0:e.resetWidth)&&i.hundredPercentWith||(i.hundredPercentWith=n.width);var r=n.height-20,o=n.width-20,a=0,s=0,c=i.tiles||new Array,l=new Array;c.forEach((function(e){if(e.percentBounds&&!e.percentBounds.isEmpty()){var n=i.getPixelBounds(e.percentBounds);n.bottom>a&&(a=n.right),n.right>s&&(s=n.bottom),e.isDragging||(e.pixelBounds=n)}else t.push(e);e.isSelected&&!e.isHidden&&l.push(e.id),e.pixelBounds&&e.pixelBounds.bottom>r&&(r=e.pixelBounds.bottom)}));var d=s,u=0;if(t.forEach((function(e){e.percentBounds=e.percentBounds||new $.F(i.getPercentSize(u),i.getPercentSize(d),3*i.getTileMinPercentWidth(),3*i.getTileMinPercentHeight());var t=i.getPixelBounds(e.percentBounds);t.right>o&&(d=s,u=0,e.percentBounds.left=0,e.percentBounds.top=i.getPercentSize(d),t=i.getPixelBounds(e.percentBounds)),t.bottom>s&&(s=t.bottom),e.pixelBounds=i.getPixelBounds(e.percentBounds),u+=t.width})),i.dragTarget){var h=i.getPixelBounds(i.dragTarget);r<=h.bottom&&(r=h.bottom+h.height),o<=h.right&&(o=h.right+h.width)}var p=i.getPixelSize(2*i._tileMinHeight,i._tileMinHeightUnit);r<p&&(r=p),i.container.style.width="".concat(o,"px"),i.container.style.height="".concat(r,"px"),(null==e?void 0:e.ensureVisible)&&i.ensureVisible$.next(e.ensureVisible),(null==e?void 0:e.ensureBounds)&&i.ensureBounds$.next(e.ensureBounds),i.selectedTiles=l;var f=new CustomEvent("DejaTilesEvent",{cancelable:!1});t.length>0&&(f.tiles=t,i.layoutChanged.next(f)),f.tiles=c,i.layoutCompleted.next(f)}));var r=Object(L.a)(i.ensureVisible$).pipe(Object(N.a)(1),Object(K.a)((function(e){return i.tilesDic.get(e)})),Object(H.a)((function(e){return!!e})),Object(K.a)((function(e){return e.percentBounds})));Object(I.a)(i.ensureBounds$,r).pipe(Object(q.a)(i.destroyed$)).subscribe((function(e){var t=i.getPixelBounds(e),n=t.left,r=t.right,o=t.top,a=t.bottom,s=function(e){for(;e&&"DEJA-TILES"!==e.tagName;)e=e.parentElement;return e}(i.container);if(s){var c=i.container.getBoundingClientRect(),l=s.getBoundingClientRect();n+c.left<l.bottom?s.scrollLeft+=n+c.left-l.bottom:r+c.left>l.right&&(s.scrollLeft+=r+c.left-l.right),o+c.top<l.top?s.scrollTop+=o+c.top-l.top:a+c.top>l.bottom&&(s.scrollTop+=a+c.top-l.bottom)}})),Object(L.a)(i.dragSelection$).pipe(Object(G.a)((function(e){var t=Object(F.a)(i._container.ownerDocument,"mouseup").pipe(Object(X.a)((function(){return i.selectionRect$.next(null)})));return Object(F.a)(i._container,"mousemove").pipe(Object(q.a)(t),Object(H.a)((function(e){return 1===e.buttons})),Object(X.a)((function(t){var n=i._container.getBoundingClientRect();e.selectedRect=$.F.fromPoints(e.startPosition,new $.E(t.pageX-n.left,t.pageY-n.top)),i.selectionRect$.next(e.selectedRect);var r=i.hitTest(e.selectedRect);i.selectedTiles=r.map((function(e){return e.id}))})))})),Object(q.a)(i.destroyed$)).subscribe();var o=Object(L.a)(i.dragleave$);return Object(L.a)(i.dragDropInfos$).pipe(Object(G.a)((function(e){var t,n=e&&((null===(t=e.tiles)||void 0===t?void 0:t.length)&&e.tiles||e.currentTile&&[e.currentTile]);if(!n)return Object(W.a)(null);var r=!e.tiles,a=Object(F.a)(i._container,"mousemove"),s=Object(F.a)(i._container.ownerDocument,"keyup").pipe(Object(H.a)((function(e){return e.code===$.A.Escape}))),c=a.pipe(Object(H.a)((function(e){return 1!==e.buttons}))),l=Object(I.a)(o,c,s).pipe(Object(X.a)((function(){i.removeTemporaryTile(),i.cancelDrag(n)}))),d=Object(F.a)(i._container.ownerDocument,"mouseup").pipe(Object(X.a)((function(){return i.drop(n)}))),u=Object(I.a)(d,l),h=Object(L.a)(i.dragover$).pipe(Object(K.a)((function(e){return e.originalEvent})));return Object(I.a)(a,h).pipe(Object(q.a)(u),Object(X.a)((function(t){var o=i._container.getBoundingClientRect(),a=t.pageX-o.left,s=t.pageY-o.top;if(e.enabled)i.drag(n,a,s);else if(Math.abs(e.startX-a)>=15||Math.abs(e.startY-s)>=15)if(r){var c=e.currentTile;i.selectedTiles=[c.id];var l=c.percentBounds;l&&!l.isEmpty()||(l=new $.F(0,0,15,15));var d=i.getFreePlace(new $.F(i.getPercentSize(a)-l.width/2,i.getPercentSize(s)-l.height/2,l.width,l.height));e.startX=d.left-l.width/2,e.startY=d.top-l.height/2,c.percentBounds=d,c.dragging$.next(!0),i._cursor="move",i.tiles.push(c),i.tilesDic.set(c.id,c),i.dragging$.next(!0),e.enabled=!0,i.startDrag(n,i.getPixelSize(d.left+d.width/2),i.getPixelSize(d.top+d.height/2))}else i.dragging$.next(!0),e.enabled=!0,i.startDrag(n,e.startX,e.startY)})))})),Object(q.a)(i.destroyed$)).subscribe(),Object(L.a)(i.deleteTiles$).pipe(Object(q.a)(i.destroyed$)).subscribe((function(e){return i.deleteTiles(e)})),i}return r(n,[{key:"copySelection",value:function(){var e=this.tiles.filter((function(e){return e.isSelected}));return e.length&&this.copyTiles(e,!1),e}},{key:"cutSelection",value:function(){var e=this.tiles.filter((function(e){return e.isSelected}));return e.length&&this.copyTiles(e,!0),e}},{key:"deleteSelection",value:function(){var e=this.tiles.filter((function(e){return e.isSelected}));return e.length&&this.removeTiles(e.map((function(e){return e.id}))),e}},{key:"paste",value:function(){if(!this.clipboardService||!this.clipboardService.isAvailable("tiles"))return new Array;var e,t=this.clipboardService.get("tiles");this.tiles.forEach((function(e){return e.isSelected=!1})),t.forEach((function(t){e=e?$.F.union(e,t.percentBounds):new $.F(t.percentBounds)}));var n=this.getFreePlace(new $.F(0,0,e.width,e.height)),i=t.map((function(t){var i=t.clone();return i.percentBounds=new $.F(n.left+t.percentBounds.left-e.left,n.top+t.percentBounds.top-e.top,t.percentBounds.width,t.percentBounds.height),i.isSelected=!0,i}));return this.addTiles(i),i}},{key:"getTileElementFromHTMLElement",value:function(e){for(var t=e;t&&"DEJA-TILE"!==t.tagName;)if((t=t.parentElement)===this.container)return;return t}},{key:"isElementInsideDejaEditor",value:function(e){for(var t=e;t&&t!==this.container;){if("DEJA-EDITOR"===t.tagName)return!0;t=t.parentElement}return!1}},{key:"getTileComponentFromHTMLElement",value:function(e){var t=this.getTileElementFromHTMLElement(e);return t&&this.tilesDic.get(t.id)}},{key:"deleteTiles",value:function(e){var t=this;if(e&&0!==e.length){var n=new CustomEvent("DejaTilesDeletedEvent",{cancelable:!1});n.tiles=e,e.forEach((function(e){t.tilesDic.delete(e.id),e.delete()}));for(var i=this.tiles.length;--i>=0;)this.tilesDic.has(this.tiles[i].id)||this.tiles.splice(i,1);this.refreshTiles$.next({resetWidth:!0}),n.tiles=this.tiles,this.tilesDeleted.next(n)}}},{key:"removeTiles",value:function(e){var t=this;if(e&&0!==e.length){var n=e.map((function(e){return t.tilesDic.get(e)}));n.forEach((function(e){e.isHidden=!0}));var i=new CustomEvent("DejaTilesRemoveEvent",{cancelable:!0});i.tiles=this.tiles,i.removed=n,i.cancel$=new z.a;var r=i.cancel$.pipe(Object(U.a)(1),Object(q.a)(this.destroyed$)).subscribe((function(e){e?n.forEach((function(e){return e.isHidden=!1})):t.deleteTiles(n)}));this.contentRemoving.next(i),i.defaultPrevented||(r.unsubscribe(),this.deleteTiles(n))}}},{key:"getFreePlace",value:function(e){var t=new Array,n=this.tiles.filter((function(e){return!e.isDragging})),i=0;n.forEach((function(e){e.percentBounds.bottom>i&&(i=e.percentBounds.bottom)}));for(var r=0;r<=this._maxWidth-e.width;r+=this._tileMinWidth)for(var o=function(i){var o=new $.F(r,i,e.width,e.height);n.find((function(e){return e.percentBounds.intersectWith(o)}))||t.push(o)},a=0;a<=i-e.height;a+=this._tileMinHeight)o(a);return t.length>0?(t.sort((function(t,n){var i=function(t){return Math.min(Math.abs(t.left-e.left),Math.abs(t.right-e.right))+200*Math.min(Math.abs(t.top-e.top),Math.abs(t.bottom-e.bottom))};return i(t)-i(n)})),t[0]):new $.F(0,i,e.width,e.height)}},{key:"moveTile",value:function(e,t){var n=this.tiles.find((function(t){return t.id===e}));n&&(n.percentBounds=t,this.refreshTiles$.next(null))}},{key:"hitTest",value:function(e){var t=new $.F(this.getPercentSize(e.left),this.getPercentSize(e.top),this.getPercentSize(e.width),this.getPercentSize(e.height));return this.tiles.filter((function(e){return e.percentBounds.intersectWith(t)}))}},{key:"getPercentSize",value:function(e){return Math.round(100*e/this.hundredPercentWith)}},{key:"dragEnter",value:function(e,t){if(!this.designMode||!this._container)return!1;var n=e.DejaTile;if(!n)return!1;var i=this._container.getBoundingClientRect(),r=t.originalEvent,o=r.pageX,a=r.pageY,s=o-i.left,c=a-i.top,l=n.clone();return l.isTemporary=!0,this.dragDropInfos$.next({enabled:!1,startX:s,startY:c,currentTile:l}),!0}},{key:"startDrag",value:function(e,t,n){var i,r=this,o=this.saveLayout();e.forEach((function(e){i=i?$.F.union(i,e.percentBounds):e.percentBounds,e.isDragging=!0})),this.dragRelativePosition=new Map,e.forEach((function(e){return r.dragRelativePosition.set(e.id,new $.E(e.percentBounds.left-i.left,e.percentBounds.top-i.top))})),this.dragPageOffset=new $.E(t,n),this.dragOriginalPosition=new $.E(i.left,i.top),this.targetBounds=o.targetBounds=o.validBounds=i,this.originalLayout=o,this.validLayout=void 0}},{key:"cancelDrag",value:function(e){this.clearMoveTimer(),Object(L.a)(e).pipe(Object(H.a)((function(e){return!!e})),Object(q.a)(this.destroyed$)).subscribe((function(e){e.isDragging=!1,e.isDropping=!0})),this.originalLayout&&this.restoreLayout(this.originalLayout),this.endDrag()}},{key:"drop",value:function(e){var t,n=this;if(this.clearMoveTimer(),this.validLayout){if(this.restoreLayout(this.validLayout),"move"!==this._cursor){var i=e[0];i.percentBounds=new $.F(this.validLayout.validBounds),i.isDragging=!1}else Object(L.a)(e).pipe(Object(H.a)((function(e){return!!e})),Object(X.a)((function(e){var t=n.validLayout.validBounds.left+n.dragRelativePosition.get(e.id).left,i=n.validLayout.validBounds.top+n.dragRelativePosition.get(e.id).top;e.percentBounds=new $.F(t,i,e.percentBounds.width,e.percentBounds.height),e.isDragging=!1,e.isDropping=!0,e.isTemporary&&(n.tilesDic.delete(e.id),e.makeId(),n.tilesDic.set(e.id,e),n.addTiles([e]))})),Object(N.a)(1e3),Object(q.a)(this.destroyed$)).subscribe((function(e){return e.isDropping=!1}));t=this.tiles.filter((function(e){var t=n.originalLayout[e.id];return!$.F.equals(e.percentBounds,null==t?void 0:t.bounds)})),this.endDrag()}else this.removeTemporaryTile(),this.cancelDrag(e);if(t){var r=new CustomEvent("DejaTilesEvent",{cancelable:!0});r.tiles=this.tiles,this.layoutChanged.next(r)}return t}},{key:"endDrag",value:function(){this.originalLayout=void 0,this.validLayout=void 0,this.targetBounds=void 0,this.dragging$.next(!1),this.dragDropInfos$.next(null),this.dragTarget=void 0,this.copyTiles(null),this.refreshTiles$.next(null)}},{key:"drag",value:function(e,t,n){var i=this,r=new $.E(t-this.dragPageOffset.left,n-this.dragPageOffset.top),o=r.left+this.getPixelSize(this.dragOriginalPosition.left),a=r.top+this.getPixelSize(this.dragOriginalPosition.top),s=this.getTileMinPixelSize(),c=this.getTileMaxPixelSize();if("move"!==this._cursor){var l=e[0],d=this.getPixelBounds(l.percentBounds),u=o+d.width,h=a+d.height,p=d.right,f=d.bottom;switch(this._cursor){case"nw-resize":d.left=Math.max(Math.min(o,d.right-s.width),d.right-c.width),d.right=p,d.top=Math.max(Math.min(a,d.bottom-s.height),d.bottom-c.height),d.bottom=f,this.size(l,new $.E(o,a),$.u.left+$.u.top);break;case"sw-resize":d.left=Math.max(Math.min(o,d.right-s.width),d.right-c.width),d.right=p,d.bottom=Math.max(Math.min(h,d.top+c.height),d.top+s.height),this.size(l,new $.E(o,h),$.u.left+$.u.bottom);break;case"w-resize":d.left=Math.max(Math.min(o,d.right-s.width),d.right-c.width),d.right=p,this.size(l,new $.E(o,0),$.u.left);break;case"ne-resize":d.right=Math.max(Math.min(u,d.left+c.width),d.left+s.width),d.top=Math.max(Math.min(a,d.bottom-s.height),d.bottom-c.height),d.bottom=f,this.size(l,new $.E(u,a),$.u.right+$.u.top);break;case"se-resize":d.right=Math.max(Math.min(u,d.left+c.width),d.left+s.width),d.bottom=Math.max(Math.min(h,d.top+c.height),d.top+s.height),this.size(l,new $.E(u,h),$.u.right+$.u.bottom);break;case"e-resize":d.right=Math.max(Math.min(u,d.left+c.width),d.left+s.width),this.size(l,new $.E(u,0),$.u.right);break;case"n-resize":d.top=Math.max(Math.min(a,d.bottom-s.height),d.bottom-c.height),d.bottom=f,this.size(l,new $.E(0,a),$.u.top);break;case"s-resize":d.bottom=Math.max(Math.min(h,d.top+c.height),d.top+s.height),this.size(l,new $.E(0,h),$.u.bottom)}l.pixelBounds=d}else e.forEach((function(e){e.pixelBounds=new $.F(o+i.getPixelSize(i.dragRelativePosition.get(e.id).left),a+i.getPixelSize(i.dragRelativePosition.get(e.id).top),i.getPixelSize(e.percentBounds.width),i.getPixelSize(e.percentBounds.height))})),this.dragTarget=new $.F(this.getPercentSize(o),this.getPercentSize(a),this.targetBounds.width,this.targetBounds.height),this.move()}},{key:"addTiles",value:function(e){var t,n=this;if(e&&0!==e.length){e.forEach((function(e){n.tiles.find((function(t){return t.id===e.id}))||(n.tiles.find((function(t){var n;return e.percentBounds&&(null===(n=t.percentBounds)||void 0===n?void 0:n.intersectWith(e.percentBounds))}))&&(e.percentBounds=void 0),e.percentBounds||(e.percentBounds=n.getFreePlace(e.idealBounds)),n.tiles.push(e),n.tilesDic.set(e.id,e))}));var i=new CustomEvent("DejaTilesAddEvent",{cancelable:!0});i.tiles=this.tiles,i.added=e,i.cancel$=new z.a;var r,o=null===(t=this.clipboardService)||void 0===t?void 0:t.get("tiles-provider");o&&(r=this.clipboardService.get("tiles")).forEach((function(e){e.isHidden=!0}));var a,s=function(e){r&&(o.next(r),n.clipboardService.clear());var t=new CustomEvent("DejaTileAddedEvent",{cancelable:!1});t.tiles=n.tiles,t.added=e,n.tilesAdded.next(t)};e.forEach((function(e){a=a?$.F.union(a,e.percentBounds):new $.F(e.percentBounds)})),this.refreshTiles$.next({ensureBounds:a}),this.contentAdding.next(i),i.defaultPrevented?(i.cancel$.pipe(Object(U.a)(1),Object(H.a)((function(e){return!e})),Object(q.a)(this.destroyed$)).subscribe(s),i.cancel$.pipe(Object(U.a)(1),Object(H.a)((function(e){return!!e})),Object(G.a)((function(){return r&&r.forEach((function(e){e.isHidden=!1,e.isCutted=!0})),Object(L.a)(e)})),Object(X.a)((function(e){return e.isHidden=!0})),Object(N.a)(1e3),Object(J.a)((function(e,t){return Object(Q.c)(e,[t])}),new Array),Object(U.a)(1),Object(q.a)(this.destroyed$)).subscribe((function(e){return n.deleteTiles(e)}))):s(e)}}},{key:"size",value:function(e,t,n){var i,r,o,a,s=new $.E(this.getPercentSize(t.left),this.getPercentSize(t.top)),c=e.percentBounds.clone(),l=e.percentBounds.clone();if(n&$.u.left){i=this.getTileMinPercentWidth(),o=this.getTileMaxPercentWidth();var d=s.left,u=c.left<d?i*Math.ceil(d/i):i*Math.floor(d/i),h=Math.min(o,Math.max(i,l.right-u));c.width=c.right-d,c.left=d,l.left=l.right-h,l.width=h}if(n&$.u.right){i=i||this.getTileMinPercentWidth(),o=o||this.getTileMaxPercentWidth();var p=s.left,f=c.right<p?i*Math.ceil(p/i):i*Math.floor(p/i);c.width=p-c.left,l.width=Math.min(o,Math.max(i,f-l.left))}if(n&$.u.top){r=this.getTileMinPercentHeight(),a=this.getTileMaxPercentHeight();var g=s.top,m=c.top<g?r*Math.ceil(g/r):r*Math.floor(g/r),v=Math.min(a,Math.max(r,l.bottom-m));c.height=c.bottom-g,c.top=g,l.top=l.bottom-v,l.height=v}if(n&$.u.bottom){r=r||this.getTileMinPercentHeight(),a=a||this.getTileMaxPercentHeight();var b=s.top,y=c.bottom<b?r*Math.ceil(b/r):r*Math.floor(b/r);c.height=b-c.top,l.height=Math.min(a,Math.max(r,y-l.top))}if(!$.F.equals(l,this.destination))if(this.restoreLayout(this.originalLayout),this.destination=l.clone(),this.tiles.find((function(e){return!e.isDragging&&e.percentBounds.intersectWith(l)}))){if(l){var x=this.ensureTarget(l,c,n);x&&(this.targetBounds=x,this.validLayout=this.saveLayout(),this.validLayout.targetBounds=l,this.validLayout.validBounds=x,this.refreshTiles$.next(null))}}else this.targetBounds=l,this.validLayout=this.saveLayout(),this.validLayout.targetBounds=this.validLayout.validBounds=l,this.refreshTiles$.next(null)}},{key:"clearMoveTimer",value:function(){this.moveTimOut&&(this.moveTimOut.unsubscribe(),this.moveTimOut=void 0)}},{key:"move",value:function(){var e=this,t=this.getTileMinPercentWidth(),n=this.getTileMinPercentHeight(),i=this.ensureContainer(new $.F(t*Math.round(this.dragTarget.left/t),n*Math.round(this.dragTarget.top/n),this.dragTarget.width,this.dragTarget.height));if(!(this.lastTargetBounds&&Math.abs(i.left-this.lastTargetBounds.left)<t&&Math.abs(i.top-this.lastTargetBounds.top)<n)){this.lastTargetBounds=i;var r=this.tiles.filter((function(e){return!e.isDragging})).reduce((function(e,t){var n=$.F.overlapInfos(t.percentBounds,i);return Math.max(Math.min(n.height,n.width),e)}),0);if(this.tiles.find((function(t){var n=e.originalLayout[t.id];return null==n?void 0:n.bounds.intersectWith(i)}))||this.restoreLayout(this.originalLayout),0===r)this.clearMoveTimer(),this.targetBounds=i.clone(),this.destination=i.clone(),this.validLayout=this.saveLayout(),this.validLayout.targetBounds=this.validLayout.validBounds=i,this.refreshTiles$.next(null);else{if($.F.equals(this.targetBounds,i)||this.clearMoveTimer(),r>3){var o=i.clone();this.moveTimOut=Object(V.a)(500).pipe(Object(U.a)(1),Object(q.a)(this.destroyed$)).subscribe((function(){e.restoreLayout(e.originalLayout),e.destination=o;var t=e.ensureTarget(o,e.dragTarget,$.u.all);t&&(e.targetBounds=t,e.validLayout=e.saveLayout(),e.validLayout.targetBounds=o,e.validLayout.validBounds=t,e.refreshTiles$.next(null))}))}for(var a=new Array,s=this.tiles.filter((function(e){return!e.isDragging})),c=Math.min(this.targetBounds.left,i.left);c<=Math.max(this.targetBounds.left,i.left);c++)for(var l=function(e){var t=new $.F(c,e,i.width,i.height);s.find((function(e){return e.percentBounds.intersectWith(t)}))||a.push(t)},d=Math.min(this.targetBounds.top,i.top);d<=Math.max(this.targetBounds.top,i.top);d++)l(d);a.length>0&&(a.sort((function(e,t){var n=function(e){return Math.min(Math.abs(e.left-i.left),Math.abs(e.right-i.right))+200*Math.min(Math.abs(e.top-i.top),Math.abs(e.bottom-i.bottom))};return n(e)-n(t)})),i=a[0],this.targetBounds=i.clone(),this.destination=i.clone(),this.validLayout=this.saveLayout(),this.validLayout.targetBounds=this.validLayout.validBounds=i,this.refreshTiles$.next(null))}}}},{key:"ensureContainer",value:function(e){e.left<0&&(e=e.offset(-e.left,0)),e.top<0&&(e=e.offset(0,-e.top));var t=this.getMaxPercentWidth();t&&e.right>t&&(e=e.offset(t-e.right,0));var n=this.getMaxPercentHeight();return n&&e.bottom>n&&(e=e.offset(0,n-e.bottom)),e}},{key:"ensureTarget",value:function(e,t,n,i){var r=this,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:10;t||(t=e),i||(i=e.clone()),n||(n=$.u.all);var a=new Array,s=new Array,c=new Array,l=new Array;if(this.tiles.filter((function(t){return!t.isDragging&&t.percentBounds.intersectWith(e)})).find((function(i){var o=new $.F(r.dragOriginalPosition.left,r.dragOriginalPosition.top,e.width,e.height);if(Math.abs(i.percentBounds.left-t.left)<1&&Math.abs(i.percentBounds.top-t.top)<1&&Math.abs(i.percentBounds.width-t.width)<1&&Math.abs(i.percentBounds.height-t.height)<1&&(Math.abs(t.left-o.right)<=4||Math.abs(t.right-o.left)<=4||Math.abs(t.top-o.bottom)<=4||Math.abs(t.bottom-o.top)<=4))return i.percentBounds=o,!0;var d,u=i.percentBounds.left-t.left,h=t.right-i.percentBounds.right,p=i.percentBounds.top-t.top,f=t.bottom-i.percentBounds.bottom,g=Math.max(0,Math.min(i.percentBounds.right,t.right)-Math.max(i.percentBounds.left,t.left))/Math.min(i.percentBounds.width,t.width);switch(Math.max(0,Math.min(i.percentBounds.bottom,t.bottom)-Math.max(i.percentBounds.top,t.top))/Math.min(i.percentBounds.height,t.height)>=g&&n&$.u.horizontal?d=h>=u&&n&$.u.left?$.u.left:$.u.right:n&$.u.vertical&&(d=f>=p&&n&$.u.top?$.u.top:$.u.bottom),d){case $.u.left:a.push(i);break;case $.u.top:c.push(i);break;case $.u.right:s.push(i);break;default:l.push(i)}})))return e;var d=0;return a.length&&(d=this.pushHorizontal(e,-1,a))?(e=this.ensureContainer(e.offset(d,0)),o?this.ensureTarget(e,t,n&~$.u.left,i,o-1):null):(s.length&&(d=this.pushHorizontal(e,1,s)),d>0?(this.restoreLayout(this.originalLayout),o?this.ensureTarget(i,t,n&$.u.vertical,void 0,o-1):null):c.length&&(d=this.pushVertical(e,-1,c))?(e=this.ensureContainer(e.offset(0,d)),o?this.ensureTarget(e,t,$.u.bottom,void 0,o-1):null):(d=this.pushVertical(e,1,l))?null:e)}},{key:"saveLayout",value:function(){var e=this,t={};return t.height=this.getTileMinPercentHeight(),this.tiles.forEach((function(n){var i=e.getPixelSize(n.percentBounds.top||0),r=e.getPixelSize(n.percentBounds.height||e._tileMinHeight);i+r>t.height&&(t.height=i+r),t[n.id]={bounds:n.percentBounds.clone(),id:n.id}})),t}},{key:"getPixelBounds",value:function(e){return $.F.fromLTRB(Math.round(e.left*this.hundredPercentWith/100),Math.round(e.top*this.hundredPercentWith/100),Math.round(e.right*this.hundredPercentWith/100),Math.round(e.bottom*this.hundredPercentWith/100))}},{key:"getPixelSize",value:function(e,t){return t&&"%"!==t?e:Math.round(e*this.hundredPercentWith/100)}},{key:"getSizePercentLimit",value:function(e){var t=this["".concat(e,"Unit")];return t&&"px"!==t?this[e]:this.getPercentSize(this[e])}},{key:"getSizePixelLimit",value:function(e){var t=this["".concat(e,"Unit")];return t&&"px"!==t?this.getPixelSize(this[e]):this[e]}},{key:"getTileMinPixelSize",value:function(){return new $.H(this.getSizePixelLimit("_tileMinWidth"),this.getSizePixelLimit("_tileMinHeight"))}},{key:"getTileMaxPixelSize",value:function(){return new $.H(this.getSizePixelLimit("_tileMaxWidth"),this.getSizePixelLimit("_tileMaxHeight"))}},{key:"getTileMinPercentWidth",value:function(){return Math.max(1,this.getSizePercentLimit("_tileMinWidth"))}},{key:"getTileMaxPercentWidth",value:function(){return Math.max(5,this.getSizePercentLimit("_tileMaxWidth"))}},{key:"getTileMinPercentHeight",value:function(){return Math.max(1,this.getSizePercentLimit("_tileMinHeight"))}},{key:"getTileMaxPercentHeight",value:function(){return Math.max(5,this.getSizePercentLimit("_tileMaxHeight"))}},{key:"getMaxPercentWidth",value:function(){return Math.max(5,this.getSizePercentLimit("_maxWidth"))}},{key:"getMaxPercentHeight",value:function(){return Math.max(5,this.getSizePercentLimit("_maxHeight"))}},{key:"getCursorFromHtmlElement",value:function(e,t,n){var i=this.getTileElementFromHTMLElement(n);if(!i)return null;var r=i.getBoundingClientRect();return e<r.left+15?t<r.top+15?"nw-resize":t>r.bottom-15?"sw-resize":"w-resize":e>r.right-15?t<r.top+15?"ne-resize":t>r.bottom-15?"se-resize":"e-resize":t<r.top+15?"n-resize":t>r.bottom-15?"s-resize":"move"}},{key:"extractValueAndUnit",value:function(e,t){var n=/(\d+)(.*)/i.exec(t);if((null==n?void 0:n.length)>=1){this[e]=parseInt(n[1],10),this["".concat(e,"Unit")]=n.length>=2?n[2]:"px"}}},{key:"restoreLayout",value:function(e){this.tiles.forEach((function(t){var n=e[t.id];n&&(t.percentBounds=n.bounds.clone())}))}},{key:"calcHorizontalOverflow",value:function(e,t,n,i){var r=this,o=0;return i=i||new Set,t.forEach((function(t){if(!i.has(t.id)){i.add(t.id);var a=t.percentBounds.offset(e*n,0),s=0,c=r.getMaxPercentWidth();a.left<0?s=-a.left:c&&a.right>c&&(s=a.right-c);var l=r.tiles.filter((function(e){return!e.isDragging&&!e.equalsTo(t)&&e.percentBounds.intersectWith(a)}));l.length&&(s+=r.calcHorizontalOverflow(e,l,n,i)),s>o&&(o=s)}})),o}},{key:"moveHorizontal",value:function(e,t,n,i){var r=this;t.forEach((function(t){if(!i.has(t.id)){var o=t.percentBounds.offset(e*n,0);i.set(t.id,o);var a=r.tiles.filter((function(e){return!e.isDragging&&!e.equalsTo(t)&&e.percentBounds.intersectWith(o)}));a.length&&r.moveHorizontal(e,a,n,i)}}))}},{key:"pushHorizontal",value:function(e,t,n,i){var r=0,o=new Map;return i||(i=0,n.forEach((function(n){var r=t>0?Math.max(0,e.right-n.percentBounds.left):Math.max(0,n.percentBounds.right-e.left);r>i&&(i=r)}))),i>0&&(r=this.calcHorizontalOverflow(t,n,i),(i-=r)>0&&(this.moveHorizontal(t,n,i,o),this.tiles.forEach((function(e){o.has(e.id)&&(e.percentBounds=o.get(e.id))})))),r}},{key:"calcVerticalOverflow",value:function(e,t,n,i){var r=this,o=0;return i=i||new Set,t.forEach((function(t){if(!i.has(t.id)){i.add(t.id);var a=t.percentBounds.offset(0,e*n),s=0,c=r.getMaxPercentHeight();a.top<0?s=-a.top:c&&a.bottom>c&&(s=a.bottom-c);var l=r.tiles.filter((function(e){return!e.isDragging&&!e.equalsTo(t)&&e.percentBounds.intersectWith(a)}));l.length&&(s+=r.calcVerticalOverflow(e,l,n,i)),s>o&&(o=s)}})),o}},{key:"moveVertical",value:function(e,t,n,i){var r=this;t.forEach((function(t){if(!i.has(t.id)){var o=t.percentBounds.offset(0,e*n);i.set(t.id,o);var a=r.tiles.filter((function(e){return!e.isDragging&&!e.equalsTo(t)&&e.percentBounds.intersectWith(o)}));a.length&&r.moveVertical(e,a,n,i)}}))}},{key:"pushVertical",value:function(e,t,n,i){var r=0,o=new Map;return i||(i=0,n.forEach((function(n){var r=t>0?Math.max(0,e.bottom-n.percentBounds.top):Math.max(0,n.percentBounds.bottom-e.top);r>i&&(i=r)}))),i>0&&(r=this.calcVerticalOverflow(t,n,i),(i-=r)>0&&(this.moveVertical(t,n,i,o),this.tiles.forEach((function(e){return o.has(e.id)&&(e.percentBounds=o.get(e.id))})))),r}},{key:"copyTiles",value:function(e,t){if(!this.clipboardService){if(!e)return;throw new Error("DejaClipboardService must be imported by your application to use the copyTiles methode of DejaTilesComponent.")}var n=this.clipboardService.get("tiles");n&&n.forEach((function(e){return e.isCutted=!1})),this.clipboardService.set("tiles",e),t?(e.forEach((function(e){return e.isCutted=!0})),this.clipboardService.set("tiles-provider",this.deleteTiles$)):this.clipboardService.set("tiles-provider",void 0)}},{key:"removeTemporaryTile",value:function(){for(var e=this.tiles.length;--e>=0;){var t=this.tiles[e];t.isTemporary&&(this.tilesDic.delete(t.id),this.tiles.splice(e,1))}}},{key:"container",set:function(e){var t=this;if(this._container=e,this._container){var n=Object(F.a)(e,"mouseleave"),i=Object(F.a)(e.ownerDocument,"mouseup"),r=Object(F.a)(e,"mouseenter");r.pipe(Object(G.a)((function(){if(t.designMode){var i=n.pipe(Object(X.a)((function(){return t.container.style.cursor=""})));return Object(F.a)(e,"mousemove").pipe(Object(q.a)(i),Object(H.a)((function(e){return!!t.container&&0===e.buttons})),Object(K.a)((function(e){return t._cursor=t.getCursorFromHtmlElement(e.pageX,e.pageY,e.target)})))}return Object(W.a)("")})),Object(q.a)(this.destroyed$)).subscribe((function(e){return t.container.style.cursor=e})),r.pipe(Object(G.a)((function(){return Object(F.a)(e,"mousedown").pipe(Object(H.a)((function(e){return 1===e.buttons})),Object(H.a)((function(e){return!t.isElementInsideDejaEditor(e.target)})),Object(K.a)((function(e){return{event:e,clickedTile:t.getTileComponentFromHTMLElement(e.target)}}))).pipe(Object(q.a)(n),Object(G.a)((function(e){var n=e.event,r=e.clickedTile,o=n.target;if(t.currentTile&&(t.currentTile.isPressed=!1),t.currentTile=r,t.currentTile){if(t.currentTile.isPressed=!0,n.ctrlKey);else if(t.currentTile.isSelected&&"move"===t._cursor||(t.selectedTiles=[t.currentTile.id]),t.designMode){var a=t._container.getBoundingClientRect();t.dragDropInfos$.next({enabled:!1,startX:n.pageX-a.left,startY:n.pageY-a.top,currentTile:t.currentTile,tiles:t.tiles.filter((function(e){return e.isSelected}))})}return i.pipe(Object(U.a)(1),Object(H.a)((function(){return!!t.currentTile})))}if(o===t.container||o.parentElement===t.container){if(1===n.buttons){var s=t._container.getBoundingClientRect();t.dragSelection$.next({startPosition:new $.E(n.pageX-s.left,n.pageY-s.top),selectedRect:new $.F})}t.currentTile&&(t.currentTile.isPressed=!1),t.selectedTiles=[]}return Object(W.a)(null)})))})),Object(H.a)((function(e){return!!e})),Object(q.a)(this.destroyed$)).subscribe((function(e){t.currentTile.isPressed&&(t.currentTile.isPressed=!1,e.ctrlKey&&(t.currentTile.isSelected=!t.currentTile.isSelected,t.selectedTiles=t.tiles.filter((function(e){return e.isSelected})).map((function(e){return e.id})))),t.designMode&&(t._cursor=t.getCursorFromHtmlElement(e.pageX,e.pageY,e.target),t.container.style.cursor=t._cursor),t.currentTile=void 0}))}},get:function(){return this._container}},{key:"tiles",set:function(e){this._tiles=e,this.tilesDic=this.tiles.reduce((function(e,t){return e.set(t.id,t)}),new Map),this.refreshTiles$.next({resetWidth:!0})},get:function(){return this._tiles||(this._tiles=new Array)}},{key:"selectedTiles",set:function(e){var t,n=new Array,i=!1,r=e.reduce((function(e,t){return e.add(t)}),new Set),o=this.selectedIds.reduce((function(e,t){return e.add(t)}),new Set);if((null===(t=this.tiles)||void 0===t?void 0:t.length)?this.tiles.forEach((function(e){r.has(e.id)!==o.has(e.id)&&(i=!0),e.isSelected=r.has(e.id),e.isSelected&&n.push(e)})):i=this.selectedIds.length>0,this.selectedIds=e,i){var a=new CustomEvent("DejaTilesAddEvent",{cancelable:!1});a.tiles=n,this.selectionChanged.next(a)}}},{key:"tileMinWidth",set:function(e){this.extractValueAndUnit("_tileMinWidth",e)}},{key:"tileMaxWidth",set:function(e){this.extractValueAndUnit("_tileMaxWidth",e)}},{key:"tileMinHeight",set:function(e){this.extractValueAndUnit("_tileMinHeight",e)}},{key:"tileMaxHeight",set:function(e){this.extractValueAndUnit("_tileMaxHeight",e)}},{key:"maxWidth",set:function(e){this.extractValueAndUnit("_maxWidth",e)}},{key:"targetBounds",get:function(){return this._targetBounds},set:function(e){this._targetBounds=e,this.selectionRect$.next(e?new $.F({height:this.getPixelSize(e.height||0),left:this.getPixelSize(e.left||0),top:this.getPixelSize(e.top||0),width:this.getPixelSize(e.width||0)}):null)}}]),n}($.s);ce.\u0275fac=function(e){return new(e||ce)(k["\u0275\u0275inject"]($.e,8))},ce.\u0275prov=k["\u0275\u0275defineInjectable"]({token:ce,factory:ce.\u0275fac}),ce.ctorParameters=function(){return[{type:$.e,decorators:[{type:k.Optional}]}]};var le=function(e){o(i,e);var t=s(i);function i(e,n,r,o){var a;u(this,i),(a=t.call(this)).changeDetectorRef=n,a.layoutProvider=r,a.control=o,a.selectionChanged=new k.EventEmitter,a.layoutChanged=new k.EventEmitter,a.layoutCompleted=new k.EventEmitter,a.contentAdding=new k.EventEmitter,a.contentRemoving=new k.EventEmitter,a.tilesAdded=new k.EventEmitter,a.tilesDeleted=new k.EventEmitter,a.contentCopied=new k.EventEmitter,a.tabIndex=0,a._models=[],a.hasFocus=!1,a.onTouchedCallback=function(){},a.onChangeCallback=function(e){},a.control&&(a.control.valueAccessor=l(a));var s=e.nativeElement;return Object(L.a)(a.layoutProvider.selectionChanged).pipe(Object(q.a)(a.destroyed$)).subscribe((function(e){return a.selectionChanged.emit(e)})),Object(L.a)(a.layoutProvider.contentAdding).pipe(Object(q.a)(a.destroyed$)).subscribe((function(e){return a.contentAdding.emit(e)})),Object(L.a)(a.layoutProvider.contentRemoving).pipe(Object(q.a)(a.destroyed$)).subscribe((function(e){return a.contentRemoving.emit(e)})),Object(L.a)(a.layoutProvider.tilesAdded).pipe(Object(q.a)(a.destroyed$)).subscribe((function(e){a.tilesAdded.emit(e),a.onChangeCallback(e.tiles)})),Object(L.a)(a.layoutProvider.tilesDeleted).pipe(Object(q.a)(a.destroyed$)).subscribe((function(e){a.tilesDeleted.emit(e),a.onChangeCallback(e.tiles)})),Object(L.a)(a.layoutProvider.layoutChanged).pipe(Object(q.a)(a.destroyed$)).subscribe((function(e){a.layoutChanged.emit(e),a.onChangeCallback(e.tiles)})),Object(L.a)(a.layoutProvider.layoutCompleted).pipe(Object(q.a)(a.destroyed$)).subscribe((function(e){return a.layoutCompleted.emit(e)})),a.keyup$=Object(F.a)(s.ownerDocument,"keyup"),Object(F.a)(window,"resize").pipe(Object(Y.a)(5),Object(q.a)(a.destroyed$)).subscribe((function(){return a.refresh({resetWidth:!0})})),a}return r(i,[{key:"writeValue",value:function(e){this._models=e||[],this.layoutProvider.tiles=this._models,this.changeDetectorRef.markForCheck()}},{key:"registerOnChange",value:function(e){this.onChangeCallback=e}},{key:"registerOnTouched",value:function(e){this.onTouchedCallback=e}},{key:"ngAfterViewInit",value:function(){this.layoutProvider.container=this.tilesContainer.nativeElement,this.refresh({resetWidth:!0})}},{key:"ngOnDestroy",value:function(){n(d(i.prototype),"ngOnDestroy",this).call(this),this.canCopy=!1,this.canCut=!1,this.canDelete=!1,this.canPaste=!1}},{key:"copySelection",value:function(){var e=this.layoutProvider.copySelection();if(null==e?void 0:e.length){var t=new CustomEvent("DejaTilesCopied",{cancelable:!0});t.tiles=e,this.contentCopied.emit(t)}}},{key:"cutSelection",value:function(){var e=this.layoutProvider.cutSelection();if(null==e?void 0:e.length){var t=new CustomEvent("DejaTilesCutted",{cancelable:!0});t.tiles=e,this.contentCopied.emit(t)}}},{key:"deleteSelection",value:function(){var e=this.layoutProvider.deleteSelection();return this.changeDetectorRef.markForCheck(),e}},{key:"paste",value:function(){var e=this.layoutProvider.paste();return this.changeDetectorRef.markForCheck(),e}},{key:"ensureVisible",value:function(e){this.layoutProvider.ensureVisible$.next(e)}},{key:"refresh",value:function(e){this.layoutProvider.refreshTiles$.next(e)}},{key:"addTiles",value:function(e){this.layoutProvider.addTiles(e)}},{key:"removeTiles",value:function(e){this.layoutProvider.removeTiles(e)}},{key:"hitTest",value:function(e,t){var n=this.tilesContainer.nativeElement.getBoundingClientRect(),i=e-n.left,r=t-n.top;return this.tiles.find((function(e){var t;return null===(t=e.pixelBounds)||void 0===t?void 0:t.containsPoint(new $.E(i,r))}))}},{key:"getFreePlace",value:function(e,t,n,i){if(!this._models||0===this._models.length)return new $.F(0,0,n,i);var r=this.tilesContainer.nativeElement.getBoundingClientRect(),o=t?t-r.top:0,a=new $.F(this.layoutProvider.getPercentSize(e?e-r.left:0),this.layoutProvider.getPercentSize(o),n,i);return this.layoutProvider.getFreePlace(a)}},{key:"moveTile",value:function(e,t){this.layoutProvider.moveTile(e,t)}},{key:"getDropContext",value:function(){var e=this;return{dragEnter:function(t,n){return e.layoutProvider.dragEnter(t,n)&&{className:"hidden"}},dragOver:function(t,n){e.layoutProvider.dragover$.next(n)},dragLeave:function(t){e.layoutProvider.dragleave$.next()}}}},{key:"onTileClosed",value:function(e){this.layoutProvider.removeTiles([e.id])}},{key:"onFocus",value:function(){this.hasFocus=!0}},{key:"onBlur",value:function(){this.hasFocus=!1}},{key:"tiles",get:function(){return this.layoutProvider.tiles}},{key:"selectionRect$",get:function(){return this.layoutProvider.selectionRect$}},{key:"tileminwidth",set:function(e){this.layoutProvider.tileMinWidth=e}},{key:"tilemaxwidth",set:function(e){this.layoutProvider.tileMaxWidth=e}},{key:"tileminheight",set:function(e){this.layoutProvider.tileMinHeight=e}},{key:"tilemaxheight",set:function(e){this.layoutProvider.tileMaxHeight=e}},{key:"maxwidth",set:function(e){this.layoutProvider.maxWidth=e}},{key:"designMode",set:function(e){this.layoutProvider.designMode=Object(j.b)(e)},get:function(){return this.layoutProvider.designMode}},{key:"models",set:function(e){this.writeValue(e)}},{key:"canDelete",set:function(e){var t=this;Object(j.b)(e)&&!this.delete$sub?this.delete$sub=this.keyup$.pipe(Object(H.a)((function(e){return t.layoutProvider.designMode&&e.code===$.A.Delete&&t.hasFocus})),Object(q.a)(this.destroyed$)).subscribe((function(){return t.layoutProvider.deleteSelection()})):this.delete$sub&&(this.delete$sub.unsubscribe(),this.delete$sub=void 0)}},{key:"canCopy",set:function(e){var t=this;Object(j.b)(e)&&!this.copy$sub?this.copy$sub=this.keyup$.pipe(Object(H.a)((function(e){return e.code===$.A.KeyC&&e.ctrlKey&&t.hasFocus})),Object(q.a)(this.destroyed$)).subscribe((function(){return t.copySelection()})):this.copy$sub&&(this.copy$sub.unsubscribe(),this.copy$sub=void 0)}},{key:"canCut",set:function(e){var t=this;Object(j.b)(e)&&!this.cut$sub?this.cut$sub=this.keyup$.pipe(Object(H.a)((function(e){return t.layoutProvider.designMode&&e.code===$.A.KeyX&&e.ctrlKey&&t.hasFocus})),Object(q.a)(this.destroyed$)).subscribe((function(){return t.cutSelection()})):this.cut$sub&&(this.cut$sub.unsubscribe(),this.cut$sub=void 0)}},{key:"canPaste",set:function(e){var t=this;Object(j.b)(e)&&!this.paste$sub?this.paste$sub=this.keyup$.pipe(Object(H.a)((function(e){return t.layoutProvider.designMode&&e.code===$.A.KeyV&&e.ctrlKey&&t.hasFocus})),Object(q.a)(this.destroyed$)).subscribe((function(){return t.paste()})):this.paste$sub&&(this.paste$sub.unsubscribe(),this.paste$sub=void 0)}},{key:"selectedTiles",set:function(e){this.layoutProvider.selectedTiles=e.map((function(e){return"string"==typeof e?e:e.id}))}}]),i}($.s);le.\u0275fac=function(e){return new(e||le)(k["\u0275\u0275directiveInject"](k.ElementRef),k["\u0275\u0275directiveInject"](k.ChangeDetectorRef),k["\u0275\u0275directiveInject"](ce),k["\u0275\u0275directiveInject"](h.NgControl,10))},le.\u0275cmp=k["\u0275\u0275defineComponent"]({type:le,selectors:[["deja-tiles"]],contentQueries:function(e,t,n){var i;1&e&&k["\u0275\u0275contentQuery"](n,ne,!0),2&e&&k["\u0275\u0275queryRefresh"](i=k["\u0275\u0275loadQuery"]())&&(t.tileTemplate=i.first)},viewQuery:function(e,t){var n;1&e&&k["\u0275\u0275staticViewQuery"](ie,!0),2&e&&k["\u0275\u0275queryRefresh"](n=k["\u0275\u0275loadQuery"]())&&(t.tilesContainer=n.first)},inputs:{tabIndex:"tabIndex",tileminwidth:"tileminwidth",tilemaxwidth:"tilemaxwidth",tileminheight:"tileminheight",tilemaxheight:"tilemaxheight",maxwidth:"maxwidth",designMode:"designMode",models:"models",canDelete:"canDelete",canCopy:"canCopy",canCut:"canCut",canPaste:"canPaste",selectedTiles:"selectedTiles"},outputs:{selectionChanged:"selectionChanged",layoutChanged:"layoutChanged",layoutCompleted:"layoutCompleted",contentAdding:"contentAdding",contentRemoving:"contentRemoving",tilesAdded:"tilesAdded",tilesDeleted:"tilesDeleted",contentCopied:"contentCopied"},features:[k["\u0275\u0275ProvidersFeature"]([ce]),k["\u0275\u0275InheritDefinitionFeature"]],decls:5,vars:8,consts:[["id","tiles",3,"deja-mouse-droppable","focus","blur"],["tilesContainer",""],[3,"id","tile","designMode","template","close",4,"ngFor","ngForOf"],["deja-tile-position","",3,"bounds"],[3,"id","tile","designMode","template","close"]],template:function(e,t){1&e&&(k["\u0275\u0275elementStart"](0,"div",0,1),k["\u0275\u0275listener"]("focus",(function(){return t.onFocus()}))("blur",(function(){return t.onBlur()})),k["\u0275\u0275template"](2,re,1,5,"deja-tile",2),k["\u0275\u0275element"](3,"div",3),k["\u0275\u0275pipe"](4,"async"),k["\u0275\u0275elementEnd"]()),2&e&&(k["\u0275\u0275classProp"]("design",t.designMode),k["\u0275\u0275property"]("deja-mouse-droppable",t.getDropContext()),k["\u0275\u0275attribute"]("tabindex",t.tabIndex),k["\u0275\u0275advance"](2),k["\u0275\u0275property"]("ngForOf",t.tiles),k["\u0275\u0275advance"](1),k["\u0275\u0275property"]("bounds",k["\u0275\u0275pipeBind1"](4,6,t.selectionRect$)))},directives:[y.d,c.m,oe,se],pipes:[c.b],styles:["[_nghost-%COMP%]{margin:0!important;overflow:auto;position:relative}[_nghost-%COMP%]   #tiles[_ngcontent-%COMP%]{display:block;height:100%;left:0;margin:0!important;padding:0!important;position:absolute;top:0;width:100%}[_nghost-%COMP%]   #tiles.design[_ngcontent-%COMP%]   deja-tile[_ngcontent-%COMP%]{background-color:rgba(0,0,0,.1)}[_nghost-%COMP%]   #tiles[_ngcontent-%COMP%]   #tile[_ngcontent-%COMP%]:hover{z-index:200}[_nghost-%COMP%]   [deja-tile-position][_ngcontent-%COMP%]{position:absolute;z-index:101}[_nghost-%COMP%]   [deja-tile-position][_ngcontent-%COMP%], [drag][_nghost-%COMP%]{background-color:rgba(0,0,0,.5)}[drag][_nghost-%COMP%]   [deja-tile-position][_ngcontent-%COMP%]{transition-duration:.35s;transition-property:left,top,width,height;transition-timing-function:ease}"],changeDetection:0}),le.ctorParameters=function(){return[{type:k.ElementRef},{type:k.ChangeDetectorRef},{type:ce},{type:h.NgControl,decorators:[{type:k.Self},{type:k.Optional}]}]},le.propDecorators={selectionChanged:[{type:k.Output}],layoutChanged:[{type:k.Output}],layoutCompleted:[{type:k.Output}],contentAdding:[{type:k.Output}],contentRemoving:[{type:k.Output}],tilesAdded:[{type:k.Output}],tilesDeleted:[{type:k.Output}],contentCopied:[{type:k.Output}],tabIndex:[{type:k.Input}],tileTemplate:[{type:k.ContentChild,args:["tileTemplate"]}],tilesContainer:[{type:k.ViewChild,args:["tilesContainer",{static:!0}]}],tileminwidth:[{type:k.Input}],tilemaxwidth:[{type:k.Input}],tileminheight:[{type:k.Input}],tilemaxheight:[{type:k.Input}],maxwidth:[{type:k.Input}],designMode:[{type:k.Input}],models:[{type:k.Input}],canDelete:[{type:k.Input}],canCopy:[{type:k.Input}],canCut:[{type:k.Input}],canPaste:[{type:k.Input}],selectedTiles:[{type:k.Input}]};var de=function e(){u(this,e)};de.\u0275mod=k["\u0275\u0275defineNgModule"]({type:de}),de.\u0275inj=k["\u0275\u0275defineInjector"]({factory:function(e){return new(e||de)},imports:[[c.c,h.FormsModule,y.b,D]]});var ue=a("KYkd"),he=a("iInd"),pe=a("Kqap"),fe=a("xbPD"),ge=a("1XgV"),me=a("iss+");function ve(e,t){1&e&&(k["\u0275\u0275elementStart"](0,"mat-card",5),k["\u0275\u0275element"](1,"deja-markdown",6),k["\u0275\u0275elementEnd"]()),2&e&&(k["\u0275\u0275advance"](1),k["\u0275\u0275property"]("url","https://raw.githubusercontent.com/DSI-HUG/dejajs-components/develop/projects/deja-js/component/tiles/readme.txt"))}function be(e,t){if(1&e){var n=k["\u0275\u0275getCurrentView"]();k["\u0275\u0275elementStart"](0,"button",11),k["\u0275\u0275listener"]("click",(function(){return k["\u0275\u0275restoreView"](n),k["\u0275\u0275nextContext"](2).$implicit.cancel(!1)})),k["\u0275\u0275text"](1," Ok "),k["\u0275\u0275elementEnd"](),k["\u0275\u0275elementStart"](2,"button",12),k["\u0275\u0275listener"]("click",(function(){return k["\u0275\u0275restoreView"](n),k["\u0275\u0275nextContext"](2).$implicit.cancel(!0)})),k["\u0275\u0275text"](3," Annuler "),k["\u0275\u0275elementEnd"]()}}function ye(e,t){if(1&e){var n=k["\u0275\u0275getCurrentView"]();k["\u0275\u0275elementStart"](0,"deja-snackbar",8),k["\u0275\u0275listener"]("onAnimationDone",(function(){return k["\u0275\u0275restoreView"](n),k["\u0275\u0275nextContext"]().$implicit.cancel(!1)})),k["\u0275\u0275elementStart"](1,"deja-message-box",9),k["\u0275\u0275text"](2),k["\u0275\u0275template"](3,be,4,0,"ng-template",null,10,k["\u0275\u0275templateRefExtractor"]),k["\u0275\u0275elementEnd"](),k["\u0275\u0275elementEnd"]()}if(2&e){var i=k["\u0275\u0275nextContext"]().$implicit;k["\u0275\u0275property"]("duration",8e3),k["\u0275\u0275advance"](1),k["\u0275\u0275property"]("type",i.type)("title",i.title),k["\u0275\u0275advance"](1),k["\u0275\u0275textInterpolate1"](" ",i.content," ")}}function xe(e,t){1&e&&k["\u0275\u0275template"](0,ye,5,4,"deja-snackbar",7),2&e&&k["\u0275\u0275property"]("ngIf",t.$implicit.gate)}function ke(e,t){if(1&e&&(k["\u0275\u0275elementStart"](0,"div",23),k["\u0275\u0275text"](1),k["\u0275\u0275elementStart"](2,"span",24),k["\u0275\u0275text"](3,"Selected"),k["\u0275\u0275elementEnd"](),k["\u0275\u0275elementStart"](4,"span",25),k["\u0275\u0275text"](5,"Pressed"),k["\u0275\u0275elementEnd"](),k["\u0275\u0275elementEnd"]()),2&e){var n=t.$implicit;k["\u0275\u0275styleProp"]("background-color",n.color),k["\u0275\u0275advance"](1),k["\u0275\u0275textInterpolate2"]("",n.templateModel.naqme," (",n.templateModel.code,") ")}}function we(e,t){if(1&e&&(k["\u0275\u0275elementStart"](0,"div",23),k["\u0275\u0275text"](1),k["\u0275\u0275elementStart"](2,"span",24),k["\u0275\u0275text"](3,"Selected"),k["\u0275\u0275elementEnd"](),k["\u0275\u0275elementStart"](4,"span",25),k["\u0275\u0275text"](5,"Pressed"),k["\u0275\u0275elementEnd"](),k["\u0275\u0275elementEnd"]()),2&e){var n=t.$implicit;k["\u0275\u0275styleProp"]("background-color",n.color),k["\u0275\u0275advance"](1),k["\u0275\u0275textInterpolate2"]("",n.templateModel.naqme," (",n.templateModel.code,") ")}}function je(e,t){if(1&e){var n=k["\u0275\u0275getCurrentView"]();k["\u0275\u0275elementStart"](0,"mat-card",5),k["\u0275\u0275elementStart"](1,"mat-toolbar",13),k["\u0275\u0275text"](2,"Tiles Demo"),k["\u0275\u0275elementEnd"](),k["\u0275\u0275elementStart"](3,"mat-card-content",14),k["\u0275\u0275elementStart"](4,"mat-checkbox",15),k["\u0275\u0275listener"]("ngModelChange",(function(e){return k["\u0275\u0275restoreView"](n),k["\u0275\u0275nextContext"]().designMode=e})),k["\u0275\u0275text"](5,"Design Mode"),k["\u0275\u0275elementEnd"](),k["\u0275\u0275elementEnd"](),k["\u0275\u0275elementStart"](6,"mat-card-content"),k["\u0275\u0275elementStart"](7,"span",16,17),k["\u0275\u0275text"](9," Drop Area "),k["\u0275\u0275elementEnd"](),k["\u0275\u0275elementEnd"](),k["\u0275\u0275elementStart"](10,"mat-card-content"),k["\u0275\u0275elementStart"](11,"deja-tiles",18,19),k["\u0275\u0275listener"]("contentAdding",(function(e){return k["\u0275\u0275restoreView"](n),k["\u0275\u0275nextContext"]().onContentAdding(e)}))("contentRemoving",(function(e){return k["\u0275\u0275restoreView"](n),k["\u0275\u0275nextContext"]().onContentRemoving(e)})),k["\u0275\u0275pipe"](13,"async"),k["\u0275\u0275template"](14,ke,6,4,"ng-template",null,20,k["\u0275\u0275templateRefExtractor"]),k["\u0275\u0275elementEnd"](),k["\u0275\u0275elementEnd"](),k["\u0275\u0275elementStart"](16,"mat-card-content"),k["\u0275\u0275elementStart"](17,"deja-tiles",21,22),k["\u0275\u0275listener"]("contentAdding",(function(e){return k["\u0275\u0275restoreView"](n),k["\u0275\u0275nextContext"]().onContentAdding(e)}))("contentRemoving",(function(e){return k["\u0275\u0275restoreView"](n),k["\u0275\u0275nextContext"]().onContentRemoving(e)})),k["\u0275\u0275pipe"](19,"async"),k["\u0275\u0275template"](20,we,6,4,"ng-template",null,20,k["\u0275\u0275templateRefExtractor"]),k["\u0275\u0275elementEnd"](),k["\u0275\u0275elementEnd"](),k["\u0275\u0275elementEnd"]()}if(2&e){var i=k["\u0275\u0275reference"](8),r=k["\u0275\u0275nextContext"]();k["\u0275\u0275advance"](4),k["\u0275\u0275property"]("ngModel",r.designMode),k["\u0275\u0275advance"](3),k["\u0275\u0275property"]("deja-mouse-droppable",r.getDropContext(i)),k["\u0275\u0275advance"](4),k["\u0275\u0275property"]("models",k["\u0275\u0275pipeBind1"](13,6,r.tiles1$))("deja-mouse-draggable",r.getDragContext()),k["\u0275\u0275advance"](6),k["\u0275\u0275property"]("models",k["\u0275\u0275pipeBind1"](19,8,r.tiles2$))("designMode",r.designMode)}}var Me,Oe,_e=he.f.forChild([{path:"",component:(Me=function(){function t(n){u(this,t),this.countriesService=n,this.tabIndex=1,this.designMode=!1,this.message$=new z.a,this.messages$=Object(L.a)(this.message$).pipe(Object(pe.a)((function(t,n){return[].concat(e(t),[n])}),[]),Object(fe.a)([]))}return r(t,[{key:"ngOnInit",value:function(){var t=this,n=0,i=0,r=0,o=0;this.countriesMap=new Map;var a=this.countriesService.getCountries$().pipe(Object(G.a)((function(e){return e})));this.tiles1$=a.pipe(Object(U.a)(12),Object(K.a)((function(e){var r=new ae;return r.percentBounds=new $.F(n,i,15,15),r.color=e.color,r.templateModel=e,(n+=15)+15>100&&(n=0,i+=15),t.countriesMap.set(r.id,e),r})),Object(J.a)((function(t,n){return[].concat(e(t),[n])}),[])),this.tiles2$=a.pipe(Object(K.a)((function(e){var t=new ae;return t.percentBounds=new $.F(r,o,15,15),t.color=e.color,t.templateModel=e,(r+=15)+15>100&&(r=0,o+=15),t})),Object(J.a)((function(t,n){return[].concat(e(t),[n])}),[]))}},{key:"getDragContext",value:function(){var e=this;return{target:"deja-tile",className:"deja-tile-cursor",dragStart:function(t){var n=e.countriesMap.get(t.id),i=new ae;return i.percentBounds=new $.F(0,0,15,15),i.color=n.color,i.templateModel=n,{country:n,DejaTile:i}}}}},{key:"getDropContext",value:function(e){return{dragEnter:function(e){return{width:200,height:60,className:"country-target-cursor"}},drop:function(t){var n=t.country;e.innerText="The dropped country is ".concat(n.naqme," - the code is: ").concat(n.code)}}}},{key:"onContentAdding",value:function(e){this.message$.next({title:"Tiles added",content:"".concat(e.added.length," tiles added."),type:"warn",gate:!0,cancel:function(t){this.gate=!1,e.cancel$.next(t)}}),e.preventDefault()}},{key:"onContentRemoving",value:function(e){this.message$.next({title:"Tiles deleted",content:"".concat(e.removed.length," tiles deleted."),type:"warn",gate:!0,cancel:function(t){this.gate=!1,e.cancel$.next(t)}}),e.preventDefault()}}]),t}(),Me.\u0275fac=function(e){return new(e||Me)(k["\u0275\u0275directiveInject"](ge.a))},Me.\u0275cmp=k["\u0275\u0275defineComponent"]({type:Me,selectors:[["deja-tiles-demo"]],decls:8,vars:6,consts:[[3,"selectedIndex","selectedTabChange"],["label","API REFERENCE"],["label","EXAMPLES"],["class","demo-card demo-basic",4,"ngIf"],["ngFor","",3,"ngForOf"],[1,"demo-card","demo-basic"],[3,"url"],["alignment","bottom right",3,"duration","onAnimationDone",4,"ngIf"],["alignment","bottom right",3,"duration","onAnimationDone"],[3,"type","title"],["actionsTemplate",""],["mat-raised-button","","color","primary",3,"click"],["mat-raised-button","",3,"click"],["color","primary"],["id","actions"],[3,"ngModel","ngModelChange"],["id","droparea",3,"deja-mouse-droppable"],["dropArea",""],["id","tiles1","maxwidth","100%","tileminwidth","5%","tileminheight","5%","tilemaxheight","50%","tilemaxwidth","50%",3,"models","deja-mouse-draggable","contentAdding","contentRemoving"],["tiles1",""],["tileTemplate",""],["id","tiles2","canDelete","","canCopy","","canCut","","canPaste","","maxwidth","100%","tileminwidth","5%","tileminheight","5%","tilemaxheight","50%","tilemaxwidth","50%",3,"models","designMode","contentAdding","contentRemoving"],["tiles2",""],[1,"tile-content","noselect"],["id","selected"],["id","pressed"]],template:function(e,t){1&e&&(k["\u0275\u0275elementStart"](0,"mat-tab-group",0),k["\u0275\u0275listener"]("selectedTabChange",(function(e){return t.tabIndex=e.index})),k["\u0275\u0275element"](1,"mat-tab",1),k["\u0275\u0275element"](2,"mat-tab",2),k["\u0275\u0275elementEnd"](),k["\u0275\u0275template"](3,ve,2,1,"mat-card",3),k["\u0275\u0275template"](4,xe,1,1,"ng-template",4),k["\u0275\u0275pipe"](5,"async"),k["\u0275\u0275template"](6,je,22,10,"mat-card",3),k["\u0275\u0275element"](7,"deja-mouse-dragdrop-cursor")),2&e&&(k["\u0275\u0275property"]("selectedIndex",t.tabIndex),k["\u0275\u0275advance"](3),k["\u0275\u0275property"]("ngIf",0===t.tabIndex),k["\u0275\u0275advance"](1),k["\u0275\u0275property"]("ngForOf",k["\u0275\u0275pipeBind1"](5,4,t.messages$)),k["\u0275\u0275advance"](2),k["\u0275\u0275property"]("ngIf",1===t.tabIndex))},directives:[m.b,m.a,c.n,c.m,y.a,f.a,me.a,x.a,b.a,p.b,v.a,f.c,g.a,h.NgControlStatus,h.NgModel,y.d,le,y.c],pipes:[c.b],styles:["deja-tiles-demo .demo-basic{padding:0}deja-tiles-demo .demo-full-width{width:100%}deja-tiles-demo .demo-icons{font-size:100%;height:inherit;vertical-align:top;width:inherit}deja-tiles-demo .demo-card{margin:16px}deja-tiles-demo .demo-card mat-card-content{display:flex;flex-direction:column;margin:2rem}deja-tiles-demo #actions{display:flex;flex-direction:row;align-items:center;justify-content:space-between}deja-tiles-demo #droparea{height:5rem;background-color:#f57c00;width:50%;display:block}deja-tiles-demo #tiles1{height:370px;display:block}deja-tiles-demo #tiles2{height:1000px;display:block}deja-tiles-demo deja-tile{-webkit-user-select:none;-moz-user-select:none;user-select:none}deja-tiles-demo deja-tile #pressed,deja-tiles-demo deja-tile #selected{display:none}deja-tiles-demo deja-tile[pressed] #pressed,deja-tiles-demo deja-tile[selected] #selected{display:block}deja-tiles-demo deja-tile .tile-content{width:100%;height:100%;display:block}@media screen and (min-width:1401px){deja-tiles-demo deja-tiles{font-size:100%}}@media screen and (max-width:1400px){deja-tiles-demo deja-tiles{font-size:90%}}@media screen and (max-width:1200px){deja-tiles-demo deja-tiles{font-size:85%}}@media screen and (max-width:768px){deja-tiles-demo deja-tiles{font-size:80%}}@media screen and (max-width:640px){deja-tiles-demo deja-tiles{font-size:70%}}@media screen and (max-width:320px){deja-tiles-demo deja-tiles{font-size:60%}}.country-target-cursor .tile-content,.deja-tile-cursor .tile-content{width:100%;height:100%;display:block;opacity:.8}.country-target-cursor .tile-content{background-color:#f4a460!important}"],encapsulation:2}),Me)},{path:"**",redirectTo:"",pathMatch:"full"}]),Pe=((Oe=function e(){u(this,e)}).\u0275mod=k["\u0275\u0275defineNgModule"]({type:Oe}),Oe.\u0275inj=k["\u0275\u0275defineInjector"]({factory:function(e){return new(e||Oe)},providers:[],imports:[[c.c,h.FormsModule,f.d,m.c,v.b,p.c,g.b,de,ue.a,x.b,y.b,b.b,_e]]}),Oe)}}])}();