"use strict";(self.webpackChunkdejajs_component=self.webpackChunkdejajs_component||[]).push([[519],{5517:(me,ie,p)=>{p.d(ie,{c:()=>J,K:()=>oe});var D=p(6563),E=p(4753),se=p(2997),X=p(7038),Z=p(3668),Y=p(4522),ne=p(6420);class J{constructor(){this.displayName=void 0,this.naqme=void 0,this.code=void 0,this.color=void 0}}let oe=(()=>{class i{constructor(v,A){this.httpClient=v,this.countriesDic={},this.materialColors=A.getPalet("700")}getCountryByIndex$(v){return this.getCountries$().pipe((0,E.U)(A=>A[v%A.length]))}getCountryByCode$(v){return(0,se.of)(this.countriesDic[v])}getCountries$(v,A){let K=A||0;return this.httpClient.get("assets/datas/countries.json",{}).pipe((0,E.U)($=>D.cV.deserializeArray(J,$.data)),(0,E.U)($=>{let k=0;return $.forEach(O=>{O.displayName=O.naqme,O.color=this.materialColors[k].toHex(),this.countriesDic[O.code]=O,++k>=this.materialColors.length&&(k=0)}),$}),(0,X.d)({bufferSize:1,refCount:!1}),(0,E.U)($=>{if(v){const k=new RegExp(`^${v}`,"i"),O=new RegExp(`^(?!${v}).*(${v})`,"i"),ae=$.filter(G=>k.test(G.naqme));return $.forEach(G=>{O.test(G.naqme)&&ae.push(G)}),ae}return $}),(0,E.U)($=>{let k=$;if(K)for(;K>0;)k=k.concat($),K-=$.length;return k}))}}return i.\u0275fac=function(v){return new(v||i)(Z.LFG(Y.eN),Z.LFG(ne.ZD))},i.\u0275prov=Z.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})()},6519:(me,ie,p)=>{p.r(ie),p.d(ie,{DejaTilesDemoModule:()=>Ye});var D=p(6019),E=p(9133),se=p(86),X=p(888),Z=p(904),Y=p(2605),ne=p(8643),J=p(4272),oe=p(3348),i=p(3668),Q=p(6731),v=p(348),A=p(928),K=p(9555);function $(l,u){if(1&l&&(i.O4$(),i._UZ(0,"circle",3)),2&l){const e=i.oxw();i.Udp("animation-name","mat-progress-spinner-stroke-rotate-"+e._spinnerAnimationLabel)("stroke-dashoffset",e._getStrokeDashOffset(),"px")("stroke-dasharray",e._getStrokeCircumference(),"px")("stroke-width",e._getCircleStrokeWidth(),"%"),i.uIk("r",e._getCircleRadius())}}function k(l,u){if(1&l&&(i.O4$(),i._UZ(0,"circle",3)),2&l){const e=i.oxw();i.Udp("stroke-dashoffset",e._getStrokeDashOffset(),"px")("stroke-dasharray",e._getStrokeCircumference(),"px")("stroke-width",e._getCircleStrokeWidth(),"%"),i.uIk("r",e._getCircleRadius())}}const pe=(0,Q.pj)(class{constructor(l){this._elementRef=l}},"primary"),fe=new i.OlP("mat-progress-spinner-default-options",{providedIn:"root",factory:function(){return{diameter:100}}});class j extends pe{constructor(u,e,t,n,s){super(u),this._document=t,this._diameter=100,this._value=0,this.mode="determinate";const o=j._diameters;this._spinnerAnimationLabel=this._getSpinnerAnimationLabel(),o.has(t.head)||o.set(t.head,new Set([100])),this._noopAnimations="NoopAnimations"===n&&!!s&&!s._forceAnimations,s&&(s.diameter&&(this.diameter=s.diameter),s.strokeWidth&&(this.strokeWidth=s.strokeWidth))}get diameter(){return this._diameter}set diameter(u){this._diameter=(0,v.su)(u),this._spinnerAnimationLabel=this._getSpinnerAnimationLabel(),this._styleRoot&&this._attachStyleNode()}get strokeWidth(){return this._strokeWidth||this.diameter/10}set strokeWidth(u){this._strokeWidth=(0,v.su)(u)}get value(){return"determinate"===this.mode?this._value:0}set value(u){this._value=Math.max(0,Math.min(100,(0,v.su)(u)))}ngOnInit(){const u=this._elementRef.nativeElement;this._styleRoot=(0,A.kV)(u)||this._document.head,this._attachStyleNode(),u.classList.add("mat-progress-spinner-indeterminate-animation")}_getCircleRadius(){return(this.diameter-10)/2}_getViewBox(){const u=2*this._getCircleRadius()+this.strokeWidth;return`0 0 ${u} ${u}`}_getStrokeCircumference(){return 2*Math.PI*this._getCircleRadius()}_getStrokeDashOffset(){return"determinate"===this.mode?this._getStrokeCircumference()*(100-this._value)/100:null}_getCircleStrokeWidth(){return this.strokeWidth/this.diameter*100}_attachStyleNode(){const u=this._styleRoot,e=this._diameter,t=j._diameters;let n=t.get(u);if(!n||!n.has(e)){const s=this._document.createElement("style");s.setAttribute("mat-spinner-animation",this._spinnerAnimationLabel),s.textContent=this._getAnimationText(),u.appendChild(s),n||(n=new Set,t.set(u,n)),n.add(e)}}_getAnimationText(){const u=this._getStrokeCircumference();return"\n @keyframes mat-progress-spinner-stroke-rotate-DIAMETER {\n    0%      { stroke-dashoffset: START_VALUE;  transform: rotate(0); }\n    12.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(0); }\n    12.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(72.5deg); }\n    25%     { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(72.5deg); }\n\n    25.0001%   { stroke-dashoffset: START_VALUE;  transform: rotate(270deg); }\n    37.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(270deg); }\n    37.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(161.5deg); }\n    50%     { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(161.5deg); }\n\n    50.0001%  { stroke-dashoffset: START_VALUE;  transform: rotate(180deg); }\n    62.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(180deg); }\n    62.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(251.5deg); }\n    75%     { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(251.5deg); }\n\n    75.0001%  { stroke-dashoffset: START_VALUE;  transform: rotate(90deg); }\n    87.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(90deg); }\n    87.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(341.5deg); }\n    100%    { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(341.5deg); }\n  }\n".replace(/START_VALUE/g,""+.95*u).replace(/END_VALUE/g,""+.2*u).replace(/DIAMETER/g,`${this._spinnerAnimationLabel}`)}_getSpinnerAnimationLabel(){return this.diameter.toString().replace(".","_")}}j._diameters=new WeakMap,j.\u0275fac=function(u){return new(u||j)(i.Y36(i.SBq),i.Y36(A.t4),i.Y36(D.K0,8),i.Y36(K.Qb,8),i.Y36(fe))},j.\u0275cmp=i.Xpm({type:j,selectors:[["mat-progress-spinner"]],hostAttrs:["role","progressbar","tabindex","-1",1,"mat-progress-spinner"],hostVars:10,hostBindings:function(u,e){2&u&&(i.uIk("aria-valuemin","determinate"===e.mode?0:null)("aria-valuemax","determinate"===e.mode?100:null)("aria-valuenow","determinate"===e.mode?e.value:null)("mode",e.mode),i.Udp("width",e.diameter,"px")("height",e.diameter,"px"),i.ekj("_mat-animation-noopable",e._noopAnimations))},inputs:{color:"color",diameter:"diameter",strokeWidth:"strokeWidth",mode:"mode",value:"value"},exportAs:["matProgressSpinner"],features:[i.qOj],decls:3,vars:8,consts:[["preserveAspectRatio","xMidYMid meet","focusable","false","aria-hidden","true",3,"ngSwitch"],["cx","50%","cy","50%",3,"animation-name","stroke-dashoffset","stroke-dasharray","stroke-width",4,"ngSwitchCase"],["cx","50%","cy","50%",3,"stroke-dashoffset","stroke-dasharray","stroke-width",4,"ngSwitchCase"],["cx","50%","cy","50%"]],template:function(u,e){1&u&&(i.O4$(),i.TgZ(0,"svg",0),i.YNc(1,$,1,9,"circle",1),i.YNc(2,k,1,7,"circle",2),i.qZA()),2&u&&(i.Udp("width",e.diameter,"px")("height",e.diameter,"px"),i.Q6J("ngSwitch","indeterminate"===e.mode),i.uIk("viewBox",e._getViewBox()),i.xp6(1),i.Q6J("ngSwitchCase",!0),i.xp6(1),i.Q6J("ngSwitchCase",!1))},directives:[D.RF,D.n9],styles:[".mat-progress-spinner{display:block;position:relative;overflow:hidden}.mat-progress-spinner svg{position:absolute;transform:rotate(-90deg);top:0;left:0;transform-origin:center;overflow:visible}.mat-progress-spinner circle{fill:transparent;transform-origin:center;transition:stroke-dashoffset 225ms linear}._mat-animation-noopable.mat-progress-spinner circle{transition:none;animation:none}.cdk-high-contrast-active .mat-progress-spinner circle{stroke:CanvasText}.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate] svg{animation:mat-progress-spinner-linear-rotate 2000ms linear infinite}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate] svg{transition:none;animation:none}.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate] circle{transition-property:stroke;animation-duration:4000ms;animation-timing-function:cubic-bezier(0.35, 0, 0.25, 1);animation-iteration-count:infinite}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate] circle{transition:none;animation:none}@keyframes mat-progress-spinner-linear-rotate{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes mat-progress-spinner-stroke-rotate-100{0%{stroke-dashoffset:268.606171575px;transform:rotate(0)}12.5%{stroke-dashoffset:56.5486677px;transform:rotate(0)}12.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(72.5deg)}25%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(72.5deg)}25.0001%{stroke-dashoffset:268.606171575px;transform:rotate(270deg)}37.5%{stroke-dashoffset:56.5486677px;transform:rotate(270deg)}37.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(161.5deg)}50%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(161.5deg)}50.0001%{stroke-dashoffset:268.606171575px;transform:rotate(180deg)}62.5%{stroke-dashoffset:56.5486677px;transform:rotate(180deg)}62.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(251.5deg)}75%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(251.5deg)}75.0001%{stroke-dashoffset:268.606171575px;transform:rotate(90deg)}87.5%{stroke-dashoffset:56.5486677px;transform:rotate(90deg)}87.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(341.5deg)}100%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(341.5deg)}}\n"],encapsulation:2,changeDetection:0});let ye=(()=>{class l{}return l.\u0275fac=function(e){return new(e||l)},l.\u0275mod=i.oAB({type:l}),l.\u0275inj=i.cJS({imports:[[Q.BQ,D.ez],Q.BQ]}),l})();var V=p(7020),L=p(1574),T=p(461),z=p(9468),b=p(7384),q=p(8660),x=p(6263),ee=p(9463),M=p(273),W=p(4499),N=p(4753),re=p(5933),H=p(3067),S=p(5077),he=p(2997),R=p(7867),de=p(6302),Te=p(9417),ve=p(559),c=p(6420);function Me(l,u){}function be(l,u){if(1&l&&i._UZ(0,"mat-progress-spinner",2),2&l){const e=i.oxw();i.Q6J("diameter",e.progressDiameter)}}const we=function(l){return{$implicit:l}},Ce=["tileTemplate"],De=["tilesContainer"];function Pe(l,u){if(1&l){const e=i.EpF();i.TgZ(0,"deja-tile",4),i.NdJ("close",function(){const s=i.CHM(e).$implicit;return i.oxw().onTileClosed(s)}),i.qZA()}if(2&l){const e=u.$implicit,t=u.index,n=i.oxw();i.Q6J("id",e.id)("tile",e)("template",n.tileTemplate),i.uIk("tile-index",t)}}let $e=(()=>{class l extends L.yl{constructor(e,t){super(),this.changeDetectorRef=t,this.close=new i.vpe,this.progressDiameter=100,this.element=e.nativeElement,this.element.setAttribute("hidden","0")}set tile(e){if(this._tile=e,e){const t=(s,o)=>{o?this.element.setAttribute(s,o.toString()):this.element.removeAttribute(s)};e.fading&&(this.element.setAttribute("fading","0"),this.changeDetectorRef.markForCheck()),e.pixelBounds$.pipe((0,T.h)(s=>!!s),(0,z.q)(1),(0,T.h)(()=>e.fading),(0,b.b)(()=>{this.element.setAttribute("fading","1"),this.changeDetectorRef.markForCheck()}),(0,q.g)(200),(0,x.R)(this.destroyed$)).subscribe(()=>{this.element.removeAttribute("fading"),this.changeDetectorRef.markForCheck()}),e.pixelBounds$.pipe((0,T.h)(s=>!!s),(0,x.R)(this.destroyed$)).subscribe(s=>{e.isHidden||this.element.removeAttribute("hidden"),this.element.style.left=`${s.left}px`,this.element.style.top=`${s.top}px`,this.element.style.width=`${s.width}px`,this.element.style.height=`${s.height}px`,this.progressDiameter=Math.min(100,Math.round(Math.max(.4*s.width,.4*s.height))),this.changeDetectorRef.markForCheck()}),e.pressed$.pipe((0,b.b)(s=>t("pressed",s)),(0,x.R)(this.destroyed$)).subscribe(()=>this.changeDetectorRef.markForCheck()),e.selected$.pipe((0,b.b)(s=>t("selected",s)),(0,x.R)(this.destroyed$)).subscribe(()=>this.changeDetectorRef.markForCheck()),e.dragging$.pipe((0,b.b)(s=>t("drag",s)),(0,x.R)(this.destroyed$)).subscribe(()=>this.changeDetectorRef.markForCheck()),e.dropping$.pipe((0,b.b)(s=>t("drop",s)),(0,x.R)(this.destroyed$)).subscribe(()=>this.changeDetectorRef.markForCheck()),e.cutted$.pipe((0,b.b)(s=>t("cutted",s)),(0,x.R)(this.destroyed$)).subscribe(()=>this.changeDetectorRef.markForCheck()),e.deleted$.pipe((0,b.b)(()=>this.element.remove()),(0,x.R)(this.destroyed$)).subscribe(()=>this.changeDetectorRef.markForCheck());const n=e.hidden$.pipe((0,b.b)(s=>t("hidden",s?"1":"2")));n.pipe((0,ee.b)(1e3),(0,T.h)(s=>s),(0,b.b)(()=>this.element.setAttribute("hidden","0")),(0,x.R)(this.destroyed$)).subscribe(()=>this.changeDetectorRef.markForCheck()),n.pipe((0,ee.b)(1),(0,T.h)(s=>!s),(0,b.b)(()=>this.element.removeAttribute("hidden")),(0,x.R)(this.destroyed$)).subscribe(()=>this.changeDetectorRef.markForCheck()),e.refresh$.pipe((0,ee.b)(1),(0,x.R)(this.destroyed$)).subscribe(()=>this.changeDetectorRef.markForCheck())}}get tile(){return this._tile}}return l.\u0275fac=function(e){return new(e||l)(i.Y36(i.SBq),i.Y36(i.sBO))},l.\u0275cmp=i.Xpm({type:l,selectors:[["deja-tile"]],inputs:{template:"template",tile:"tile"},outputs:{close:"close"},features:[i.qOj],decls:2,vars:5,consts:[[3,"ngTemplateOutlet","ngTemplateOutletContext"],["mode","indeterminate","class","accent",3,"diameter",4,"ngIf"],["mode","indeterminate",1,"accent",3,"diameter"]],template:function(e,t){1&e&&(i.YNc(0,Me,0,0,"ng-template",0),i.YNc(1,be,1,1,"mat-progress-spinner",1)),2&e&&(i.Q6J("ngTemplateOutlet",t.template)("ngTemplateOutletContext",i.VKq(3,we,t.tile)),i.xp6(1),i.Q6J("ngIf",t.tile&&t.tile.isPending))},directives:[D.tP,D.O5,j],styles:['[_nghost-%COMP%]{display:block;position:absolute;transition-property:left,top,opacity;transition-duration:.5s;transition-timing-function:ease;opacity:1}[expanded][_nghost-%COMP%]{transition-property:height}[cutted][_nghost-%COMP%]{opacity:.5}[drag][_nghost-%COMP%], [drop][_nghost-%COMP%]{z-index:100}[drag][_nghost-%COMP%]{opacity:.5;-webkit-user-select:none;-moz-user-select:none;user-select:none;transition:none}[fading="0"][_nghost-%COMP%]{opacity:0;transition:none}[fading="1"][_nghost-%COMP%]{opacity:0}[hidden="0"][_nghost-%COMP%]{visibility:hidden;transition:none}[hidden="1"][_nghost-%COMP%]{opacity:0;transition:1s ease-in-out opacity}[hidden="2"][_nghost-%COMP%]{visibility:visible;opacity:0;transition:none}[_nghost-%COMP%]   mat-progress-spinner[_ngcontent-%COMP%]{position:absolute;z-index:1;right:.2rem;bottom:.2rem;transform:translate(-60%,-60%)}'],changeDetection:0}),l})(),Se=(()=>{class l{constructor(e){this.element=e.nativeElement,this.element.style.display="none"}set bounds(e){if(e){const{left:t,top:n,width:s,height:o}=e;this.element.style.left=`${t}px`,this.element.style.top=`${n}px`,this.element.style.width=`${s}px`,this.element.style.height=`${o}px`,this.element.style.display="block"}else this.element.style.display="none"}}return l.\u0275fac=function(e){return new(e||l)(i.Y36(i.SBq))},l.\u0275dir=i.lG2({type:l,selectors:[["","deja-tile-position",""]],inputs:{bounds:"bounds"}}),l})(),ge=(()=>{class l extends L.yl{constructor(e){super(),this.clipboardService=e,this.refreshTiles$=new M.x,this.ensureVisible$=new M.x,this.ensureBounds$=new M.x,this.dragging$=new W.X(!1),this.dragSelection$=new M.x,this.dragDropInfos$=new M.x,this.selectionRect$=new M.x,this.dragover$=new M.x,this.dragleave$=new M.x,this.deleteTiles$=new M.x,this.designMode=!1,this.layoutCompleted=new M.x,this.layoutChanged=new M.x,this.tilesAdded=new M.x,this.tilesDeleted=new M.x,this.selectionChanged=new M.x,this.contentAdding=new M.x,this.contentRemoving=new M.x,this._tileMinWidth=10,this._tileMinWidthUnit="%",this._tileMaxWidth=100,this._tileMaxWidthUnit="%",this._tileMinHeight=10,this._tileMinHeightUnit="%",this._tileMaxHeight=100,this._tileMaxHeightUnit="%",this._maxWidth=100,this._maxWidthUnit="%",this.tilesDic=new Map,this._targetBounds=new c.UL,this.destination=new c.UL,this.dragPageOffset=new c.Ly,this.dragOriginalPosition=new c.Ly,this.selectedIds=new Array,this.refreshTiles$.pipe((0,ee.b)(30),(0,b.b)(()=>{this.container.style.width="",this.container.style.height=""}),(0,q.g)(10),(0,x.R)(this.destroyed$)).subscribe(s=>{const o=new Array,a=this.container.getBoundingClientRect();((null==s?void 0:s.resetWidth)||!this.hundredPercentWith)&&(this.hundredPercentWith=a.width);let r=a.height,h=a.width,g=0,d=0;const f=this.tiles||new Array,m=new Array;f.forEach(_=>{if(_.percentBounds&&!_.percentBounds.isEmpty()){const C=this.getPixelBounds(_.percentBounds);C.bottom>g&&(g=C.right),C.right>d&&(d=C.bottom),_.isDragging||(_.pixelBounds=C)}else o.push(_);_.isSelected&&!_.isHidden&&m.push(_.id),_.pixelBounds&&_.pixelBounds.bottom>r&&(r=_.pixelBounds.bottom)});let y=d,w=0;if(o.forEach(_=>{_.percentBounds=_.percentBounds||new c.UL(this.getPercentSize(w),this.getPercentSize(y),3*this.getTileMinPercentWidth(),3*this.getTileMinPercentHeight());let C=this.getPixelBounds(_.percentBounds);C.right>h&&(y=d,w=0,_.percentBounds.left=0,_.percentBounds.top=this.getPercentSize(y),C=this.getPixelBounds(_.percentBounds)),C.bottom>d&&(d=C.bottom),_.pixelBounds=this.getPixelBounds(_.percentBounds),w+=C.width}),this.dragTarget){const _=this.getPixelBounds(this.dragTarget);r<=_.bottom&&(r=_.bottom+_.height),h<=_.right&&(h=_.right+_.width)}const I=this.getPixelSize(2*this._tileMinHeight,this._tileMinHeightUnit);r<I&&(r=I),this.container.style.width=`${h}px`,this.container.style.height=`${r}px`,(null==s?void 0:s.ensureVisible)&&this.ensureVisible$.next(s.ensureVisible),(null==s?void 0:s.ensureBounds)&&this.ensureBounds$.next(s.ensureBounds),this.selectedTiles=m;const P=new CustomEvent("DejaTilesEvent",{cancelable:!1});o.length>0&&(P.tiles=o,this.layoutChanged.next(P)),P.tiles=f,this.layoutCompleted.next(P)});const t=this.ensureVisible$.pipe((0,q.g)(1),(0,N.U)(s=>this.tilesDic.get(s)),(0,T.h)(s=>!!s),(0,N.U)(s=>s.percentBounds));this.ensureBounds$.pipe((0,re.b)(t),(0,x.R)(this.destroyed$)).subscribe(s=>{const{left:o,right:a,top:r,bottom:h}=this.getPixelBounds(s),d=(y=>{for(;y&&"DEJA-TILES"!==y.tagName;)y=y.parentElement;return y})(this.container);if(!d)return;const f=this.container.getBoundingClientRect(),m=d.getBoundingClientRect();o+f.left<m.bottom?d.scrollLeft+=o+f.left-m.bottom:a+f.left>m.right&&(d.scrollLeft+=a+f.left-m.right),r+f.top<m.top?d.scrollTop+=r+f.top-m.top:h+f.top>m.bottom&&(d.scrollTop+=h+f.top-m.bottom)}),this.dragSelection$.pipe((0,H.w)(s=>{const o=(0,S.R)(this._container.ownerDocument,"mouseup").pipe((0,b.b)(()=>this.selectionRect$.next(null)));return(0,S.R)(this._container,"mousemove").pipe((0,x.R)(o),(0,T.h)(r=>1===r.buttons),(0,b.b)(r=>{const h=this._container.getBoundingClientRect();s.selectedRect=c.UL.fromPoints(s.startPosition,new c.Ly(r.pageX-h.left,r.pageY-h.top)),this.selectionRect$.next(s.selectedRect);const g=this.hitTest(s.selectedRect);this.selectedTiles=g.map(d=>d.id)}))}),(0,x.R)(this.destroyed$)).subscribe();const n=this.dragleave$;this.dragDropInfos$.pipe((0,H.w)(s=>{var I;const o=s&&((null==(I=s.tiles)?void 0:I.length)&&s.tiles||s.currentTile&&[s.currentTile]);if(!o)return(0,he.of)(null);const a=!s.tiles,r=(0,S.R)(this._container,"mousemove"),g=(0,S.R)(this._container.ownerDocument,"keyup").pipe((0,T.h)(P=>P.code===L.mW.Escape)),d=r.pipe((0,T.h)(P=>1!==P.buttons)),f=n.pipe((0,re.b)(d,g),(0,b.b)(()=>{this.removeTemporaryTile(),this.cancelDrag(o)})),y=(0,S.R)(this._container.ownerDocument,"mouseup").pipe((0,b.b)(()=>this.drop(o))).pipe((0,re.b)(f)),w=this.dragover$.pipe((0,N.U)(P=>P.originalEvent));return r.pipe((0,re.b)(w),(0,x.R)(y),(0,b.b)(P=>{const _=this._container.getBoundingClientRect(),C=P.pageX-_.left,te=P.pageY-_.top;if(s.enabled)this.drag(o,C,te);else if(Math.abs(s.startX-C)>=15||Math.abs(s.startY-te)>=15)if(a){const B=s.currentTile;this.selectedTiles=[B.id];let U=B.percentBounds;(!U||U.isEmpty())&&(U=new c.UL(0,0,15,15));const F=this.getFreePlace(new c.UL(this.getPercentSize(C)-U.width/2,this.getPercentSize(te)-U.height/2,U.width,U.height));s.startX=F.left-U.width/2,s.startY=F.top-U.height/2,B.percentBounds=F,B.dragging$.next(!0),this._cursor="move",this.tiles.push(B),this.tilesDic.set(B.id,B),this.dragging$.next(!0),s.enabled=!0,this.startDrag(o,this.getPixelSize(F.left+F.width/2),this.getPixelSize(F.top+F.height/2))}else this.dragging$.next(!0),s.enabled=!0,this.startDrag(o,s.startX,s.startY)}))}),(0,x.R)(this.destroyed$)).subscribe(),this.deleteTiles$.pipe((0,x.R)(this.destroyed$)).subscribe(s=>this.deleteTiles(s))}set container(e){if(this._container=e,this._container){const t=(0,S.R)(e,"mouseleave"),n=(0,S.R)(e.ownerDocument,"mouseup"),s=(0,S.R)(e,"mouseenter");s.pipe((0,H.w)(()=>{if(this.designMode){const o=t.pipe((0,b.b)(()=>this.container.style.cursor=""));return(0,S.R)(e,"mousemove").pipe((0,x.R)(o),(0,T.h)(r=>!!this.container&&0===r.buttons),(0,N.U)(r=>this._cursor=this.getCursorFromHtmlElement(r.pageX,r.pageY,r.target)))}return(0,he.of)("")}),(0,x.R)(this.destroyed$)).subscribe(o=>this.container.style.cursor=o),s.pipe((0,H.w)(()=>(0,S.R)(e,"mousedown").pipe((0,T.h)(r=>1===r.buttons),(0,T.h)(r=>!this.isElementInsideDejaEditor(r.target)),(0,N.U)(r=>({event:r,clickedTile:this.getTileComponentFromHTMLElement(r.target)}))).pipe((0,x.R)(t),(0,H.w)(({event:r,clickedTile:h})=>{const g=r.target;if(this.currentTile&&(this.currentTile.isPressed=!1),this.currentTile=h,this.currentTile){if(this.currentTile.isPressed=!0,!r.ctrlKey&&((!this.currentTile.isSelected||"move"!==this._cursor)&&(this.selectedTiles=[this.currentTile.id]),this.designMode)){const d=this._container.getBoundingClientRect();this.dragDropInfos$.next({enabled:!1,startX:r.pageX-d.left,startY:r.pageY-d.top,currentTile:this.currentTile,tiles:this.tiles.filter(y=>y.isSelected)})}return n.pipe((0,z.q)(1),(0,T.h)(()=>!!this.currentTile))}if(g===this.container||g.parentElement===this.container){if(1===r.buttons){const d=this._container.getBoundingClientRect();this.dragSelection$.next({startPosition:new c.Ly(r.pageX-d.left,r.pageY-d.top),selectedRect:new c.UL})}this.currentTile&&(this.currentTile.isPressed=!1),this.selectedTiles=[]}return(0,he.of)(null)}))),(0,T.h)(o=>!!o),(0,x.R)(this.destroyed$)).subscribe(o=>{this.currentTile.isPressed&&(this.currentTile.isPressed=!1,o.ctrlKey&&(this.currentTile.isSelected=!this.currentTile.isSelected,this.selectedTiles=this.tiles.filter(a=>a.isSelected).map(a=>a.id))),this.designMode&&(this._cursor=this.getCursorFromHtmlElement(o.pageX,o.pageY,o.target),this.container.style.cursor=this._cursor),this.currentTile=void 0})}}get container(){return this._container}set tiles(e){this._tiles=e,this.tilesDic=this.tiles.reduce((t,n)=>t.set(n.id,n),new Map),this.refreshTiles$.next({resetWidth:!0})}get tiles(){return this._tiles||(this._tiles=new Array)}set selectedTiles(e){var a;const t=new Array;let n=!1;const s=e.reduce((r,h)=>r.add(h),new Set),o=this.selectedIds.reduce((r,h)=>r.add(h),new Set);if((null==(a=this.tiles)?void 0:a.length)?this.tiles.forEach(r=>{s.has(r.id)!==o.has(r.id)&&(n=!0),r.isSelected=s.has(r.id),r.isSelected&&t.push(r)}):n=this.selectedIds.length>0,this.selectedIds=e,n){const r=new CustomEvent("DejaTilesAddEvent",{cancelable:!1});r.tiles=t,this.selectionChanged.next(r)}}set tileMinWidth(e){this.extractValueAndUnit("_tileMinWidth",e)}set tileMaxWidth(e){this.extractValueAndUnit("_tileMaxWidth",e)}set tileMinHeight(e){this.extractValueAndUnit("_tileMinHeight",e)}set tileMaxHeight(e){this.extractValueAndUnit("_tileMaxHeight",e)}set maxWidth(e){this.extractValueAndUnit("_maxWidth",e)}get targetBounds(){return this._targetBounds}set targetBounds(e){this._targetBounds=e,this.selectionRect$.next(e?new c.UL({height:this.getPixelSize(e.height||0),left:this.getPixelSize(e.left||0),top:this.getPixelSize(e.top||0),width:this.getPixelSize(e.width||0)}):null)}copySelection(){const e=this.tiles.filter(t=>t.isSelected);return e.length&&this.copyTiles(e,!1),e}cutSelection(){const e=this.tiles.filter(t=>t.isSelected);return e.length&&this.copyTiles(e,!0),e}deleteSelection(){const e=this.tiles.filter(t=>t.isSelected);return e.length&&this.removeTiles(e.map(t=>t.id)),e}paste(){if(!this.clipboardService||!this.clipboardService.isAvailable("tiles"))return new Array;const e=this.clipboardService.get("tiles");let t;this.tiles.forEach(o=>o.isSelected=!1),e.forEach(o=>{t=t?c.UL.union(t,o.percentBounds):new c.UL(o.percentBounds)});const n=this.getFreePlace(new c.UL(0,0,t.width,t.height)),s=e.map(o=>{const a=o.clone();return a.percentBounds=new c.UL(n.left+o.percentBounds.left-t.left,n.top+o.percentBounds.top-t.top,o.percentBounds.width,o.percentBounds.height),a.isSelected=!0,a});return this.addTiles(s),s}getTileElementFromHTMLElement(e){let t=e;for(;t&&"DEJA-TILE"!==t.tagName;)if(t=t.parentElement,t===this.container)return;if((null==t?void 0:t.parentElement)===this.container)return t}isElementInsideDejaEditor(e){let t=e;for(;t&&t!==this.container;){if("DEJA-EDITOR"===t.tagName)return!0;t=t.parentElement}return!1}getTileComponentFromHTMLElement(e){const t=this.getTileElementFromHTMLElement(e);return t&&this.tilesDic.get(t.id)}deleteTiles(e){if(!e||0===e.length)return;const t=new CustomEvent("DejaTilesDeletedEvent",{cancelable:!1});t.tiles=e,e.forEach(s=>{this.tilesDic.delete(s.id),s.delete()});let n=this.tiles.length;for(;--n>=0;)this.tilesDic.has(this.tiles[n].id)||this.tiles.splice(n,1);this.refreshTiles$.next({resetWidth:!0}),t.tiles=this.tiles,this.tilesDeleted.next(t)}removeTiles(e){if(!e||0===e.length)return;const t=e.map(o=>this.tilesDic.get(o));t.forEach(o=>{o.isHidden=!0});const n=new CustomEvent("DejaTilesRemoveEvent",{cancelable:!0});n.tiles=this.tiles,n.removed=t,n.cancel$=new M.x;const s=n.cancel$.pipe((0,z.q)(1),(0,x.R)(this.destroyed$)).subscribe(o=>{o?t.forEach(a=>a.isHidden=!1):this.deleteTiles(t)});this.contentRemoving.next(n),n.defaultPrevented||(s.unsubscribe(),this.deleteTiles(t))}getFreePlace(e){const t=new Array,n=this.tiles.filter(o=>!o.isDragging);let s=0;n.forEach(o=>{o.percentBounds.bottom>s&&(s=o.percentBounds.bottom)});for(let o=0;o<=this._maxWidth-e.width;o+=this._tileMinWidth)for(let a=0;a<=s-e.height;a+=this._tileMinHeight){const r=new c.UL(o,a,e.width,e.height);n.find(h=>h.percentBounds.intersectWith(r))||t.push(r)}return t.length>0?(t.sort((o,a)=>{const r=h=>Math.min(Math.abs(h.left-e.left),Math.abs(h.right-e.right))+200*Math.min(Math.abs(h.top-e.top),Math.abs(h.bottom-e.bottom));return r(o)-r(a)}),t[0]):new c.UL(0,s,e.width,e.height)}moveTile(e,t){const n=this.tiles.find(s=>s.id===e);n&&(n.percentBounds=t,this.refreshTiles$.next(null))}hitTest(e){const t=new c.UL(this.getPercentSize(e.left),this.getPercentSize(e.top),this.getPercentSize(e.width),this.getPercentSize(e.height));return this.tiles.filter(n=>n.percentBounds.intersectWith(t))}getPercentSize(e){return Math.round(100*e/this.hundredPercentWith)}dragEnter(e,t){if(!this.designMode||!this._container)return!1;const n=e.tile;if(!n)return!1;const s=this._container.getBoundingClientRect(),{pageX:o,pageY:a}=t.originalEvent,r=o-s.left,h=a-s.top,g=n.clone();return g.isTemporary=!0,this.dragDropInfos$.next({enabled:!1,startX:r,startY:h,currentTile:g}),!0}startDrag(e,t,n){const s=this.saveLayout();let o;e.forEach(a=>{o=o?c.UL.union(o,a.percentBounds):a.percentBounds,a.isDragging=!0}),this.dragRelativePosition=new Map,e.forEach(a=>this.dragRelativePosition.set(a.id,new c.Ly(a.percentBounds.left-o.left,a.percentBounds.top-o.top))),this.dragPageOffset=new c.Ly(t,n),this.dragOriginalPosition=new c.Ly(o.left,o.top),this.targetBounds=s.targetBounds=s.validBounds=o,this.originalLayout=s,this.validLayout=void 0}cancelDrag(e){this.clearMoveTimer(),(0,R.D)(e).pipe((0,T.h)(t=>!!t),(0,x.R)(this.destroyed$)).subscribe(t=>{t.isDragging=!1,t.isDropping=!0}),this.originalLayout&&this.restoreLayout(this.originalLayout),this.endDrag()}drop(e){let t;if(this.clearMoveTimer(),this.validLayout){if(this.restoreLayout(this.validLayout),"move"!==this._cursor){const n=e[0];n.percentBounds=new c.UL(this.validLayout.validBounds),n.isDragging=!1}else(0,R.D)(e).pipe((0,T.h)(n=>!!n),(0,b.b)(n=>{const s=this.validLayout.validBounds.left+this.dragRelativePosition.get(n.id).left,o=this.validLayout.validBounds.top+this.dragRelativePosition.get(n.id).top;n.percentBounds=new c.UL(s,o,n.percentBounds.width,n.percentBounds.height),n.isDragging=!1,n.isDropping=!0,n.isTemporary&&(this.tilesDic.delete(n.id),n.makeId(),this.tilesDic.set(n.id,n),this.addTiles([n]))}),(0,q.g)(1e3),(0,x.R)(this.destroyed$)).subscribe(n=>n.isDropping=!1);t=this.tiles.filter(n=>{const s=this.originalLayout[n.id];return!c.UL.equals(n.percentBounds,null==s?void 0:s.bounds)}),this.endDrag()}else this.removeTemporaryTile(),this.cancelDrag(e);if(t){const n=new CustomEvent("DejaTilesEvent",{cancelable:!0});n.tiles=this.tiles,this.layoutChanged.next(n)}return t}endDrag(){this.originalLayout=void 0,this.validLayout=void 0,this.targetBounds=void 0,this.dragging$.next(!1),this.dragDropInfos$.next(null),this.dragTarget=void 0,this.copyTiles(null),this.refreshTiles$.next(null)}drag(e,t,n){const s=new c.Ly(t-this.dragPageOffset.left,n-this.dragPageOffset.top),o=s.left+this.getPixelSize(this.dragOriginalPosition.left),a=s.top+this.getPixelSize(this.dragOriginalPosition.top),r=this.getTileMinPixelSize(),h=this.getTileMaxPixelSize();if("move"!==this._cursor){const g=e[0],d=this.getPixelBounds(g.percentBounds),f=o+d.width,m=a+d.height,y=d.right,w=d.bottom;switch(this._cursor){case"nw-resize":d.left=Math.max(Math.min(o,d.right-r.width),d.right-h.width),d.right=y,d.top=Math.max(Math.min(a,d.bottom-r.height),d.bottom-h.height),d.bottom=w,this.size(g,new c.Ly(o,a),c.Ns.left+c.Ns.top);break;case"sw-resize":d.left=Math.max(Math.min(o,d.right-r.width),d.right-h.width),d.right=y,d.bottom=Math.max(Math.min(m,d.top+h.height),d.top+r.height),this.size(g,new c.Ly(o,m),c.Ns.left+c.Ns.bottom);break;case"w-resize":d.left=Math.max(Math.min(o,d.right-r.width),d.right-h.width),d.right=y,this.size(g,new c.Ly(o,0),c.Ns.left);break;case"ne-resize":d.right=Math.max(Math.min(f,d.left+h.width),d.left+r.width),d.top=Math.max(Math.min(a,d.bottom-r.height),d.bottom-h.height),d.bottom=w,this.size(g,new c.Ly(f,a),c.Ns.right+c.Ns.top);break;case"se-resize":d.right=Math.max(Math.min(f,d.left+h.width),d.left+r.width),d.bottom=Math.max(Math.min(m,d.top+h.height),d.top+r.height),this.size(g,new c.Ly(f,m),c.Ns.right+c.Ns.bottom);break;case"e-resize":d.right=Math.max(Math.min(f,d.left+h.width),d.left+r.width),this.size(g,new c.Ly(f,0),c.Ns.right);break;case"n-resize":d.top=Math.max(Math.min(a,d.bottom-r.height),d.bottom-h.height),d.bottom=w,this.size(g,new c.Ly(0,a),c.Ns.top);break;case"s-resize":d.bottom=Math.max(Math.min(m,d.top+h.height),d.top+r.height),this.size(g,new c.Ly(0,m),c.Ns.bottom)}g.pixelBounds=d}else e.forEach(g=>{g.pixelBounds=new c.UL(o+this.getPixelSize(this.dragRelativePosition.get(g.id).left),a+this.getPixelSize(this.dragRelativePosition.get(g.id).top),this.getPixelSize(g.percentBounds.width),this.getPixelSize(g.percentBounds.height))}),this.dragTarget=new c.UL(this.getPercentSize(o),this.getPercentSize(a),this.targetBounds.width,this.targetBounds.height),this.move()}addTiles(e){var h;if(!e||0===e.length)return;e.forEach(g=>{this.tiles.find(d=>d.id===g.id)||(this.tiles.find(d=>{var f;return g.percentBounds&&(null==(f=d.percentBounds)?void 0:f.intersectWith(g.percentBounds))})&&(g.percentBounds=void 0),g.percentBounds||(g.percentBounds=this.getFreePlace(g.idealBounds)),this.tiles.push(g),this.tilesDic.set(g.id,g))});const t=new CustomEvent("DejaTilesAddEvent",{cancelable:!0});t.tiles=this.tiles,t.added=e,t.cancel$=new M.x;const n=null==(h=this.clipboardService)?void 0:h.get("tiles-provider");let s;n&&(s=this.clipboardService.get("tiles"),s.forEach(g=>{g.isHidden=!0}));const o=()=>{s&&(n.next(s),this.clipboardService.clear())},a=g=>{o();const d=new CustomEvent("DejaTileAddedEvent",{cancelable:!1});d.tiles=this.tiles,d.added=g,this.tilesAdded.next(d)};let r;e.forEach(g=>{r=r?c.UL.union(r,g.percentBounds):new c.UL(g.percentBounds)}),this.refreshTiles$.next({ensureBounds:r}),this.contentAdding.next(t),t.defaultPrevented?(t.cancel$.pipe((0,z.q)(1),(0,T.h)(g=>!g),(0,x.R)(this.destroyed$)).subscribe(a),t.cancel$.pipe((0,z.q)(1),(0,T.h)(g=>!!g),(0,H.w)(()=>(s&&s.forEach(g=>{g.isHidden=!1,g.isCutted=!0}),(0,R.D)(e))),(0,b.b)(g=>g.isHidden=!0),(0,q.g)(1e3),(0,de.u)((g,d)=>[...g,d],new Array),(0,z.q)(1),(0,x.R)(this.destroyed$)).subscribe(g=>this.deleteTiles(g))):a(e)}size(e,t,n){const s=new c.Ly(this.getPercentSize(t.left),this.getPercentSize(t.top)),o=e.percentBounds.clone(),a=e.percentBounds.clone();let r,h,g,d;if(n&c.Ns.left){r=this.getTileMinPercentWidth(),g=this.getTileMaxPercentWidth();const m=s.left,y=o.left<m?r*Math.ceil(m/r):r*Math.floor(m/r),w=Math.min(g,Math.max(r,a.right-y));o.width=o.right-m,o.left=m,a.left=a.right-w,a.width=w}if(n&c.Ns.right){r=r||this.getTileMinPercentWidth(),g=g||this.getTileMaxPercentWidth();const m=s.left,y=o.right<m?r*Math.ceil(m/r):r*Math.floor(m/r);o.width=m-o.left,a.width=Math.min(g,Math.max(r,y-a.left))}if(n&c.Ns.top){h=this.getTileMinPercentHeight(),d=this.getTileMaxPercentHeight();const m=s.top,y=o.top<m?h*Math.ceil(m/h):h*Math.floor(m/h),w=Math.min(d,Math.max(h,a.bottom-y));o.height=o.bottom-m,o.top=m,a.top=a.bottom-w,a.height=w}if(n&c.Ns.bottom){h=h||this.getTileMinPercentHeight(),d=d||this.getTileMaxPercentHeight();const m=s.top,y=o.bottom<m?h*Math.ceil(m/h):h*Math.floor(m/h);o.height=m-o.top,a.height=Math.min(d,Math.max(h,y-a.top))}if(!c.UL.equals(a,this.destination))if(this.restoreLayout(this.originalLayout),this.destination=a.clone(),this.tiles.find(m=>!m.isDragging&&m.percentBounds.intersectWith(a))){if(a){const m=this.ensureTarget(a,o,n);m&&(this.targetBounds=m,this.validLayout=this.saveLayout(),this.validLayout.targetBounds=a,this.validLayout.validBounds=m,this.refreshTiles$.next(null))}}else this.targetBounds=a,this.validLayout=this.saveLayout(),this.validLayout.targetBounds=this.validLayout.validBounds=a,this.refreshTiles$.next(null)}clearMoveTimer(){this.moveTimOut&&(this.moveTimOut.unsubscribe(),this.moveTimOut=void 0)}move(){const e=this.getTileMinPercentWidth(),t=this.getTileMinPercentHeight();let n=this.ensureContainer(new c.UL(e*Math.round(this.dragTarget.left/e),t*Math.round(this.dragTarget.top/t),this.dragTarget.width,this.dragTarget.height));if(this.lastTargetBounds&&Math.abs(n.left-this.lastTargetBounds.left)<e&&Math.abs(n.top-this.lastTargetBounds.top)<t)return;this.lastTargetBounds=n;const s=this.tiles.filter(o=>!o.isDragging).reduce((o,a)=>{const r=c.UL.overlapInfos(a.percentBounds,n);return Math.max(Math.min(r.height,r.width),o)},0);if(this.tiles.find(o=>{const a=this.originalLayout[o.id];return null==a?void 0:a.bounds.intersectWith(n)})||this.restoreLayout(this.originalLayout),0===s)this.clearMoveTimer(),this.targetBounds=n.clone(),this.destination=n.clone(),this.validLayout=this.saveLayout(),this.validLayout.targetBounds=this.validLayout.validBounds=n,this.refreshTiles$.next(null);else{if(c.UL.equals(this.targetBounds,n)||this.clearMoveTimer(),s>3){const r=n.clone();this.moveTimOut=(0,Te.H)(500).pipe((0,z.q)(1),(0,x.R)(this.destroyed$)).subscribe(()=>{this.restoreLayout(this.originalLayout),this.destination=r;const h=this.ensureTarget(r,this.dragTarget,c.Ns.all);h&&(this.targetBounds=h,this.validLayout=this.saveLayout(),this.validLayout.targetBounds=r,this.validLayout.validBounds=h,this.refreshTiles$.next(null))})}const o=new Array,a=this.tiles.filter(r=>!r.isDragging);for(let r=Math.min(this.targetBounds.left,n.left);r<=Math.max(this.targetBounds.left,n.left);r++)for(let h=Math.min(this.targetBounds.top,n.top);h<=Math.max(this.targetBounds.top,n.top);h++){const g=new c.UL(r,h,n.width,n.height);a.find(d=>d.percentBounds.intersectWith(g))||o.push(g)}o.length>0&&(o.sort((r,h)=>{const g=d=>Math.min(Math.abs(d.left-n.left),Math.abs(d.right-n.right))+200*Math.min(Math.abs(d.top-n.top),Math.abs(d.bottom-n.bottom));return g(r)-g(h)}),n=o[0],this.targetBounds=n.clone(),this.destination=n.clone(),this.validLayout=this.saveLayout(),this.validLayout.targetBounds=this.validLayout.validBounds=n,this.refreshTiles$.next(null))}}ensureContainer(e){e.left<0&&(e=e.offset(-e.left,0)),e.top<0&&(e=e.offset(0,-e.top));const t=this.getMaxPercentWidth();t&&e.right>t&&(e=e.offset(t-e.right,0));const n=this.getMaxPercentHeight();return n&&e.bottom>n&&(e=e.offset(0,n-e.bottom)),e}ensureTarget(e,t,n,s,o=10){t||(t=e),s||(s=e.clone()),n||(n=c.Ns.all);const a=new Array,r=new Array,h=new Array,g=new Array;if(this.tiles.filter(m=>!m.isDragging&&m.percentBounds.intersectWith(e)).find(m=>{const y=new c.UL(this.dragOriginalPosition.left,this.dragOriginalPosition.top,e.width,e.height);if(Math.abs(m.percentBounds.left-t.left)<1&&Math.abs(m.percentBounds.top-t.top)<1&&Math.abs(m.percentBounds.width-t.width)<1&&Math.abs(m.percentBounds.height-t.height)<1&&(Math.abs(t.left-y.right)<=4||Math.abs(t.right-y.left)<=4||Math.abs(t.top-y.bottom)<=4||Math.abs(t.bottom-y.top)<=4))return m.percentBounds=y,!0;{const w=m.percentBounds.left-t.left,I=t.right-m.percentBounds.right,P=m.percentBounds.top-t.top,_=t.bottom-m.percentBounds.bottom,C=Math.max(0,Math.min(m.percentBounds.right,t.right)-Math.max(m.percentBounds.left,t.left))/Math.min(m.percentBounds.width,t.width);let B;switch(Math.max(0,Math.min(m.percentBounds.bottom,t.bottom)-Math.max(m.percentBounds.top,t.top))/Math.min(m.percentBounds.height,t.height)>=C&&n&c.Ns.horizontal?B=I>=w&&n&c.Ns.left?c.Ns.left:c.Ns.right:n&c.Ns.vertical&&(B=_>=P&&n&c.Ns.top?c.Ns.top:c.Ns.bottom),B){case c.Ns.left:a.push(m);break;case c.Ns.top:h.push(m);break;case c.Ns.right:r.push(m);break;default:g.push(m)}}}))return e;let f=0;return a.length&&(f=this.pushHorizontal(e,-1,a),f)?(e=this.ensureContainer(e.offset(f,0)),o?this.ensureTarget(e,t,n&~c.Ns.left,s,o-1):null):(r.length&&(f=this.pushHorizontal(e,1,r)),f>0?(this.restoreLayout(this.originalLayout),o?this.ensureTarget(s,t,n&c.Ns.vertical,void 0,o-1):null):h.length&&(f=this.pushVertical(e,-1,h),f)?(e=this.ensureContainer(e.offset(0,f)),o?this.ensureTarget(e,t,c.Ns.bottom,void 0,o-1):null):(f=this.pushVertical(e,1,g),f?null:e))}saveLayout(){const e={};return e.height=this.getTileMinPercentHeight(),this.tiles.forEach(t=>{const n=this.getPixelSize(t.percentBounds.top||0),s=this.getPixelSize(t.percentBounds.height||this._tileMinHeight);n+s>e.height&&(e.height=n+s),e[t.id]={bounds:t.percentBounds.clone(),id:t.id}}),e}getPixelBounds(e){return c.UL.fromLTRB(Math.round(e.left*this.hundredPercentWith/100),Math.round(e.top*this.hundredPercentWith/100),Math.round(e.right*this.hundredPercentWith/100),Math.round(e.bottom*this.hundredPercentWith/100))}getPixelSize(e,t){return t&&"%"!==t?e:Math.round(e*this.hundredPercentWith/100)}getSizePercentLimit(e){const t=this,n=t[`${e}Unit`];return n&&"px"!==n?t[e]:this.getPercentSize(t[e])}getSizePixelLimit(e){const t=this,n=t[`${e}Unit`];return n&&"px"!==n?this.getPixelSize(t[e]):t[e]}getTileMinPixelSize(){return new c.$u(this.getSizePixelLimit("_tileMinWidth"),this.getSizePixelLimit("_tileMinHeight"))}getTileMaxPixelSize(){return new c.$u(this.getSizePixelLimit("_tileMaxWidth"),this.getSizePixelLimit("_tileMaxHeight"))}getTileMinPercentWidth(){return Math.max(1,this.getSizePercentLimit("_tileMinWidth"))}getTileMaxPercentWidth(){return Math.max(5,this.getSizePercentLimit("_tileMaxWidth"))}getTileMinPercentHeight(){return Math.max(1,this.getSizePercentLimit("_tileMinHeight"))}getTileMaxPercentHeight(){return Math.max(5,this.getSizePercentLimit("_tileMaxHeight"))}getMaxPercentWidth(){return Math.max(5,this.getSizePercentLimit("_maxWidth"))}getMaxPercentHeight(){return Math.max(5,this.getSizePercentLimit("_maxHeight"))}getCursorFromHtmlElement(e,t,n){const s=this.getTileElementFromHTMLElement(n);if(!s)return null;const o=s.getBoundingClientRect();return e<o.left+15?t<o.top+15?"nw-resize":t>o.bottom-15?"sw-resize":"w-resize":e>o.right-15?t<o.top+15?"ne-resize":t>o.bottom-15?"se-resize":"e-resize":t<o.top+15?"n-resize":t>o.bottom-15?"s-resize":"move"}extractValueAndUnit(e,t){const s=/(\d+)(.*)/i.exec(t);if((null==s?void 0:s.length)>=1){const o=this;o[e]=parseInt(s[1],10),o[`${e}Unit`]=s.length>=2?s[2]:"px"}}restoreLayout(e){this.tiles.forEach(t=>{const n=e[t.id];n&&(t.percentBounds=n.bounds.clone())})}calcHorizontalOverflow(e,t,n,s){let o=0;return s=s||new Set,t.forEach(a=>{if(!s.has(a.id)){s.add(a.id);const r=a.percentBounds.offset(e*n,0);let h=0;const g=this.getMaxPercentWidth();r.left<0?h=-r.left:g&&r.right>g&&(h=r.right-g);const d=this.tiles.filter(f=>!f.isDragging&&!f.equalsTo(a)&&f.percentBounds.intersectWith(r));d.length&&(h+=this.calcHorizontalOverflow(e,d,n,s)),h>o&&(o=h)}}),o}moveHorizontal(e,t,n,s){t.forEach(o=>{if(!s.has(o.id)){const a=o.percentBounds.offset(e*n,0);s.set(o.id,a);const r=this.tiles.filter(h=>!h.isDragging&&!h.equalsTo(o)&&h.percentBounds.intersectWith(a));r.length&&this.moveHorizontal(e,r,n,s)}})}pushHorizontal(e,t,n,s){let o=0;const a=new Map;return s||(s=0,n.forEach(r=>{const h=t>0?Math.max(0,e.right-r.percentBounds.left):Math.max(0,r.percentBounds.right-e.left);h>s&&(s=h)})),s>0&&(o=this.calcHorizontalOverflow(t,n,s),(s-=o)>0&&(this.moveHorizontal(t,n,s,a),this.tiles.forEach(r=>{a.has(r.id)&&(r.percentBounds=a.get(r.id))}))),o}calcVerticalOverflow(e,t,n,s){let o=0;return s=s||new Set,t.forEach(a=>{if(!s.has(a.id)){s.add(a.id);const r=a.percentBounds.offset(0,e*n);let h=0;const g=this.getMaxPercentHeight();r.top<0?h=-r.top:g&&r.bottom>g&&(h=r.bottom-g);const d=this.tiles.filter(f=>!f.isDragging&&!f.equalsTo(a)&&f.percentBounds.intersectWith(r));d.length&&(h+=this.calcVerticalOverflow(e,d,n,s)),h>o&&(o=h)}}),o}moveVertical(e,t,n,s){t.forEach(o=>{if(!s.has(o.id)){const a=o.percentBounds.offset(0,e*n);s.set(o.id,a);const r=this.tiles.filter(h=>!h.isDragging&&!h.equalsTo(o)&&h.percentBounds.intersectWith(a));r.length&&this.moveVertical(e,r,n,s)}})}pushVertical(e,t,n,s){let o=0;const a=new Map;return s||(s=0,n.forEach(r=>{const h=t>0?Math.max(0,e.bottom-r.percentBounds.top):Math.max(0,r.percentBounds.bottom-e.top);h>s&&(s=h)})),s>0&&(o=this.calcVerticalOverflow(t,n,s),(s-=o)>0&&(this.moveVertical(t,n,s,a),this.tiles.forEach(r=>a.has(r.id)&&(r.percentBounds=a.get(r.id))))),o}copyTiles(e,t){if(!this.clipboardService){if(!e)return;throw new Error("DejaClipboardService must be imported by your application to use the copyTiles methode of DejaTilesComponent.")}const n=this.clipboardService.get("tiles");n&&n.forEach(s=>s.isCutted=!1),this.clipboardService.set("tiles",e),t?(e.forEach(s=>s.isCutted=!0),this.clipboardService.set("tiles-provider",this.deleteTiles$)):this.clipboardService.set("tiles-provider",void 0)}removeTemporaryTile(){let e=this.tiles.length;for(;--e>=0;){const t=this.tiles[e];t.isTemporary&&(this.tilesDic.delete(t.id),this.tiles.splice(e,1))}}}return l.\u0275fac=function(e){return new(e||l)(i.LFG(L.ST,8))},l.\u0275prov=i.Yz7({token:l,factory:l.\u0275fac}),l})(),Ee=(()=>{class l extends L.yl{constructor(e,t,n,s){super(),this.changeDetectorRef=t,this.layoutProvider=n,this.control=s,this.selectionChanged=new i.vpe,this.layoutChanged=new i.vpe,this.layoutCompleted=new i.vpe,this.contentAdding=new i.vpe,this.contentRemoving=new i.vpe,this.tilesAdded=new i.vpe,this.tilesDeleted=new i.vpe,this.contentCopied=new i.vpe,this.tabIndex=0,this._models=[],this.hasFocus=!1,this.onTouchedCallback=()=>{},this.onChangeCallback=a=>{},this.control&&(this.control.valueAccessor=this);const o=e.nativeElement;(0,R.D)(this.layoutProvider.selectionChanged).pipe((0,x.R)(this.destroyed$)).subscribe(a=>this.selectionChanged.emit(a)),(0,R.D)(this.layoutProvider.contentAdding).pipe((0,x.R)(this.destroyed$)).subscribe(a=>this.contentAdding.emit(a)),(0,R.D)(this.layoutProvider.contentRemoving).pipe((0,x.R)(this.destroyed$)).subscribe(a=>this.contentRemoving.emit(a)),(0,R.D)(this.layoutProvider.tilesAdded).pipe((0,x.R)(this.destroyed$)).subscribe(a=>{this.tilesAdded.emit(a),this.onChangeCallback(a.tiles)}),(0,R.D)(this.layoutProvider.tilesDeleted).pipe((0,x.R)(this.destroyed$)).subscribe(a=>{this.tilesDeleted.emit(a),this.onChangeCallback(a.tiles)}),(0,R.D)(this.layoutProvider.layoutChanged).pipe((0,x.R)(this.destroyed$)).subscribe(a=>{this.layoutChanged.emit(a),this.onChangeCallback(a.tiles)}),(0,R.D)(this.layoutProvider.layoutCompleted).pipe((0,x.R)(this.destroyed$)).subscribe(a=>this.layoutCompleted.emit(a)),this.keyup$=(0,S.R)(o.ownerDocument,"keyup"),(0,S.R)(window,"resize").pipe((0,ee.b)(5),(0,x.R)(this.destroyed$)).subscribe(()=>this.refresh({resetWidth:!0}))}get tiles(){return this.layoutProvider.tiles}get selectionRect$(){return this.layoutProvider.selectionRect$}set tileminwidth(e){this.layoutProvider.tileMinWidth=e}set tilemaxwidth(e){this.layoutProvider.tileMaxWidth=e}set tileminheight(e){this.layoutProvider.tileMinHeight=e}set tilemaxheight(e){this.layoutProvider.tileMaxHeight=e}set maxwidth(e){this.layoutProvider.maxWidth=e}set designMode(e){this.layoutProvider.designMode=(0,v.Ig)(e)}get designMode(){return this.layoutProvider.designMode}set models(e){this.writeValue(e)}set canDelete(e){(0,v.Ig)(e)&&!this.delete$sub?this.delete$sub=this.keyup$.pipe((0,T.h)(t=>this.layoutProvider.designMode&&t.code===L.mW.Delete&&this.hasFocus),(0,x.R)(this.destroyed$)).subscribe(()=>this.layoutProvider.deleteSelection()):this.delete$sub&&(this.delete$sub.unsubscribe(),this.delete$sub=void 0)}set canCopy(e){(0,v.Ig)(e)&&!this.copy$sub?this.copy$sub=this.keyup$.pipe((0,T.h)(t=>t.code===L.mW.KeyC&&t.ctrlKey&&this.hasFocus),(0,x.R)(this.destroyed$)).subscribe(()=>this.copySelection()):this.copy$sub&&(this.copy$sub.unsubscribe(),this.copy$sub=void 0)}set canCut(e){(0,v.Ig)(e)&&!this.cut$sub?this.cut$sub=this.keyup$.pipe((0,T.h)(t=>this.layoutProvider.designMode&&t.code===L.mW.KeyX&&t.ctrlKey&&this.hasFocus),(0,x.R)(this.destroyed$)).subscribe(()=>this.cutSelection()):this.cut$sub&&(this.cut$sub.unsubscribe(),this.cut$sub=void 0)}set canPaste(e){(0,v.Ig)(e)&&!this.paste$sub?this.paste$sub=this.keyup$.pipe((0,T.h)(t=>this.layoutProvider.designMode&&t.code===L.mW.KeyV&&t.ctrlKey&&this.hasFocus),(0,x.R)(this.destroyed$)).subscribe(()=>this.paste()):this.paste$sub&&(this.paste$sub.unsubscribe(),this.paste$sub=void 0)}set selectedTiles(e){this.layoutProvider.selectedTiles=e.map(t=>"string"==typeof t?t:t.id)}writeValue(e){this._models=e||[],this.layoutProvider.tiles=this._models,this.changeDetectorRef.markForCheck()}registerOnChange(e){this.onChangeCallback=e}registerOnTouched(e){this.onTouchedCallback=e}ngAfterViewInit(){this.layoutProvider.container=this.tilesContainer.nativeElement,this.refresh({resetWidth:!0})}ngOnDestroy(){super.ngOnDestroy(),this.canCopy=!1,this.canCut=!1,this.canDelete=!1,this.canPaste=!1}copySelection(){const e=this.layoutProvider.copySelection();if(null==e?void 0:e.length){const t=new CustomEvent("DejaTilesCopied",{cancelable:!0});t.tiles=e,this.contentCopied.emit(t)}}cutSelection(){const e=this.layoutProvider.cutSelection();if(null==e?void 0:e.length){const t=new CustomEvent("DejaTilesCutted",{cancelable:!0});t.tiles=e,this.contentCopied.emit(t)}}deleteSelection(){const e=this.layoutProvider.deleteSelection();return this.changeDetectorRef.markForCheck(),e}paste(){const e=this.layoutProvider.paste();return this.changeDetectorRef.markForCheck(),e}ensureVisible(e){this.layoutProvider.ensureVisible$.next(e)}refresh(e){this.layoutProvider.refreshTiles$.next(e)}addTiles(e){this.layoutProvider.addTiles(e)}removeTiles(e){this.layoutProvider.removeTiles(e)}hitTest(e,t){const s=this.tilesContainer.nativeElement.getBoundingClientRect(),o=e-s.left,a=t-s.top;return this.tiles.find(r=>{var h;return null==(h=r.pixelBounds)?void 0:h.containsPoint(new c.Ly(o,a))})}getFreePlace(e,t,n,s){if(!this._models||0===this._models.length)return new c.UL(0,0,n,s);const a=this.tilesContainer.nativeElement.getBoundingClientRect(),h=t?t-a.top:0,g=new c.UL(this.layoutProvider.getPercentSize(e?e-a.left:0),this.layoutProvider.getPercentSize(h),n,s);return this.layoutProvider.getFreePlace(g)}moveTile(e,t){this.layoutProvider.moveTile(e,t)}getDropContext(){let e;return{dragEnter:(t,n)=>(e=this.layoutProvider.dragEnter(t,n)?{className:"hidden"}:null,e),dragOver:(t,n)=>(this.layoutProvider.dragover$.next(n),e),dragLeave:t=>{e=null,this.layoutProvider.dragleave$.next()}}}onTileClosed(e){this.layoutProvider.removeTiles([e.id])}onFocus(){this.hasFocus=!0}onBlur(){this.hasFocus=!1}}return l.\u0275fac=function(e){return new(e||l)(i.Y36(i.SBq),i.Y36(i.sBO),i.Y36(ge),i.Y36(E.a5,10))},l.\u0275cmp=i.Xpm({type:l,selectors:[["deja-tiles"]],contentQueries:function(e,t,n){if(1&e&&i.Suo(n,Ce,5),2&e){let s;i.iGM(s=i.CRH())&&(t.tileTemplate=s.first)}},viewQuery:function(e,t){if(1&e&&i.Gf(De,7),2&e){let n;i.iGM(n=i.CRH())&&(t.tilesContainer=n.first)}},inputs:{tabIndex:"tabIndex",tileminwidth:"tileminwidth",tilemaxwidth:"tilemaxwidth",tileminheight:"tileminheight",tilemaxheight:"tilemaxheight",maxwidth:"maxwidth",designMode:"designMode",models:"models",canDelete:"canDelete",canCopy:"canCopy",canCut:"canCut",canPaste:"canPaste",selectedTiles:"selectedTiles"},outputs:{selectionChanged:"selectionChanged",layoutChanged:"layoutChanged",layoutCompleted:"layoutCompleted",contentAdding:"contentAdding",contentRemoving:"contentRemoving",tilesAdded:"tilesAdded",tilesDeleted:"tilesDeleted",contentCopied:"contentCopied"},features:[i._Bn([ge]),i.qOj],decls:5,vars:8,consts:[["id","tiles",3,"mouse-droppable","focus","blur"],["tilesContainer",""],[3,"id","tile","template","close",4,"ngFor","ngForOf"],["deja-tile-position","",3,"bounds"],[3,"id","tile","template","close"]],template:function(e,t){1&e&&(i.TgZ(0,"div",0,1),i.NdJ("focus",function(){return t.onFocus()})("blur",function(){return t.onBlur()}),i.YNc(2,Pe,1,4,"deja-tile",2),i._UZ(3,"div",3),i.ALo(4,"async"),i.qZA()),2&e&&(i.ekj("design",t.designMode),i.Q6J("mouse-droppable",t.getDropContext()),i.uIk("tabindex",t.tabIndex),i.xp6(2),i.Q6J("ngForOf",t.tiles),i.xp6(1),i.Q6J("bounds",i.lcZ(4,6,t.selectionRect$)))},directives:[V.dY,D.sg,Se,$e],pipes:[D.Ov],styles:["[_nghost-%COMP%]{position:relative;overflow:auto;margin:0!important}[_nghost-%COMP%]   #tiles[_ngcontent-%COMP%]{display:block;left:0;top:0;min-width:100%;min-height:100%;position:absolute;padding:0!important;margin:0!important}[_nghost-%COMP%]   #tiles.design[_ngcontent-%COMP%]   deja-tile[_ngcontent-%COMP%]{background-color:#0000001a}[_nghost-%COMP%]   #tiles[_ngcontent-%COMP%]   #tile[_ngcontent-%COMP%]:hover{z-index:200}[_nghost-%COMP%]   [deja-tile-position][_ngcontent-%COMP%]{position:absolute;z-index:101;background-color:#00000080}[drag][_nghost-%COMP%]{background-color:#00000080}[drag][_nghost-%COMP%]   [deja-tile-position][_ngcontent-%COMP%]{transition-property:left,top,width,height;transition-duration:.35s;transition-timing-function:ease}"],changeDetection:0}),l})(),ce=(()=>{class l{constructor(e){this.cutted$=new W.X(!1),this.dragging$=new W.X(!1),this.dropping$=new W.X(!1),this.pressed$=new W.X(!1),this.selected$=new W.X(!1),this.hidden$=new ve.t(1),this.pixelBounds$=new W.X(null),this.deleted$=new M.x,this.refresh$=new M.x,this.isTemporary=!1,this._isDragging=!1,this._isDropping=!1,this._isPressed=!1,this._isHidden=!1,this._id=e||"#"+l.CURRENT_ID++}get idealBounds(){return new c.UL(0,0,15,15)}set pixelBounds(e){c.UL.equals(this._pixelBounds,e)||(this._pixelBounds=e,this.pixelBounds$.next(e))}get pixelBounds(){return this._pixelBounds}set percentBounds(e){this._percentBounds=e}get percentBounds(){return this._percentBounds}set templateModel(e){this._templateModel=e}get templateModel(){return this._templateModel}get id(){return this._id}set isCutted(e){this._cutted!==e&&(this._cutted=e,this.cutted$.next(e))}get isCutted(){return this._cutted}set color(e){this._color=e}get color(){return this._color}set isDragging(e){this._isDragging!==e&&(this._isDragging=e,this.dragging$.next(e))}get isDragging(){return this._isDragging}set isDropping(e){this._isDropping!==e&&(this._isDropping=e,this.dropping$.next(e))}get isDropping(){return this._isDropping}set isPressed(e){this._isPressed!==e&&(this._isPressed=e,this.pressed$.next(e))}get isPressed(){return this._isPressed}set isSelected(e){this._selected!==e&&(this._selected=e,this.selected$.next(e))}get isSelected(){return this._selected}set isHidden(e){this._isHidden!==e&&(this._isHidden=e,this.hidden$.next(e))}get isHidden(){return this._isHidden}set isPending(e){this._pending=e}get isPending(){return this._pending}get fading(){return this._fading}set fading(e){this._fading=e}makeId(){this._id="#"+l.CURRENT_ID++}equalsTo(e){return this._templateModel?this._templateModel===e._templateModel:this._id===e._id}clone(e){return e||(e=new l(this.id)),e._percentBounds=this.percentBounds,e._color=this.color,e._templateModel=this.templateModel,e._cutted=this._cutted,e._selected=this._selected,e._pending=this._pending,e._fading=this._fading,e}delete(){this.deleted$.next()}refresh(){this.refresh$.next()}}return l.CURRENT_ID=0,l})(),ke=(()=>{class l{}return l.\u0275fac=function(e){return new(e||l)},l.\u0275mod=i.oAB({type:l}),l.\u0275inj=i.cJS({imports:[[D.ez,E.u5,ye,V.$Q]]}),l})();var Be=p(6412),Re=p(3507),Ae=p(2405),je=p(8975),Le=p(5517),Ue=p(7991);function Oe(l,u){1&l&&(i.TgZ(0,"mat-card",5),i._UZ(1,"deja-markdown",6),i.qZA()),2&l&&(i.xp6(1),i.Q6J("url","https://raw.githubusercontent.com/DSI-HUG/dejajs-components/develop/projects/deja-js/component/tiles/readme.txt"))}function ze(l,u){if(1&l){const e=i.EpF();i.TgZ(0,"button",11),i.NdJ("click",function(){return i.CHM(e),i.oxw(2).$implicit.cancel(!1)}),i._uU(1," Ok "),i.qZA(),i.TgZ(2,"button",12),i.NdJ("click",function(){return i.CHM(e),i.oxw(2).$implicit.cancel(!0)}),i._uU(3," Annuler "),i.qZA()}}function We(l,u){if(1&l){const e=i.EpF();i.TgZ(0,"deja-snackbar",8),i.NdJ("onAnimationDone",function(){return i.CHM(e),i.oxw().$implicit.cancel(!1)}),i.TgZ(1,"deja-message-box",9),i._uU(2),i.YNc(3,ze,4,0,"ng-template",null,10,i.W1O),i.qZA(),i.qZA()}if(2&l){const e=i.oxw().$implicit;i.Q6J("duration",8e3),i.xp6(1),i.Q6J("type",e.type)("title",e.title),i.xp6(1),i.hij(" ",e.content," ")}}function Ne(l,u){1&l&&i.YNc(0,We,5,4,"deja-snackbar",7),2&l&&i.Q6J("ngIf",u.$implicit.gate)}function He(l,u){if(1&l&&(i.TgZ(0,"div",23),i._uU(1),i.TgZ(2,"span",24),i._uU(3,"Selected"),i.qZA(),i.TgZ(4,"span",25),i._uU(5,"Pressed"),i.qZA(),i.qZA()),2&l){const e=u.$implicit;i.Udp("background-color",e.color),i.xp6(1),i.AsE("",e.templateModel.naqme," (",e.templateModel.code,") ")}}function Ie(l,u){if(1&l&&(i.TgZ(0,"div",23),i._uU(1),i.TgZ(2,"span",24),i._uU(3,"Selected"),i.qZA(),i.TgZ(4,"span",25),i._uU(5,"Pressed"),i.qZA(),i.qZA()),2&l){const e=u.$implicit;i.Udp("background-color",e.color),i.xp6(1),i.AsE("",e.templateModel.naqme," (",e.templateModel.code,") ")}}function Fe(l,u){if(1&l){const e=i.EpF();i.TgZ(0,"mat-card",5),i.TgZ(1,"mat-toolbar",13),i._uU(2,"Tiles Demo"),i.qZA(),i.TgZ(3,"mat-card-content",14),i.TgZ(4,"mat-checkbox",15),i.NdJ("ngModelChange",function(n){return i.CHM(e),i.oxw().designMode=n}),i._uU(5,"Design Mode"),i.qZA(),i.qZA(),i.TgZ(6,"mat-card-content"),i.TgZ(7,"span",16,17),i._uU(9," Drop Area "),i.qZA(),i.qZA(),i.TgZ(10,"mat-card-content"),i.TgZ(11,"deja-tiles",18,19),i.NdJ("contentAdding",function(n){return i.CHM(e),i.oxw().onContentAdding(n)})("contentRemoving",function(n){return i.CHM(e),i.oxw().onContentRemoving(n)}),i.ALo(13,"async"),i.YNc(14,He,6,4,"ng-template",null,20,i.W1O),i.qZA(),i.qZA(),i.TgZ(16,"mat-card-content"),i.TgZ(17,"deja-tiles",21,22),i.NdJ("contentAdding",function(n){return i.CHM(e),i.oxw().onContentAdding(n)})("contentRemoving",function(n){return i.CHM(e),i.oxw().onContentRemoving(n)}),i.ALo(19,"async"),i.YNc(20,Ie,6,4,"ng-template",null,20,i.W1O),i.qZA(),i.qZA(),i.qZA()}if(2&l){const e=i.MAs(8),t=i.oxw();i.xp6(4),i.Q6J("ngModel",t.designMode),i.xp6(3),i.Q6J("mouse-droppable",t.getDropContext(e)),i.xp6(4),i.Q6J("models",i.lcZ(13,6,t.tiles1$))("mouse-draggable",t.getDragContext()),i.xp6(6),i.Q6J("models",i.lcZ(19,8,t.tiles2$))("designMode",t.designMode)}}const Xe=Re.Bz.forChild([{path:"",component:(()=>{class l{constructor(e){this.countriesService=e,this.tabIndex=1,this.designMode=!1,this.message$=new M.x,this.messages$=this.message$.pipe((0,Ae.R)((t,n)=>[...t,n],[]),(0,je.d)([]))}ngOnInit(){let e=0,t=0,n=0,s=0;this.countriesMap=new Map;const o=this.countriesService.getCountries$().pipe((0,H.w)(a=>a));this.tiles1$=o.pipe((0,z.q)(12),(0,N.U)(a=>{const r=new ce;return r.percentBounds=new c.UL(e,t,15,15),r.color=a.color,r.templateModel=a,e+=15,e+15>100&&(e=0,t+=15),this.countriesMap.set(r.id,a),r}),(0,de.u)((a,r)=>[...a,r],[])),this.tiles2$=o.pipe((0,N.U)(a=>{const r=new ce;return r.percentBounds=new c.UL(n,s,15,15),r.color=a.color,r.templateModel=a,n+=15,n+15>100&&(n=0,s+=15),r}),(0,de.u)((a,r)=>[...a,r],[]))}getDragContext(){return{target:"deja-tile",className:"deja-tile-cursor",dragStart:e=>{const t=this.countriesMap.get(e.id),n=new ce;return n.percentBounds=new c.UL(0,0,15,15),n.color=t.color,n.templateModel=t,{country:t,tile:n}}}}getDropContext(e){return{dragEnter:t=>({width:200,height:60,className:"country-target-cursor"}),drop:t=>{const n=t.country;e.innerText=`The dropped country is ${n.naqme} - the code is: ${n.code}`}}}onContentAdding(e){this.message$.next({title:"Tiles added",content:`${e.added.length} tiles added.`,type:"warn",gate:!0,cancel:function(t){this.gate=!1,e.cancel$.next(t)}}),e.preventDefault()}onContentRemoving(e){this.message$.next({title:"Tiles deleted",content:`${e.removed.length} tiles deleted.`,type:"warn",gate:!0,cancel:function(t){this.gate=!1,e.cancel$.next(t)}}),e.preventDefault()}}return l.\u0275fac=function(e){return new(e||l)(i.Y36(Le.K))},l.\u0275cmp=i.Xpm({type:l,selectors:[["deja-tiles-demo"]],decls:8,vars:6,consts:[[3,"selectedIndex","selectedTabChange"],["label","API REFERENCE"],["label","EXAMPLES"],["class","demo-card demo-basic",4,"ngIf"],["ngFor","",3,"ngForOf"],[1,"demo-card","demo-basic"],[3,"url"],["alignment","bottom right",3,"duration","onAnimationDone",4,"ngIf"],["alignment","bottom right",3,"duration","onAnimationDone"],[3,"type","title"],["actionsTemplate",""],["mat-raised-button","","color","primary",3,"click"],["mat-raised-button","",3,"click"],["color","primary"],["id","actions"],[3,"ngModel","ngModelChange"],["id","droparea",3,"mouse-droppable"],["dropArea",""],["id","tiles1","maxwidth","100%","tileminwidth","5%","tileminheight","5%","tilemaxheight","50%","tilemaxwidth","50%",3,"models","mouse-draggable","contentAdding","contentRemoving"],["tiles1",""],["tileTemplate",""],["id","tiles2","canDelete","","canCopy","","canCut","","canPaste","","maxwidth","100%","tileminwidth","5%","tileminheight","5%","tilemaxheight","50%","tilemaxwidth","50%",3,"models","designMode","contentAdding","contentRemoving"],["tiles2",""],[1,"tile-content","noselect"],["id","selected"],["id","pressed"]],template:function(e,t){1&e&&(i.TgZ(0,"mat-tab-group",0),i.NdJ("selectedTabChange",function(s){return t.tabIndex=s.index}),i._UZ(1,"mat-tab",1),i._UZ(2,"mat-tab",2),i.qZA(),i.YNc(3,Oe,2,1,"mat-card",3),i.YNc(4,Ne,1,1,"ng-template",4),i.ALo(5,"async"),i.YNc(6,Fe,22,10,"mat-card",3),i._UZ(7,"mouse-dragdrop-cursor")),2&e&&(i.Q6J("selectedIndex",t.tabIndex),i.xp6(3),i.Q6J("ngIf",0===t.tabIndex),i.xp6(1),i.Q6J("ngForOf",i.lcZ(5,4,t.messages$)),i.xp6(2),i.Q6J("ngIf",1===t.tabIndex))},directives:[Y.SP,Y.uX,D.O5,D.sg,V.Sx,X.a8,Ue.F,oe.w,J.b,se.lW,ne.Ye,X.dn,Z.oG,E.JJ,E.On,V.dY,Ee,V.lq],pipes:[D.Ov],styles:["deja-tiles-demo .demo-basic{padding:0}deja-tiles-demo .demo-full-width{width:100%}deja-tiles-demo .demo-icons{font-size:100%;height:inherit;vertical-align:top;width:inherit}deja-tiles-demo .demo-card{margin:16px}deja-tiles-demo .demo-card mat-card-content{display:flex;flex-direction:column;margin:2rem}deja-tiles-demo #actions{display:flex;flex-direction:row;align-items:center;justify-content:space-between}deja-tiles-demo #droparea{height:5rem;background-color:#f57c00;width:50%;display:block}deja-tiles-demo #tiles1{height:370px;display:block}deja-tiles-demo #tiles2{height:1000px;display:block}deja-tiles-demo deja-tile{-webkit-user-select:none;-moz-user-select:none;user-select:none}deja-tiles-demo deja-tile #selected{display:none}deja-tiles-demo deja-tile #pressed{display:none}deja-tiles-demo deja-tile[selected] #selected{display:block}deja-tiles-demo deja-tile[pressed] #pressed{display:block}deja-tiles-demo deja-tile .tile-content{width:100%;height:100%;display:block}@media screen and (min-width: 1401px){deja-tiles-demo deja-tiles{font-size:100%}}@media screen and (max-width: 1400px){deja-tiles-demo deja-tiles{font-size:90%}}@media screen and (max-width: 1200px){deja-tiles-demo deja-tiles{font-size:85%}}@media screen and (max-width: 768px){deja-tiles-demo deja-tiles{font-size:80%}}@media screen and (max-width: 640px){deja-tiles-demo deja-tiles{font-size:70%}}@media screen and (max-width: 320px){deja-tiles-demo deja-tiles{font-size:60%}}.deja-tile-cursor .tile-content{width:100%;height:100%;display:block;opacity:.8}.country-target-cursor .tile-content{background-color:#f4a460!important;width:100%;height:100%;display:block;opacity:.8}\n"],encapsulation:2}),l})()},{path:"**",redirectTo:"",pathMatch:"full"}]);let Ye=(()=>{class l{}return l.\u0275fac=function(e){return new(e||l)},l.\u0275mod=i.oAB({type:l}),l.\u0275inj=i.cJS({providers:[],imports:[[D.ez,Be.O,J.J,oe.n,ke,E.u5,se.ot,X.QW,Z.p9,Y.Nh,ne.g0,V.$Q,Xe]]}),l})()}}]);