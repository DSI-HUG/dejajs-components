(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{"ToA/":function(e,t,i){"use strict";i.r(t);var s=i("SVse"),n=i("s7LF"),r=i("Dxy4"),o=i("PDjf"),a=i("pMoy"),d=i("M9ds"),l=i("l0rg"),h=i("650w"),c=i("PO1J"),u=i("KUKF"),g=i("mrSG"),p=i("8Y7J"),m=i("UhP/"),f=i("8LU1"),b=i("omvX"),v=i("SCoL");function x(e,t){if(1&e&&(p["\u0275\u0275namespaceSVG"](),p["\u0275\u0275element"](0,"circle",3)),2&e){const e=p["\u0275\u0275nextContext"]();p["\u0275\u0275styleProp"]("animation-name","mat-progress-spinner-stroke-rotate-"+e.diameter)("stroke-dashoffset",e._strokeDashOffset,"px")("stroke-dasharray",e._strokeCircumference,"px")("stroke-width",e._circleStrokeWidth,"%"),p["\u0275\u0275attribute"]("r",e._circleRadius)}}function y(e,t){if(1&e&&(p["\u0275\u0275namespaceSVG"](),p["\u0275\u0275element"](0,"circle",3)),2&e){const e=p["\u0275\u0275nextContext"]();p["\u0275\u0275styleProp"]("stroke-dashoffset",e._strokeDashOffset,"px")("stroke-dasharray",e._strokeCircumference,"px")("stroke-width",e._circleStrokeWidth,"%"),p["\u0275\u0275attribute"]("r",e._circleRadius)}}class w{constructor(e){this._elementRef=e}}const M=Object(m.u)(w,"primary"),j=new p.InjectionToken("mat-progress-spinner-default-options",{providedIn:"root",factory:function(){return{diameter:100}}});let O=(()=>{class e extends M{constructor(t,i,s,n,r){super(t),this._elementRef=t,this._document=s,this._diameter=100,this._value=0,this._fallbackAnimation=!1,this.mode="determinate";const o=e._diameters;o.has(s.head)||o.set(s.head,new Set([100])),this._fallbackAnimation=i.EDGE||i.TRIDENT,this._noopAnimations="NoopAnimations"===n&&!!r&&!r._forceAnimations,r&&(r.diameter&&(this.diameter=r.diameter),r.strokeWidth&&(this.strokeWidth=r.strokeWidth))}get diameter(){return this._diameter}set diameter(e){this._diameter=Object(f.e)(e),!this._fallbackAnimation&&this._styleRoot&&this._attachStyleNode()}get strokeWidth(){return this._strokeWidth||this.diameter/10}set strokeWidth(e){this._strokeWidth=Object(f.e)(e)}get value(){return"determinate"===this.mode?this._value:0}set value(e){this._value=Math.max(0,Math.min(100,Object(f.e)(e)))}ngOnInit(){const e=this._elementRef.nativeElement;this._styleRoot=function(e,t){if("undefined"!=typeof window){const i=t.head;if(i&&(i.createShadowRoot||i.attachShadow)){const t=e.getRootNode?e.getRootNode():null;if(t instanceof window.ShadowRoot)return t}}return null}(e,this._document)||this._document.head,this._attachStyleNode(),e.classList.add(`mat-progress-spinner-indeterminate${this._fallbackAnimation?"-fallback":""}-animation`)}get _circleRadius(){return(this.diameter-10)/2}get _viewBox(){const e=2*this._circleRadius+this.strokeWidth;return`0 0 ${e} ${e}`}get _strokeCircumference(){return 2*Math.PI*this._circleRadius}get _strokeDashOffset(){return"determinate"===this.mode?this._strokeCircumference*(100-this._value)/100:this._fallbackAnimation&&"indeterminate"===this.mode?.2*this._strokeCircumference:null}get _circleStrokeWidth(){return this.strokeWidth/this.diameter*100}_attachStyleNode(){const t=this._styleRoot,i=this._diameter,s=e._diameters;let n=s.get(t);if(!n||!n.has(i)){const e=this._document.createElement("style");e.setAttribute("mat-spinner-animation",i+""),e.textContent=this._getAnimationText(),t.appendChild(e),n||(n=new Set,s.set(t,n)),n.add(i)}}_getAnimationText(){return"\n @keyframes mat-progress-spinner-stroke-rotate-DIAMETER {\n    0%      { stroke-dashoffset: START_VALUE;  transform: rotate(0); }\n    12.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(0); }\n    12.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(72.5deg); }\n    25%     { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(72.5deg); }\n\n    25.0001%   { stroke-dashoffset: START_VALUE;  transform: rotate(270deg); }\n    37.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(270deg); }\n    37.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(161.5deg); }\n    50%     { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(161.5deg); }\n\n    50.0001%  { stroke-dashoffset: START_VALUE;  transform: rotate(180deg); }\n    62.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(180deg); }\n    62.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(251.5deg); }\n    75%     { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(251.5deg); }\n\n    75.0001%  { stroke-dashoffset: START_VALUE;  transform: rotate(90deg); }\n    87.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(90deg); }\n    87.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(341.5deg); }\n    100%    { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(341.5deg); }\n  }\n".replace(/START_VALUE/g,""+.95*this._strokeCircumference).replace(/END_VALUE/g,""+.2*this._strokeCircumference).replace(/DIAMETER/g,""+this.diameter)}}return e.\u0275fac=function(t){return new(t||e)(p["\u0275\u0275directiveInject"](p.ElementRef),p["\u0275\u0275directiveInject"](v.a),p["\u0275\u0275directiveInject"](s.d,8),p["\u0275\u0275directiveInject"](b.a,8),p["\u0275\u0275directiveInject"](j))},e.\u0275cmp=p["\u0275\u0275defineComponent"]({type:e,selectors:[["mat-progress-spinner"]],hostAttrs:["role","progressbar",1,"mat-progress-spinner"],hostVars:10,hostBindings:function(e,t){2&e&&(p["\u0275\u0275attribute"]("aria-valuemin","determinate"===t.mode?0:null)("aria-valuemax","determinate"===t.mode?100:null)("aria-valuenow","determinate"===t.mode?t.value:null)("mode",t.mode),p["\u0275\u0275styleProp"]("width",t.diameter,"px")("height",t.diameter,"px"),p["\u0275\u0275classProp"]("_mat-animation-noopable",t._noopAnimations))},inputs:{color:"color",mode:"mode",diameter:"diameter",strokeWidth:"strokeWidth",value:"value"},exportAs:["matProgressSpinner"],features:[p["\u0275\u0275InheritDefinitionFeature"]],decls:3,vars:8,consts:[["preserveAspectRatio","xMidYMid meet","focusable","false",3,"ngSwitch"],["cx","50%","cy","50%",3,"animation-name","stroke-dashoffset","stroke-dasharray","stroke-width",4,"ngSwitchCase"],["cx","50%","cy","50%",3,"stroke-dashoffset","stroke-dasharray","stroke-width",4,"ngSwitchCase"],["cx","50%","cy","50%"]],template:function(e,t){1&e&&(p["\u0275\u0275namespaceSVG"](),p["\u0275\u0275elementStart"](0,"svg",0),p["\u0275\u0275template"](1,x,1,9,"circle",1),p["\u0275\u0275template"](2,y,1,7,"circle",2),p["\u0275\u0275elementEnd"]()),2&e&&(p["\u0275\u0275styleProp"]("width",t.diameter,"px")("height",t.diameter,"px"),p["\u0275\u0275property"]("ngSwitch","indeterminate"===t.mode),p["\u0275\u0275attribute"]("viewBox",t._viewBox),p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("ngSwitchCase",!0),p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("ngSwitchCase",!1))},directives:[s.p,s.q],styles:[".mat-progress-spinner{display:block;position:relative}.mat-progress-spinner svg{position:absolute;transform:rotate(-90deg);top:0;left:0;transform-origin:center;overflow:visible}.mat-progress-spinner circle{fill:transparent;transform-origin:center;transition:stroke-dashoffset 225ms linear}._mat-animation-noopable.mat-progress-spinner circle{transition:none;animation:none}.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate]{animation:mat-progress-spinner-linear-rotate 2000ms linear infinite}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate]{transition:none;animation:none}.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate] circle{transition-property:stroke;animation-duration:4000ms;animation-timing-function:cubic-bezier(0.35, 0, 0.25, 1);animation-iteration-count:infinite}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate] circle{transition:none;animation:none}.mat-progress-spinner.mat-progress-spinner-indeterminate-fallback-animation[mode=indeterminate]{animation:mat-progress-spinner-stroke-rotate-fallback 10000ms cubic-bezier(0.87, 0.03, 0.33, 1) infinite}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-fallback-animation[mode=indeterminate]{transition:none;animation:none}.mat-progress-spinner.mat-progress-spinner-indeterminate-fallback-animation[mode=indeterminate] circle{transition-property:stroke}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-fallback-animation[mode=indeterminate] circle{transition:none;animation:none}@keyframes mat-progress-spinner-linear-rotate{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes mat-progress-spinner-stroke-rotate-100{0%{stroke-dashoffset:268.606171575px;transform:rotate(0)}12.5%{stroke-dashoffset:56.5486677px;transform:rotate(0)}12.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(72.5deg)}25%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(72.5deg)}25.0001%{stroke-dashoffset:268.606171575px;transform:rotate(270deg)}37.5%{stroke-dashoffset:56.5486677px;transform:rotate(270deg)}37.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(161.5deg)}50%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(161.5deg)}50.0001%{stroke-dashoffset:268.606171575px;transform:rotate(180deg)}62.5%{stroke-dashoffset:56.5486677px;transform:rotate(180deg)}62.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(251.5deg)}75%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(251.5deg)}75.0001%{stroke-dashoffset:268.606171575px;transform:rotate(90deg)}87.5%{stroke-dashoffset:56.5486677px;transform:rotate(90deg)}87.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(341.5deg)}100%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(341.5deg)}}@keyframes mat-progress-spinner-stroke-rotate-fallback{0%{transform:rotate(0deg)}25%{transform:rotate(1170deg)}50%{transform:rotate(2340deg)}75%{transform:rotate(3510deg)}100%{transform:rotate(4680deg)}}\n"],encapsulation:2,changeDetection:0}),e._diameters=new WeakMap,e})(),_=(()=>{class e{}return e.\u0275mod=p["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=p["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[m.h,s.c],m.h]}),e})();var P=i("Z5sx"),T=i("2Vo4"),C=i("jtHE"),E=i("XNiG"),k=i("Cfvw"),B=i("VRyK"),S=i("xgIS"),D=i("LRne"),$=i("PqYM"),A=i("pLZG"),R=i("SxV6"),z=i("vkgz"),L=i("3E0/"),F=i("Kj3r"),I=i("1G5W"),W=i("lJxs"),H=i("eIep"),V=i("IzEk"),U=i("128B");function X(e,t){}function N(e,t){if(1&e&&p["\u0275\u0275element"](0,"mat-progress-spinner",2),2&e){const e=p["\u0275\u0275nextContext"]();p["\u0275\u0275property"]("diameter",e.progressDiameter)}}const q=function(e,t){return{$implicit:e,designMode:t}},Y=["tileTemplate"],K=["tilesContainer"];function G(e,t){if(1&e){const e=p["\u0275\u0275getCurrentView"]();p["\u0275\u0275elementStart"](0,"deja-tile",4),p["\u0275\u0275listener"]("close",(function(){p["\u0275\u0275restoreView"](e);const i=t.$implicit;return p["\u0275\u0275nextContext"]().onTileClosed(i)})),p["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit,i=t.index,s=p["\u0275\u0275nextContext"]();p["\u0275\u0275property"]("id",e.id)("tile",e)("designMode",s.designMode)("template",s.tileTemplate),p["\u0275\u0275attribute"]("tile-index",i)}}let J=(()=>{let e=class{constructor(e){this.element=e.nativeElement,this.element.style.display="none"}set bounds(e){if(e){const{left:t,top:i,width:s,height:n}=e;this.element.style.left=t+"px",this.element.style.top=i+"px",this.element.style.width=s+"px",this.element.style.height=n+"px",this.element.style.display="block"}else this.element.style.display="none"}};return e.\u0275fac=function(t){return new(t||e)(p["\u0275\u0275directiveInject"](p.ElementRef))},e.\u0275dir=p["\u0275\u0275defineDirective"]({type:e,selectors:[["","deja-tile-position",""]],inputs:{bounds:"bounds"}}),e})(),Q=(()=>{class e{constructor(t){this.cutted$=new T.a(!1),this.dragging$=new T.a(!1),this.dropping$=new T.a(!1),this.pressed$=new T.a(!1),this.selected$=new T.a(!1),this.hidden$=new C.a(1),this.pixelBounds$=new T.a(null),this.deleted$=new E.a,this.refresh$=new E.a,this.isTemporary=!1,this._isDragging=!1,this._isDropping=!1,this._isPressed=!1,this._isHidden=!1,this._id=t||"#"+e.currentId++}get idealBounds(){return new P.F(0,0,15,15)}set pixelBounds(e){P.F.equals(this._pixelBounds,e)||(this._pixelBounds=e,this.pixelBounds$.next(e))}get pixelBounds(){return this._pixelBounds}set percentBounds(e){this._percentBounds=e}get percentBounds(){return this._percentBounds}set templateModel(e){this._templateModel=e}get templateModel(){return this._templateModel}get id(){return this._id}set isCutted(e){this._cutted!==e&&(this._cutted=e,this.cutted$.next(e))}get isCutted(){return this._cutted}set color(e){this._color=e}get color(){return this._color}set isDragging(e){this._isDragging!==e&&(this._isDragging=e,this.dragging$.next(e))}get isDragging(){return this._isDragging}set isDropping(e){this._isDropping!==e&&(this._isDropping=e,this.dropping$.next(e))}get isDropping(){return this._isDropping}set isPressed(e){this._isPressed!==e&&(this._isPressed=e,this.pressed$.next(e))}get isPressed(){return this._isPressed}set isSelected(e){this._selected!==e&&(this._selected=e,this.selected$.next(e))}get isSelected(){return this._selected}set isHidden(e){this._isHidden!==e&&(this._isHidden=e,this.hidden$.next(e))}get isHidden(){return this._isHidden}set isPending(e){this._pending=e}get fading(){return this._fading}set fading(e){this._fading=e}get isPending(){return this._pending}makeId(){this._id="#"+e.currentId++}equalsTo(e){return this._templateModel?this._templateModel===e._templateModel:this._id===e._id}clone(t){return t||(t=new e(this.id)),t._percentBounds=this.percentBounds,t._color=this.color,t._templateModel=this.templateModel,t._cutted=this._cutted,t._selected=this._selected,t._pending=this._pending,t._fading=this._fading,t}delete(){this.deleted$.next()}refresh(){this.refresh$.next()}}return e.currentId=0,e})(),Z=(()=>{let e=class{constructor(e,t){this.changeDetectorRef=t,this.close=new p.EventEmitter,this.progressDiameter=100,this.subscriptions=[],this.element=e.nativeElement,this.element.setAttribute("hidden","0")}set designMode(e){this._designMode=Object(f.b)(e)}get designMode(){return this._designMode}set tile(e){if(this._tile=e,this.subscriptions.forEach(e=>e.unsubscribe()),this.subscriptions=[],e){const t=(e,t)=>{t?this.element.setAttribute(e,t.toString()):this.element.removeAttribute(e)};e.fading&&(this.element.setAttribute("fading","0"),this.changeDetectorRef.markForCheck()),this.subscriptions.push(Object(k.a)(e.pixelBounds$).pipe(Object(A.a)(e=>!!e),Object(R.a)(),Object(A.a)(()=>e.fading),Object(z.a)(()=>{this.element.setAttribute("fading","1"),this.changeDetectorRef.markForCheck()}),Object(L.a)(200)).subscribe(()=>{this.element.removeAttribute("fading"),this.changeDetectorRef.markForCheck()})),this.subscriptions.push(Object(k.a)(e.pixelBounds$).pipe(Object(A.a)(e=>!!e)).subscribe(t=>{e.isHidden||this.element.removeAttribute("hidden"),this.element.style.left=t.left+"px",this.element.style.top=t.top+"px",this.element.style.width=t.width+"px",this.element.style.height=t.height+"px",this.progressDiameter=Math.min(100,Math.round(Math.max(.4*t.width,.4*t.height))),this.changeDetectorRef.markForCheck()})),this.subscriptions.push(Object(k.a)(e.pressed$).pipe(Object(z.a)(e=>t("pressed",e))).subscribe(()=>this.changeDetectorRef.markForCheck())),this.subscriptions.push(Object(k.a)(e.selected$).pipe(Object(z.a)(e=>t("selected",e))).subscribe(()=>this.changeDetectorRef.markForCheck())),this.subscriptions.push(Object(k.a)(e.dragging$).pipe(Object(z.a)(e=>t("drag",e))).subscribe(()=>this.changeDetectorRef.markForCheck())),this.subscriptions.push(Object(k.a)(e.dropping$).pipe(Object(z.a)(e=>t("drop",e))).subscribe(()=>this.changeDetectorRef.markForCheck())),this.subscriptions.push(Object(k.a)(e.cutted$).pipe(Object(z.a)(e=>t("cutted",e))).subscribe(()=>this.changeDetectorRef.markForCheck())),this.subscriptions.push(Object(k.a)(e.deleted$).pipe(Object(z.a)(()=>this.element.remove())).subscribe(()=>this.changeDetectorRef.markForCheck()));const i=Object(k.a)(e.hidden$).pipe(Object(z.a)(e=>t("hidden",e?"1":"2")));this.subscriptions.push(i.pipe(Object(F.a)(1e3),Object(A.a)(e=>e),Object(z.a)(()=>this.element.setAttribute("hidden","0"))).subscribe(()=>this.changeDetectorRef.markForCheck())),this.subscriptions.push(i.pipe(Object(F.a)(1),Object(A.a)(e=>!e),Object(z.a)(()=>this.element.removeAttribute("hidden"))).subscribe(()=>this.changeDetectorRef.markForCheck())),this.subscriptions.push(Object(k.a)(e.refresh$).pipe(Object(F.a)(1)).subscribe(()=>this.changeDetectorRef.markForCheck()))}}get tile(){return this._tile}ngOnDestroy(){this.subscriptions.forEach(e=>e.unsubscribe())}};return e.\u0275fac=function(t){return new(t||e)(p["\u0275\u0275directiveInject"](p.ElementRef),p["\u0275\u0275directiveInject"](p.ChangeDetectorRef))},e.\u0275cmp=p["\u0275\u0275defineComponent"]({type:e,selectors:[["deja-tile"]],inputs:{designMode:"designMode",tile:"tile",template:"template"},outputs:{close:"close"},decls:2,vars:6,consts:[[3,"ngTemplateOutlet","ngTemplateOutletContext"],["mode","indeterminate","class","accent",3,"diameter",4,"ngIf"],["mode","indeterminate",1,"accent",3,"diameter"]],template:function(e,t){1&e&&(p["\u0275\u0275template"](0,X,0,0,"ng-template",0),p["\u0275\u0275template"](1,N,1,1,"mat-progress-spinner",1)),2&e&&(p["\u0275\u0275property"]("ngTemplateOutlet",t.template)("ngTemplateOutletContext",p["\u0275\u0275pureFunction2"](3,q,t.tile,t.designMode)),p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("ngIf",t.tile&&t.tile.isPending))},directives:[s.s,s.n,O],styles:['[_nghost-%COMP%]{display:block;position:absolute;transition-property:left,top,opacity;transition-duration:.5s;transition-timing-function:ease;opacity:1}[expanded][_nghost-%COMP%]{transition-property:height}[cutted][_nghost-%COMP%]{opacity:.5}[drag][_nghost-%COMP%], [drop][_nghost-%COMP%]{z-index:100}[drag][_nghost-%COMP%]{opacity:.5;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;transition:none}[fading="0"][_nghost-%COMP%]{opacity:0;transition:none}[fading="1"][_nghost-%COMP%]{opacity:0}[hidden="0"][_nghost-%COMP%]{visibility:hidden;transition:none}[hidden="1"][_nghost-%COMP%]{opacity:0;transition:opacity 1s ease-in-out}[hidden="2"][_nghost-%COMP%]{visibility:visible;opacity:0;transition:none}[_nghost-%COMP%]   mat-progress-spinner[_ngcontent-%COMP%]{position:absolute;z-index:1;right:.2rem;bottom:.2rem;transform:translate(-60%,-60%)}'],changeDetection:0}),e})(),ee=(()=>{let e=class extends P.s{constructor(e){super(),this.clipboardService=e,this.refreshTiles$=new E.a,this.ensureVisible$=new E.a,this.ensureBounds$=new E.a,this.dragging$=new T.a(!1),this.dragSelection$=new E.a,this.dragDropInfos$=new E.a,this.selectionRect$=new E.a,this.dragover$=new E.a,this.dragleave$=new E.a,this.deleteTiles$=new E.a,this.designMode=!1,this.layoutCompleted=new E.a,this.layoutChanged=new E.a,this.tilesAdded=new E.a,this.tilesDeleted=new E.a,this.selectionChanged=new E.a,this.contentAdding=new E.a,this.contentRemoving=new E.a,this._tileMinWidth=10,this._tileMinWidthUnit="%",this._tileMaxWidth=100,this._tileMaxWidthUnit="%",this._tileMinHeight=10,this._tileMinHeightUnit="%",this._tileMaxHeight=100,this._tileMaxHeightUnit="%",this._maxWidth=100,this._maxWidthUnit="%",this.tilesDic=new Map,this._targetBounds=new P.F,this.destination=new P.F,this.dragPageOffset=new P.E,this.dragOriginalPosition=new P.E,this.selectedIds=new Array,Object(k.a)(this.refreshTiles$).pipe(Object(F.a)(30),Object(z.a)(()=>{this.container.style.width="",this.container.style.height=""}),Object(L.a)(10),Object(I.a)(this.destroyed$)).subscribe(e=>{var t,i,s;const n=new Array,r=this.container.getBoundingClientRect();!(null===(t=e)||void 0===t?void 0:t.resetWidth)&&this.hundredPercentWith||(this.hundredPercentWith=r.width);let o=r.height-20,a=r.width-20,d=0,l=0;const h=this.tiles||new Array,c=new Array;h.forEach(e=>{if(e.percentBounds&&!e.percentBounds.isEmpty()){const t=this.getPixelBounds(e.percentBounds);t.bottom>d&&(d=t.right),t.right>l&&(l=t.bottom),e.isDragging||(e.pixelBounds=t)}else n.push(e);e.isSelected&&!e.isHidden&&c.push(e.id),e.pixelBounds&&e.pixelBounds.bottom>o&&(o=e.pixelBounds.bottom)});let u=l,g=0;if(n.forEach(e=>{e.percentBounds=e.percentBounds||new P.F(this.getPercentSize(g),this.getPercentSize(u),3*this.getTileMinPercentWidth(),3*this.getTileMinPercentHeight());let t=this.getPixelBounds(e.percentBounds);t.right>a&&(u=l,g=0,e.percentBounds.left=0,e.percentBounds.top=this.getPercentSize(u),t=this.getPixelBounds(e.percentBounds)),t.bottom>l&&(l=t.bottom),e.pixelBounds=this.getPixelBounds(e.percentBounds),g+=t.width}),this.dragTarget){const e=this.getPixelBounds(this.dragTarget);o<=e.bottom&&(o=e.bottom+e.height),a<=e.right&&(a=e.right+e.width)}const p=this.getPixelSize(2*this._tileMinHeight,this._tileMinHeightUnit);o<p&&(o=p),this.container.style.width=a+"px",this.container.style.height=o+"px",(null===(i=e)||void 0===i?void 0:i.ensureVisible)&&this.ensureVisible$.next(e.ensureVisible),(null===(s=e)||void 0===s?void 0:s.ensureBounds)&&this.ensureBounds$.next(e.ensureBounds),this.selectedTiles=c;const m=new CustomEvent("DejaTilesEvent",{cancelable:!1});n.length>0&&(m.tiles=n,this.layoutChanged.next(m)),m.tiles=h,this.layoutCompleted.next(m)});const t=Object(k.a)(this.ensureVisible$).pipe(Object(L.a)(1),Object(W.a)(e=>this.tilesDic.get(e)),Object(A.a)(e=>!!e),Object(W.a)(e=>e.percentBounds));Object(B.a)(this.ensureBounds$,t).pipe(Object(I.a)(this.destroyed$)).subscribe(e=>{const{left:t,right:i,top:s,bottom:n}=this.getPixelBounds(e),r=(e=>{for(;e&&"DEJA-TILES"!==e.tagName;)e=e.parentElement;return e})(this.container);if(!r)return;const o=this.container.getBoundingClientRect(),a=r.getBoundingClientRect();t+o.left<a.bottom?r.scrollLeft+=t+o.left-a.bottom:i+o.left>a.right&&(r.scrollLeft+=i+o.left-a.right),s+o.top<a.top?r.scrollTop+=s+o.top-a.top:n+o.top>a.bottom&&(r.scrollTop+=n+o.top-a.bottom)}),Object(k.a)(this.dragSelection$).pipe(Object(H.a)(e=>{const t=Object(S.a)(this._container.ownerDocument,"mouseup").pipe(Object(z.a)(()=>this.selectionRect$.next(null)));return Object(S.a)(this._container,"mousemove").pipe(Object(I.a)(t),Object(A.a)(e=>1===e.buttons),Object(z.a)(t=>{const i=this._container.getBoundingClientRect();e.selectedRect=P.F.fromPoints(e.startPosition,new P.E(t.pageX-i.left,t.pageY-i.top)),this.selectionRect$.next(e.selectedRect);const s=this.HitTest(e.selectedRect);this.selectedTiles=s.map(e=>e.id)}))}),Object(I.a)(this.destroyed$)).subscribe();const i=Object(k.a)(this.dragleave$);Object(k.a)(this.dragDropInfos$).pipe(Object(H.a)(e=>{const t=e&&(e.tiles&&e.tiles.length&&e.tiles||e.currentTile&&[e.currentTile]);if(!t)return Object(D.a)(null);const s=!e.tiles,n=Object(S.a)(this._container,"mousemove"),r=Object(S.a)(this._container.ownerDocument,"keyup").pipe(Object(A.a)(e=>e.code===P.A.Escape)),o=n.pipe(Object(A.a)(e=>1!==e.buttons)),a=Object(B.a)(i,o,r).pipe(Object(z.a)(()=>{this.removeTemporaryTile(),this.cancelDrag(t)})),d=Object(S.a)(this._container.ownerDocument,"mouseup").pipe(Object(z.a)(()=>this.drop(t))),l=Object(B.a)(d,a),h=Object(k.a)(this.dragover$).pipe(Object(W.a)(e=>e.originalEvent));return Object(B.a)(n,h).pipe(Object(I.a)(l),Object(z.a)(i=>{const n=this._container.getBoundingClientRect(),r=i.pageX-n.left,o=i.pageY-n.top;if(e.enabled)this.drag(t,r,o);else if(Math.abs(e.startX-r)>=15||Math.abs(e.startY-o)>=15)if(s){const i=e.currentTile;this.selectedTiles=[i.id];let s=i.percentBounds;s&&!s.isEmpty()||(s=new P.F(0,0,15,15));const n=this.getFreePlace(new P.F(this.getPercentSize(r)-s.width/2,this.getPercentSize(o)-s.height/2,s.width,s.height));e.startX=n.left-s.width/2,e.startY=n.top-s.height/2,i.percentBounds=n,i.dragging$.next(!0),this._cursor="move",this.tiles.push(i),this.tilesDic.set(i.id,i),this.dragging$.next(!0),e.enabled=!0,this.startDrag(t,this.getPixelSize(n.left+n.width/2),this.getPixelSize(n.top+n.height/2))}else this.dragging$.next(!0),e.enabled=!0,this.startDrag(t,e.startX,e.startY)}))}),Object(I.a)(this.destroyed$)).subscribe(),Object(k.a)(this.deleteTiles$).pipe(Object(I.a)(this.destroyed$)).subscribe(e=>this.deleteTiles(e))}set container(e){if(this._container=e,this._container){const t=Object(S.a)(e,"mouseleave"),i=Object(S.a)(e.ownerDocument,"mouseup"),s=Object(S.a)(e,"mouseenter");s.pipe(Object(H.a)(()=>{if(this.designMode){const i=t.pipe(Object(z.a)(()=>this.container.style.cursor=""));return Object(S.a)(e,"mousemove").pipe(Object(I.a)(i),Object(A.a)(e=>!!this.container&&0===e.buttons),Object(W.a)(e=>this._cursor=this.getCursorFromHTMLElement(e.pageX,e.pageY,e.target)))}return Object(D.a)("")}),Object(I.a)(this.destroyed$)).subscribe(e=>this.container.style.cursor=e),s.pipe(Object(H.a)(()=>Object(S.a)(e,"mousedown").pipe(Object(A.a)(e=>1===e.buttons),Object(A.a)(e=>!this.isElementInsideDejaEditor(e.target)),Object(W.a)(e=>({event:e,clickedTile:this.getTileComponentFromHTMLElement(e.target)}))).pipe(Object(I.a)(t),Object(H.a)(({event:e,clickedTile:t})=>{const s=e.target;if(this.currentTile&&(this.currentTile.isPressed=!1),this.currentTile=t,this.currentTile){if(this.currentTile.isPressed=!0,e.ctrlKey);else if(this.currentTile.isSelected&&"move"===this._cursor||(this.selectedTiles=[this.currentTile.id]),this.designMode){const t=this._container.getBoundingClientRect();this.dragDropInfos$.next({enabled:!1,startX:e.pageX-t.left,startY:e.pageY-t.top,currentTile:this.currentTile,tiles:this.tiles.filter(e=>e.isSelected)})}return i.pipe(Object(V.a)(1),Object(A.a)(()=>!!this.currentTile))}if(s===this.container||s.parentElement===this.container){if(1===e.buttons){const t=this._container.getBoundingClientRect();this.dragSelection$.next({startPosition:new P.E(e.pageX-t.left,e.pageY-t.top),selectedRect:new P.F})}this.currentTile&&(this.currentTile.isPressed=!1),this.selectedTiles=[]}return Object(D.a)(null)}))),Object(A.a)(e=>!!e),Object(I.a)(this.destroyed$)).subscribe(e=>{this.currentTile.isPressed&&(this.currentTile.isPressed=!1,e.ctrlKey&&(this.currentTile.isSelected=!this.currentTile.isSelected,this.selectedTiles=this.tiles.filter(e=>e.isSelected).map(e=>e.id))),this.designMode&&(this._cursor=this.getCursorFromHTMLElement(e.pageX,e.pageY,e.target),this.container.style.cursor=this._cursor),this.currentTile=void 0})}}get container(){return this._container}set tiles(e){this._tiles=e,this.tilesDic=this.tiles.reduce((e,t)=>e.set(t.id,t),new Map),this.refreshTiles$.next({resetWidth:!0})}get tiles(){return this._tiles||(this._tiles=new Array)}set selectedTiles(e){var t;const i=new Array;let s=!1;const n=e.reduce((e,t)=>e.add(t),new Set),r=this.selectedIds.reduce((e,t)=>e.add(t),new Set);if((null===(t=this.tiles)||void 0===t?void 0:t.length)?this.tiles.forEach(e=>{n.has(e.id)!==r.has(e.id)&&(s=!0),e.isSelected=n.has(e.id),e.isSelected&&i.push(e)}):s=this.selectedIds.length>0,this.selectedIds=e,s){const e=new CustomEvent("DejaTilesAddEvent",{cancelable:!1});e.tiles=i,this.selectionChanged.next(e)}}set tileMinWidth(e){this.extractValueAndUnit("_tileMinWidth",e)}set tileMaxWidth(e){this.extractValueAndUnit("_tileMaxWidth",e)}set tileMinHeight(e){this.extractValueAndUnit("_tileMinHeight",e)}set tileMaxHeight(e){this.extractValueAndUnit("_tileMaxHeight",e)}set maxWidth(e){this.extractValueAndUnit("_maxWidth",e)}get targetBounds(){return this._targetBounds}set targetBounds(e){this._targetBounds=e,e?this.selectionRect$.next(new P.F({height:this.getPixelSize(e.height||0),left:this.getPixelSize(e.left||0),top:this.getPixelSize(e.top||0),width:this.getPixelSize(e.width||0)})):this.selectionRect$.next()}copySelection(){const e=this.tiles.filter(e=>e.isSelected);return e.length&&this.copyTiles(e,!1),e}cutSelection(){const e=this.tiles.filter(e=>e.isSelected);return e.length&&this.copyTiles(e,!0),e}deleteSelection(){const e=this.tiles.filter(e=>e.isSelected);return e.length&&this.removeTiles(e.map(e=>e.id)),e}paste(){if(!this.clipboardService||!this.clipboardService.isAvailable("tiles"))return new Array;const e=this.clipboardService.get("tiles");let t;this.tiles.forEach(e=>e.isSelected=!1),e.forEach(e=>{t=t?P.F.union(t,e.percentBounds):new P.F(e.percentBounds)});const i=this.getFreePlace(new P.F(0,0,t.width,t.height)),s=e.map(e=>{const s=e.clone();return s.percentBounds=new P.F(i.left+e.percentBounds.left-t.left,i.top+e.percentBounds.top-t.top,e.percentBounds.width,e.percentBounds.height),s.isSelected=!0,s});return this.addTiles(s),s}getTileElementFromHTMLElement(e){let t=e;for(;t&&"DEJA-TILE"!==t.tagName;)if(t=t.parentElement,t===this.container)return;return t}isElementInsideDejaEditor(e){let t=e;for(;t&&t!==this.container;){if("DEJA-EDITOR"===t.tagName)return!0;t=t.parentElement}return!1}getTileComponentFromHTMLElement(e){const t=this.getTileElementFromHTMLElement(e);return t&&this.tilesDic.get(t.id)}deleteTiles(e){if(!e||0===e.length)return;const t=new CustomEvent("DejaTilesDeletedEvent",{cancelable:!1});t.tiles=e,e.forEach(e=>{this.tilesDic.delete(e.id),e.delete()});let i=this.tiles.length;for(;--i>=0;)this.tilesDic.has(this.tiles[i].id)||this.tiles.splice(i,1);this.refreshTiles$.next({resetWidth:!0}),t.tiles=this.tiles,this.tilesDeleted.next(t)}removeTiles(e){if(!e||0===e.length)return;const t=e.map(e=>this.tilesDic.get(e));t.forEach(e=>{e.isHidden=!0});const i=new CustomEvent("DejaTilesRemoveEvent",{cancelable:!0});i.tiles=this.tiles,i.removed=t,i.cancel$=new E.a;const s=i.cancel$.pipe(Object(R.a)(),Object(I.a)(this.destroyed$)).subscribe(e=>{e?t.forEach(e=>e.isHidden=!1):this.deleteTiles(t)});this.contentRemoving.next(i),i.defaultPrevented||(s.unsubscribe(),this.deleteTiles(t))}getFreePlace(e){const t=new Array,i=this.tiles.filter(e=>!e.isDragging);let s=0;i.forEach(e=>{e.percentBounds.bottom>s&&(s=e.percentBounds.bottom)});for(let n=0;n<=this._maxWidth-e.width;n+=this._tileMinWidth)for(let r=0;r<=s-e.height;r+=this._tileMinHeight){const s=new P.F(n,r,e.width,e.height);i.find(e=>e.percentBounds.intersectWith(s))||t.push(s)}return t.length>0?(t.sort((t,i)=>{const s=t=>Math.min(Math.abs(t.left-e.left),Math.abs(t.right-e.right))+200*Math.min(Math.abs(t.top-e.top),Math.abs(t.bottom-e.bottom));return s(t)-s(i)}),t[0]):new P.F(0,s,e.width,e.height)}moveTile(e,t){const i=this.tiles.find(t=>t.id===e);i&&(i.percentBounds=t,this.refreshTiles$.next())}HitTest(e){const t=new P.F(this.getPercentSize(e.left),this.getPercentSize(e.top),this.getPercentSize(e.width),this.getPercentSize(e.height));return this.tiles.filter(e=>e.percentBounds.intersectWith(t))}getPercentSize(e){return Math.round(100*e/this.hundredPercentWith)}dragEnter(e,t){if(!this.designMode||!this._container)return!1;const i=e.DejaTile;if(!i)return!1;const s=this._container.getBoundingClientRect(),{pageX:n,pageY:r}=t.originalEvent,o=n-s.left,a=r-s.top,d=i.clone();return d.isTemporary=!0,this.dragDropInfos$.next({enabled:!1,startX:o,startY:a,currentTile:d}),!0}startDrag(e,t,i){const s=this.saveLayout();let n;e.forEach(e=>{n=n?P.F.union(n,e.percentBounds):e.percentBounds,e.isDragging=!0}),this.dragRelativePosition=new Map,e.forEach(e=>this.dragRelativePosition.set(e.id,new P.E(e.percentBounds.left-n.left,e.percentBounds.top-n.top))),this.dragPageOffset=new P.E(t,i),this.dragOriginalPosition=new P.E(n.left,n.top),this.targetBounds=s.targetBounds=s.validBounds=n,this.originalLayout=s,this.validLayout=void 0}cancelDrag(e){this.clearMoveTimer(),Object(k.a)(e).pipe(Object(A.a)(e=>!!e),Object(I.a)(this.destroyed$)).subscribe(e=>{e.isDragging=!1,e.isDropping=!0}),this.originalLayout&&this.restoreLayout(this.originalLayout),this.endDrag()}drop(e){let t;if(this.clearMoveTimer(),this.validLayout){if(this.restoreLayout(this.validLayout),"move"!==this._cursor){const t=e[0];t.percentBounds=new P.F(this.validLayout.validBounds),t.isDragging=!1}else Object(k.a)(e).pipe(Object(A.a)(e=>!!e),Object(z.a)(e=>{const t=this.validLayout.validBounds.left+this.dragRelativePosition.get(e.id).left,i=this.validLayout.validBounds.top+this.dragRelativePosition.get(e.id).top;e.percentBounds=new P.F(t,i,e.percentBounds.width,e.percentBounds.height),e.isDragging=!1,e.isDropping=!0,e.isTemporary&&(this.tilesDic.delete(e.id),e.makeId(),this.tilesDic.set(e.id,e),this.addTiles([e]))}),Object(L.a)(1e3),Object(I.a)(this.destroyed$)).subscribe(e=>e.isDropping=!1);t=this.tiles.filter(e=>{var t;return!P.F.equals(e.percentBounds,null===(t=this.originalLayout[e.id])||void 0===t?void 0:t.bounds)}),this.endDrag()}else this.removeTemporaryTile(),this.cancelDrag(e);if(t){const e=new CustomEvent("DejaTilesEvent",{cancelable:!0});e.tiles=this.tiles,this.layoutChanged.next(e)}return t}endDrag(){this.originalLayout=void 0,this.validLayout=void 0,this.targetBounds=void 0,this.dragging$.next(!1),this.dragDropInfos$.next(null),this.dragTarget=void 0,this.copyTiles(null),this.refreshTiles$.next()}drag(e,t,i){const s=new P.E(t-this.dragPageOffset.left,i-this.dragPageOffset.top),n=s.left+this.getPixelSize(this.dragOriginalPosition.left),r=s.top+this.getPixelSize(this.dragOriginalPosition.top),o=this.getTileMinPixelSize(),a=this.getTileMaxPixelSize();if("move"!==this._cursor){const t=e[0],i=this.getPixelBounds(t.percentBounds),s=n+i.width,d=r+i.height,l=i.right,h=i.bottom;switch(this._cursor){case"nw-resize":i.left=Math.max(Math.min(n,i.right-o.width),i.right-a.width),i.right=l,i.top=Math.max(Math.min(r,i.bottom-o.height),i.bottom-a.height),i.bottom=h,this.size(t,new P.E(n,r),P.u.left+P.u.top);break;case"sw-resize":i.left=Math.max(Math.min(n,i.right-o.width),i.right-a.width),i.right=l,i.bottom=Math.max(Math.min(d,i.top+a.height),i.top+o.height),this.size(t,new P.E(n,d),P.u.left+P.u.bottom);break;case"w-resize":i.left=Math.max(Math.min(n,i.right-o.width),i.right-a.width),i.right=l,this.size(t,new P.E(n,0),P.u.left);break;case"ne-resize":i.right=Math.max(Math.min(s,i.left+a.width),i.left+o.width),i.top=Math.max(Math.min(r,i.bottom-o.height),i.bottom-a.height),i.bottom=h,this.size(t,new P.E(s,r),P.u.right+P.u.top);break;case"se-resize":i.right=Math.max(Math.min(s,i.left+a.width),i.left+o.width),i.bottom=Math.max(Math.min(d,i.top+a.height),i.top+o.height),this.size(t,new P.E(s,d),P.u.right+P.u.bottom);break;case"e-resize":i.right=Math.max(Math.min(s,i.left+a.width),i.left+o.width),this.size(t,new P.E(s,0),P.u.right);break;case"n-resize":i.top=Math.max(Math.min(r,i.bottom-o.height),i.bottom-a.height),i.bottom=h,this.size(t,new P.E(0,r),P.u.top);break;case"s-resize":i.bottom=Math.max(Math.min(d,i.top+a.height),i.top+o.height),this.size(t,new P.E(0,d),P.u.bottom)}t.pixelBounds=i}else e.forEach(e=>{e.pixelBounds=new P.F(n+this.getPixelSize(this.dragRelativePosition.get(e.id).left),r+this.getPixelSize(this.dragRelativePosition.get(e.id).top),this.getPixelSize(e.percentBounds.width),this.getPixelSize(e.percentBounds.height))}),this.dragTarget=new P.F(this.getPercentSize(n),this.getPercentSize(r),this.targetBounds.width,this.targetBounds.height),this.move()}addTiles(e){var t;if(!e||0===e.length)return;e.forEach(e=>{this.tiles.find(t=>t.id===e.id)||(this.tiles.find(t=>{var i;return e.percentBounds&&(null===(i=t.percentBounds)||void 0===i?void 0:i.intersectWith(e.percentBounds))})&&(e.percentBounds=void 0),e.percentBounds||(e.percentBounds=this.getFreePlace(e.idealBounds)),this.tiles.push(e),this.tilesDic.set(e.id,e))});const i=new CustomEvent("DejaTilesAddEvent",{cancelable:!0});i.tiles=this.tiles,i.added=e,i.cancel$=new E.a;const s=null===(t=this.clipboardService)||void 0===t?void 0:t.get("tiles-provider");let n;s&&(n=this.clipboardService.get("tiles"),n.forEach(e=>{e.isHidden=!0}));const r=()=>{n&&(s.next(n),this.clipboardService.clear())},o=e=>{r();const t=new CustomEvent("DejaTileAddedEvent",{cancelable:!1});t.tiles=this.tiles,t.added=e,this.tilesAdded.next(t)};let a;e.forEach(e=>{a=a?P.F.union(a,e.percentBounds):new P.F(e.percentBounds)}),this.refreshTiles$.next({ensureBounds:a}),this.contentAdding.next(i),i.defaultPrevented?(i.cancel$.pipe(Object(V.a)(1),Object(A.a)(e=>!e),Object(I.a)(this.destroyed$)).subscribe(o),i.cancel$.pipe(Object(V.a)(1),Object(A.a)(e=>!!e),Object(H.a)(()=>(n&&n.forEach(e=>{e.isHidden=!1,e.isCutted=!0}),Object(k.a)(e))),Object(z.a)(e=>e.isHidden=!0),Object(L.a)(1e3),Object(U.a)((e,t)=>Object(g.c)(e,[t]),new Array),Object(V.a)(1),Object(I.a)(this.destroyed$)).subscribe(e=>this.deleteTiles(e))):o(e)}size(e,t,i){const s=new P.E(this.getPercentSize(t.left),this.getPercentSize(t.top)),n=e.percentBounds.clone(),r=e.percentBounds.clone();let o,a,d,l;if(i&P.u.left){o=this.getTileMinPercentWidth(),d=this.getTileMaxPercentWidth();const e=s.left,t=n.left<e?o*Math.ceil(e/o):o*Math.floor(e/o),i=Math.min(d,Math.max(o,r.right-t));n.width=n.right-e,n.left=e,r.left=r.right-i,r.width=i}if(i&P.u.right){o=o||this.getTileMinPercentWidth(),d=d||this.getTileMaxPercentWidth();const e=s.left,t=n.right<e?o*Math.ceil(e/o):o*Math.floor(e/o);n.width=e-n.left,r.width=Math.min(d,Math.max(o,t-r.left))}if(i&P.u.top){a=this.getTileMinPercentHeight(),l=this.getTileMaxPercentHeight();const e=s.top,t=n.top<e?a*Math.ceil(e/a):a*Math.floor(e/a),i=Math.min(l,Math.max(a,r.bottom-t));n.height=n.bottom-e,n.top=e,r.top=r.bottom-i,r.height=i}if(i&P.u.bottom){a=a||this.getTileMinPercentHeight(),l=l||this.getTileMaxPercentHeight();const e=s.top,t=n.bottom<e?a*Math.ceil(e/a):a*Math.floor(e/a);n.height=e-n.top,r.height=Math.min(l,Math.max(a,t-r.top))}if(!P.F.equals(r,this.destination))if(this.restoreLayout(this.originalLayout),this.destination=r.clone(),this.tiles.find(e=>!e.isDragging&&e.percentBounds.intersectWith(r))){if(r){const e=this.ensureTarget(r,n,i);e&&(this.targetBounds=e,this.validLayout=this.saveLayout(),this.validLayout.targetBounds=r,this.validLayout.validBounds=e,this.refreshTiles$.next())}}else this.targetBounds=r,this.validLayout=this.saveLayout(),this.validLayout.targetBounds=this.validLayout.validBounds=r,this.refreshTiles$.next()}clearMoveTimer(){this.moveTimOut&&(this.moveTimOut.unsubscribe(),this.moveTimOut=void 0)}move(){const e=this.getTileMinPercentWidth(),t=this.getTileMinPercentHeight();let i=this.ensureContainer(new P.F(e*Math.round(this.dragTarget.left/e),t*Math.round(this.dragTarget.top/t),this.dragTarget.width,this.dragTarget.height));if(this.lastTargetBounds&&Math.abs(i.left-this.lastTargetBounds.left)<e&&Math.abs(i.top-this.lastTargetBounds.top)<t)return;this.lastTargetBounds=i;const s=this.tiles.filter(e=>!e.isDragging).reduce((e,t)=>{const s=P.F.overlapInfos(t.percentBounds,i);return Math.max(Math.min(s.height,s.width),e)},0);if(this.tiles.find(e=>{var t;return null===(t=this.originalLayout[e.id])||void 0===t?void 0:t.bounds.intersectWith(i)})||this.restoreLayout(this.originalLayout),0===s)this.clearMoveTimer(),this.targetBounds=i.clone(),this.destination=i.clone(),this.validLayout=this.saveLayout(),this.validLayout.targetBounds=this.validLayout.validBounds=i,this.refreshTiles$.next();else{if(P.F.equals(this.targetBounds,i)||this.clearMoveTimer(),s>3){const e=i.clone();this.moveTimOut=Object($.a)(500).pipe(Object(V.a)(1),Object(I.a)(this.destroyed$)).subscribe(()=>{this.restoreLayout(this.originalLayout),this.destination=e;const t=this.ensureTarget(e,this.dragTarget,P.u.all);t&&(this.targetBounds=t,this.validLayout=this.saveLayout(),this.validLayout.targetBounds=e,this.validLayout.validBounds=t,this.refreshTiles$.next())})}const e=new Array,t=this.tiles.filter(e=>!e.isDragging);for(let s=Math.min(this.targetBounds.left,i.left);s<=Math.max(this.targetBounds.left,i.left);s++)for(let n=Math.min(this.targetBounds.top,i.top);n<=Math.max(this.targetBounds.top,i.top);n++){const r=new P.F(s,n,i.width,i.height);t.find(e=>e.percentBounds.intersectWith(r))||e.push(r)}e.length>0&&(e.sort((e,t)=>{const s=e=>Math.min(Math.abs(e.left-i.left),Math.abs(e.right-i.right))+200*Math.min(Math.abs(e.top-i.top),Math.abs(e.bottom-i.bottom));return s(e)-s(t)}),i=e[0],this.targetBounds=i.clone(),this.destination=i.clone(),this.validLayout=this.saveLayout(),this.validLayout.targetBounds=this.validLayout.validBounds=i,this.refreshTiles$.next())}}ensureContainer(e){e.left<0&&(e=e.offset(-e.left,0)),e.top<0&&(e=e.offset(0,-e.top));const t=this.getMaxPercentWidth();t&&e.right>t&&(e=e.offset(t-e.right,0));const i=this.getMaxPercentHeight();return i&&e.bottom>i&&(e=e.offset(0,i-e.bottom)),e}ensureTarget(e,t,i,s,n=10){t||(t=e),s||(s=e.clone()),i||(i=P.u.all);const r=new Array,o=new Array,a=new Array,d=new Array;if(this.tiles.filter(t=>!t.isDragging&&t.percentBounds.intersectWith(e)).find(s=>{const n=new P.F(this.dragOriginalPosition.left,this.dragOriginalPosition.top,e.width,e.height);if(Math.abs(s.percentBounds.left-t.left)<1&&Math.abs(s.percentBounds.top-t.top)<1&&Math.abs(s.percentBounds.width-t.width)<1&&Math.abs(s.percentBounds.height-t.height)<1&&(Math.abs(t.left-n.right)<=4||Math.abs(t.right-n.left)<=4||Math.abs(t.top-n.bottom)<=4||Math.abs(t.bottom-n.top)<=4))return s.percentBounds=n,!0;{const e=s.percentBounds.left-t.left,n=t.right-s.percentBounds.right,l=s.percentBounds.top-t.top,h=t.bottom-s.percentBounds.bottom,c=Math.max(0,Math.min(s.percentBounds.right,t.right)-Math.max(s.percentBounds.left,t.left))/Math.min(s.percentBounds.width,t.width);let u;switch(Math.max(0,Math.min(s.percentBounds.bottom,t.bottom)-Math.max(s.percentBounds.top,t.top))/Math.min(s.percentBounds.height,t.height)>=c&&i&P.u.horizontal?u=n>=e&&i&P.u.left?P.u.left:P.u.right:i&P.u.vertical&&(u=h>=l&&i&P.u.top?P.u.top:P.u.bottom),u){case P.u.left:r.push(s);break;case P.u.top:a.push(s);break;case P.u.right:o.push(s);break;default:d.push(s)}}}))return e;let l=0;return r.length&&(l=this.pushHorizontal(e,-1,r),l)?(e=this.ensureContainer(e.offset(l,0)),n?this.ensureTarget(e,t,i&~P.u.left,s,n-1):null):(o.length&&(l=this.pushHorizontal(e,1,o)),l>0?(this.restoreLayout(this.originalLayout),n?this.ensureTarget(s,t,i&P.u.vertical,void 0,n-1):null):a.length&&(l=this.pushVertical(e,-1,a),l)?(e=this.ensureContainer(e.offset(0,l)),n?this.ensureTarget(e,t,P.u.bottom,void 0,n-1):null):(l=this.pushVertical(e,1,d),l?null:e))}saveLayout(){const e={};return e.height=this.getTileMinPercentHeight(),this.tiles.forEach(t=>{const i=this.getPixelSize(t.percentBounds.top||0),s=this.getPixelSize(t.percentBounds.height||this._tileMinHeight);i+s>e.height&&(e.height=i+s),e[t.id]={bounds:t.percentBounds.clone(),id:t.id}}),e}getPixelBounds(e){return P.F.fromLTRB(Math.round(e.left*this.hundredPercentWith/100),Math.round(e.top*this.hundredPercentWith/100),Math.round(e.right*this.hundredPercentWith/100),Math.round(e.bottom*this.hundredPercentWith/100))}getPixelSize(e,t){return t&&"%"!==t?e:Math.round(e*this.hundredPercentWith/100)}getSizePercentLimit(e){const t=this[e+"Unit"];return t&&"px"!==t?this[e]:this.getPercentSize(this[e])}getSizePixelLimit(e){const t=this[e+"Unit"];return t&&"px"!==t?this.getPixelSize(this[e]):this[e]}getTileMinPixelSize(){return new P.H(this.getSizePixelLimit("_tileMinWidth"),this.getSizePixelLimit("_tileMinHeight"))}getTileMaxPixelSize(){return new P.H(this.getSizePixelLimit("_tileMaxWidth"),this.getSizePixelLimit("_tileMaxHeight"))}getTileMinPercentWidth(){return Math.max(1,this.getSizePercentLimit("_tileMinWidth"))}getTileMaxPercentWidth(){return Math.max(5,this.getSizePercentLimit("_tileMaxWidth"))}getTileMinPercentHeight(){return Math.max(1,this.getSizePercentLimit("_tileMinHeight"))}getTileMaxPercentHeight(){return Math.max(5,this.getSizePercentLimit("_tileMaxHeight"))}getMaxPercentWidth(){return Math.max(5,this.getSizePercentLimit("_maxWidth"))}getMaxPercentHeight(){return Math.max(5,this.getSizePercentLimit("_maxHeight"))}getCursorFromHTMLElement(e,t,i){const s=this.getTileElementFromHTMLElement(i);if(!s)return null;const n=s.getBoundingClientRect();return e<n.left+15?t<n.top+15?"nw-resize":t>n.bottom-15?"sw-resize":"w-resize":e>n.right-15?t<n.top+15?"ne-resize":t>n.bottom-15?"se-resize":"e-resize":t<n.top+15?"n-resize":t>n.bottom-15?"s-resize":"move"}extractValueAndUnit(e,t){var i;const s=/(\d+)(.*)/i.exec(t);if((null===(i=s)||void 0===i?void 0:i.length)>=1){const t=this;t[e]=parseInt(s[1],10),t[e+"Unit"]=s.length>=2?s[2]:"px"}}restoreLayout(e){this.tiles.forEach(t=>{const i=e[t.id];i&&(t.percentBounds=i.bounds.clone())})}calcHorizontalOverflow(e,t,i,s){let n=0;return s=s||new Set,t.forEach(t=>{if(!s.has(t.id)){s.add(t.id);const r=t.percentBounds.offset(e*i,0);let o=0;const a=this.getMaxPercentWidth();r.left<0?o=-r.left:a&&r.right>a&&(o=r.right-a);const d=this.tiles.filter(e=>!e.isDragging&&!e.equalsTo(t)&&e.percentBounds.intersectWith(r));d.length&&(o+=this.calcHorizontalOverflow(e,d,i,s)),o>n&&(n=o)}}),n}moveHorizontal(e,t,i,s){t.forEach(t=>{if(!s.has(t.id)){const n=t.percentBounds.offset(e*i,0);s.set(t.id,n);const r=this.tiles.filter(e=>!e.isDragging&&!e.equalsTo(t)&&e.percentBounds.intersectWith(n));r.length&&this.moveHorizontal(e,r,i,s)}})}pushHorizontal(e,t,i,s){let n=0;const r=new Map;return s||(s=0,i.forEach(i=>{const n=t>0?Math.max(0,e.right-i.percentBounds.left):Math.max(0,i.percentBounds.right-e.left);n>s&&(s=n)})),s>0&&(n=this.calcHorizontalOverflow(t,i,s),(s-=n)>0&&(this.moveHorizontal(t,i,s,r),this.tiles.forEach(e=>{r.has(e.id)&&(e.percentBounds=r.get(e.id))}))),n}calcVerticalOverflow(e,t,i,s){let n=0;return s=s||new Set,t.forEach(t=>{if(!s.has(t.id)){s.add(t.id);const r=t.percentBounds.offset(0,e*i);let o=0;const a=this.getMaxPercentHeight();r.top<0?o=-r.top:a&&r.bottom>a&&(o=r.bottom-a);const d=this.tiles.filter(e=>!e.isDragging&&!e.equalsTo(t)&&e.percentBounds.intersectWith(r));d.length&&(o+=this.calcVerticalOverflow(e,d,i,s)),o>n&&(n=o)}}),n}moveVertical(e,t,i,s){t.forEach(t=>{if(!s.has(t.id)){const n=t.percentBounds.offset(0,e*i);s.set(t.id,n);const r=this.tiles.filter(e=>!e.isDragging&&!e.equalsTo(t)&&e.percentBounds.intersectWith(n));r.length&&this.moveVertical(e,r,i,s)}})}pushVertical(e,t,i,s){let n=0;const r=new Map;return s||(s=0,i.forEach(i=>{const n=t>0?Math.max(0,e.bottom-i.percentBounds.top):Math.max(0,i.percentBounds.bottom-e.top);n>s&&(s=n)})),s>0&&(n=this.calcVerticalOverflow(t,i,s),(s-=n)>0&&(this.moveVertical(t,i,s,r),this.tiles.forEach(e=>r.has(e.id)&&(e.percentBounds=r.get(e.id))))),n}copyTiles(e,t){if(!this.clipboardService){if(!e)return;throw new Error("DejaClipboardService must be imported by your application to use the copyTiles methode of DejaTilesComponent.")}const i=this.clipboardService.get("tiles");i&&i.forEach(e=>e.isCutted=!1),this.clipboardService.set("tiles",e),t?(e.forEach(e=>e.isCutted=!0),this.clipboardService.set("tiles-provider",this.deleteTiles$)):this.clipboardService.set("tiles-provider",void 0)}removeTemporaryTile(){let e=this.tiles.length;for(;--e>=0;){const t=this.tiles[e];t.isTemporary&&(this.tilesDic.delete(t.id),this.tiles.splice(e,1))}}};return e.\u0275fac=function(t){return new(t||e)(p["\u0275\u0275inject"](P.e,8))},e.\u0275prov=p["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac}),e})(),te=(()=>{let e=class extends P.s{constructor(e,t,i,s){super(),this.changeDetectorRef=t,this.layoutProvider=i,this._control=s,this.selectionChanged=new p.EventEmitter,this.layoutChanged=new p.EventEmitter,this.layoutCompleted=new p.EventEmitter,this.contentAdding=new p.EventEmitter,this.contentRemoving=new p.EventEmitter,this.tilesAdded=new p.EventEmitter,this.tilesDeleted=new p.EventEmitter,this.contentCopied=new p.EventEmitter,this.tabIndex=0,this._models=[],this.hasFocus=!1,this.onTouchedCallback=e=>{},this.onChangeCallback=e=>{},this._control&&(this._control.valueAccessor=this);const n=e.nativeElement;Object(k.a)(this.layoutProvider.selectionChanged).pipe(Object(I.a)(this.destroyed$)).subscribe(e=>this.selectionChanged.emit(e)),Object(k.a)(this.layoutProvider.contentAdding).pipe(Object(I.a)(this.destroyed$)).subscribe(e=>this.contentAdding.emit(e)),Object(k.a)(this.layoutProvider.contentRemoving).pipe(Object(I.a)(this.destroyed$)).subscribe(e=>this.contentRemoving.emit(e)),Object(k.a)(this.layoutProvider.tilesAdded).pipe(Object(I.a)(this.destroyed$)).subscribe(e=>{this.tilesAdded.emit(e),this.onChangeCallback(e.tiles)}),Object(k.a)(this.layoutProvider.tilesDeleted).pipe(Object(I.a)(this.destroyed$)).subscribe(e=>{this.tilesDeleted.emit(e),this.onChangeCallback(e.tiles)}),Object(k.a)(this.layoutProvider.layoutChanged).pipe(Object(I.a)(this.destroyed$)).subscribe(e=>{this.layoutChanged.emit(e),this.onChangeCallback(e.tiles)}),Object(k.a)(this.layoutProvider.layoutCompleted).pipe(Object(I.a)(this.destroyed$)).subscribe(e=>this.layoutCompleted.emit(e)),this.keyup$=Object(S.a)(n.ownerDocument,"keyup"),Object(S.a)(window,"resize").pipe(Object(F.a)(5),Object(I.a)(this.destroyed$)).subscribe(()=>this.refresh({resetWidth:!0}))}get tiles(){return this.layoutProvider.tiles}get selectionRect$(){return this.layoutProvider.selectionRect$}set tileminwidth(e){this.layoutProvider.tileMinWidth=e}set tilemaxwidth(e){this.layoutProvider.tileMaxWidth=e}set tileminheight(e){this.layoutProvider.tileMinHeight=e}set tilemaxheight(e){this.layoutProvider.tileMaxHeight=e}set maxwidth(e){this.layoutProvider.maxWidth=e}set designMode(e){this.layoutProvider.designMode=Object(f.b)(e)}get designMode(){return this.layoutProvider.designMode}set models(e){this.writeValue(e)}set canDelete(e){Object(f.b)(e)&&!this.delete$sub?this.delete$sub=this.keyup$.pipe(Object(A.a)(e=>this.layoutProvider.designMode&&e.code===P.A.Delete&&this.hasFocus),Object(I.a)(this.destroyed$)).subscribe(()=>this.layoutProvider.deleteSelection()):this.delete$sub&&(this.delete$sub.unsubscribe(),this.delete$sub=void 0)}set canCopy(e){Object(f.b)(e)&&!this.copy$sub?this.copy$sub=this.keyup$.pipe(Object(A.a)(e=>e.code===P.A.KeyC&&e.ctrlKey&&this.hasFocus),Object(I.a)(this.destroyed$)).subscribe(()=>this.copySelection()):this.copy$sub&&(this.copy$sub.unsubscribe(),this.copy$sub=void 0)}set canCut(e){Object(f.b)(e)&&!this.cut$sub?this.cut$sub=this.keyup$.pipe(Object(A.a)(e=>this.layoutProvider.designMode&&e.code===P.A.KeyX&&e.ctrlKey&&this.hasFocus),Object(I.a)(this.destroyed$)).subscribe(()=>this.cutSelection()):this.cut$sub&&(this.cut$sub.unsubscribe(),this.cut$sub=void 0)}set canPaste(e){Object(f.b)(e)&&!this.paste$sub?this.paste$sub=this.keyup$.pipe(Object(A.a)(e=>this.layoutProvider.designMode&&e.code===P.A.KeyV&&e.ctrlKey&&this.hasFocus),Object(I.a)(this.destroyed$)).subscribe(()=>this.paste()):this.paste$sub&&(this.paste$sub.unsubscribe(),this.paste$sub=void 0)}set selectedTiles(e){this.layoutProvider.selectedTiles=e.map(e=>"string"==typeof e?e:e.id)}writeValue(e){this._models=e||[],this.layoutProvider.tiles=this._models,this.changeDetectorRef.markForCheck()}registerOnChange(e){this.onChangeCallback=e}registerOnTouched(e){this.onTouchedCallback=e}ngAfterViewInit(){this.layoutProvider.container=this.tilesContainer.nativeElement,this.refresh({resetWidth:!0})}ngOnDestroy(){super.ngOnDestroy(),this.canCopy=!1,this.canCut=!1,this.canDelete=!1,this.canPaste=!1}copySelection(){var e;const t=this.layoutProvider.copySelection();if(null===(e=t)||void 0===e?void 0:e.length){const e=new CustomEvent("DejaTilesCopied",{cancelable:!0});e.tiles=t,this.contentCopied.emit(e)}}cutSelection(){var e;const t=this.layoutProvider.cutSelection();if(null===(e=t)||void 0===e?void 0:e.length){const e=new CustomEvent("DejaTilesCutted",{cancelable:!0});e.tiles=t,this.contentCopied.emit(e)}}deleteSelection(){const e=this.layoutProvider.deleteSelection();return this.changeDetectorRef.markForCheck(),e}paste(){const e=this.layoutProvider.paste();return this.changeDetectorRef.markForCheck(),e}ensureVisible(e){this.layoutProvider.ensureVisible$.next(e)}refresh(e){this.layoutProvider.refreshTiles$.next(e)}addTiles(e){this.layoutProvider.addTiles(e)}removeTiles(e){this.layoutProvider.removeTiles(e)}HitTest(e,t){const i=this.tilesContainer.nativeElement.getBoundingClientRect(),s=e-i.left,n=t-i.top;return this.tiles.find(e=>{var t;return null===(t=e.pixelBounds)||void 0===t?void 0:t.containsPoint(new P.E(s,n))})}getFreePlace(e,t,i,s){if(!this._models||0===this._models.length)return new P.F(0,0,i,s);const n=this.tilesContainer.nativeElement.getBoundingClientRect(),r=t?t-n.top:0,o=new P.F(this.layoutProvider.getPercentSize(e?e-n.left:0),this.layoutProvider.getPercentSize(r),i,s);return this.layoutProvider.getFreePlace(o)}moveTile(e,t){this.layoutProvider.moveTile(e,t)}getDropContext(){return{dragEnter:(e,t)=>this.layoutProvider.dragEnter(e,t)&&{className:"hidden"},dragOver:(e,t)=>{this.layoutProvider.dragover$.next(t)},dragLeave:e=>{this.layoutProvider.dragleave$.next()}}}onTileClosed(e){this.layoutProvider.removeTiles([e.id])}onFocus(){this.hasFocus=!0}onBlur(){this.hasFocus=!1}};return e.\u0275fac=function(t){return new(t||e)(p["\u0275\u0275directiveInject"](p.ElementRef),p["\u0275\u0275directiveInject"](p.ChangeDetectorRef),p["\u0275\u0275directiveInject"](ee),p["\u0275\u0275directiveInject"](n.NgControl,10))},e.\u0275cmp=p["\u0275\u0275defineComponent"]({type:e,selectors:[["deja-tiles"]],contentQueries:function(e,t,i){var s;1&e&&p["\u0275\u0275contentQuery"](i,Y,!0),2&e&&p["\u0275\u0275queryRefresh"](s=p["\u0275\u0275loadQuery"]())&&(t.tileTemplate=s.first)},viewQuery:function(e,t){var i;1&e&&p["\u0275\u0275staticViewQuery"](K,!0),2&e&&p["\u0275\u0275queryRefresh"](i=p["\u0275\u0275loadQuery"]())&&(t.tilesContainer=i.first)},inputs:{tabIndex:"tabIndex",tileminwidth:"tileminwidth",tilemaxwidth:"tilemaxwidth",tileminheight:"tileminheight",tilemaxheight:"tilemaxheight",maxwidth:"maxwidth",designMode:"designMode",models:"models",canDelete:"canDelete",canCopy:"canCopy",canCut:"canCut",canPaste:"canPaste",selectedTiles:"selectedTiles"},outputs:{selectionChanged:"selectionChanged",layoutChanged:"layoutChanged",layoutCompleted:"layoutCompleted",contentAdding:"contentAdding",contentRemoving:"contentRemoving",tilesAdded:"tilesAdded",tilesDeleted:"tilesDeleted",contentCopied:"contentCopied"},features:[p["\u0275\u0275ProvidersFeature"]([ee]),p["\u0275\u0275InheritDefinitionFeature"]],decls:5,vars:8,consts:[["id","tiles",3,"deja-mouse-droppable","focus","blur"],["tilesContainer",""],[3,"id","tile","designMode","template","close",4,"ngFor","ngForOf"],["deja-tile-position","",3,"bounds"],[3,"id","tile","designMode","template","close"]],template:function(e,t){1&e&&(p["\u0275\u0275elementStart"](0,"div",0,1),p["\u0275\u0275listener"]("focus",(function(){return t.onFocus()}))("blur",(function(){return t.onBlur()})),p["\u0275\u0275template"](2,G,1,5,"deja-tile",2),p["\u0275\u0275element"](3,"div",3),p["\u0275\u0275pipe"](4,"async"),p["\u0275\u0275elementEnd"]()),2&e&&(p["\u0275\u0275classProp"]("design",t.designMode),p["\u0275\u0275property"]("deja-mouse-droppable",t.getDropContext()),p["\u0275\u0275attribute"]("tabindex",t.tabIndex),p["\u0275\u0275advance"](2),p["\u0275\u0275property"]("ngForOf",t.tiles),p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("bounds",p["\u0275\u0275pipeBind1"](4,6,t.selectionRect$)))},directives:[c.d,s.m,J,Z],pipes:[s.b],styles:["[_nghost-%COMP%]{position:relative;overflow:auto;margin:0!important}[_nghost-%COMP%]   #tiles[_ngcontent-%COMP%]{display:block;left:0;top:0;width:100%;height:100%;position:absolute;padding:0!important;margin:0!important}[_nghost-%COMP%]   #tiles.design[_ngcontent-%COMP%]   deja-tile[_ngcontent-%COMP%]{background-color:rgba(0,0,0,.1)}[_nghost-%COMP%]   #tiles[_ngcontent-%COMP%]   #tile[_ngcontent-%COMP%]:hover{z-index:200}[_nghost-%COMP%]   [deja-tile-position][_ngcontent-%COMP%]{position:absolute;z-index:101;background-color:rgba(0,0,0,.5)}[drag][_nghost-%COMP%]{background-color:rgba(0,0,0,.5)}[drag][_nghost-%COMP%]   [deja-tile-position][_ngcontent-%COMP%]{transition-property:left,top,width,height;transition-duration:.35s;transition-timing-function:ease}"],changeDetection:0}),e})(),ie=(()=>{let e=class{};return e.\u0275mod=p["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=p["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[s.c,n.FormsModule,c.b,_]]}),e})();var se=i("KYkd"),ne=i("iInd"),re=i("Kqap"),oe=i("xbPD"),ae=i("1XgV"),de=i("iss+");function le(e,t){1&e&&(p["\u0275\u0275elementStart"](0,"mat-card",5),p["\u0275\u0275element"](1,"deja-markdown",6),p["\u0275\u0275elementEnd"]()),2&e&&(p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("url","https://raw.githubusercontent.com/DSI-HUG/dejajs-components/dev/projects/deja-js/component/tiles/readme.txt"))}function he(e,t){if(1&e){const e=p["\u0275\u0275getCurrentView"]();p["\u0275\u0275elementStart"](0,"button",11),p["\u0275\u0275listener"]("click",(function(){return p["\u0275\u0275restoreView"](e),p["\u0275\u0275nextContext"](2).$implicit.cancel(!1)})),p["\u0275\u0275text"](1," Ok "),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementStart"](2,"button",12),p["\u0275\u0275listener"]("click",(function(){return p["\u0275\u0275restoreView"](e),p["\u0275\u0275nextContext"](2).$implicit.cancel(!0)})),p["\u0275\u0275text"](3," Annuler "),p["\u0275\u0275elementEnd"]()}}function ce(e,t){if(1&e){const e=p["\u0275\u0275getCurrentView"]();p["\u0275\u0275elementStart"](0,"deja-snackbar",8),p["\u0275\u0275listener"]("onAnimationDone",(function(){return p["\u0275\u0275restoreView"](e),p["\u0275\u0275nextContext"]().$implicit.cancel(!1)})),p["\u0275\u0275elementStart"](1,"deja-message-box",9),p["\u0275\u0275text"](2),p["\u0275\u0275template"](3,he,4,0,"ng-template",null,10,p["\u0275\u0275templateRefExtractor"]),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"]()}if(2&e){const e=p["\u0275\u0275nextContext"]().$implicit;p["\u0275\u0275property"]("duration",8e3),p["\u0275\u0275advance"](1),p["\u0275\u0275propertyInterpolate"]("type",e.type),p["\u0275\u0275propertyInterpolate"]("title",e.title),p["\u0275\u0275advance"](1),p["\u0275\u0275textInterpolate1"](" ",e.content," ")}}function ue(e,t){1&e&&p["\u0275\u0275template"](0,ce,5,4,"deja-snackbar",7),2&e&&p["\u0275\u0275property"]("ngIf",t.$implicit.gate)}function ge(e,t){if(1&e&&(p["\u0275\u0275elementStart"](0,"div",23),p["\u0275\u0275text"](1),p["\u0275\u0275elementStart"](2,"span",24),p["\u0275\u0275text"](3,"Selected"),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementStart"](4,"span",25),p["\u0275\u0275text"](5,"Pressed"),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;p["\u0275\u0275styleProp"]("background-color",e.color),p["\u0275\u0275advance"](1),p["\u0275\u0275textInterpolate2"]("",e.templateModel.naqme," (",e.templateModel.code,") ")}}function pe(e,t){if(1&e&&(p["\u0275\u0275elementStart"](0,"div",23),p["\u0275\u0275text"](1),p["\u0275\u0275elementStart"](2,"span",24),p["\u0275\u0275text"](3,"Selected"),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementStart"](4,"span",25),p["\u0275\u0275text"](5,"Pressed"),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;p["\u0275\u0275styleProp"]("background-color",e.color),p["\u0275\u0275advance"](1),p["\u0275\u0275textInterpolate2"]("",e.templateModel.naqme," (",e.templateModel.code,") ")}}function me(e,t){if(1&e){const e=p["\u0275\u0275getCurrentView"]();p["\u0275\u0275elementStart"](0,"mat-card",5),p["\u0275\u0275elementStart"](1,"mat-toolbar",13),p["\u0275\u0275text"](2,"Tiles Demo"),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementStart"](3,"mat-card-content",14),p["\u0275\u0275elementStart"](4,"mat-checkbox",15),p["\u0275\u0275listener"]("ngModelChange",(function(t){return p["\u0275\u0275restoreView"](e),p["\u0275\u0275nextContext"]().designMode=t})),p["\u0275\u0275text"](5,"Design Mode"),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementStart"](6,"mat-card-content"),p["\u0275\u0275elementStart"](7,"span",16,17),p["\u0275\u0275text"](9," Drop Area "),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementStart"](10,"mat-card-content"),p["\u0275\u0275elementStart"](11,"deja-tiles",18,19),p["\u0275\u0275listener"]("contentAdding",(function(t){return p["\u0275\u0275restoreView"](e),p["\u0275\u0275nextContext"]().onContentAdding(t)}))("contentRemoving",(function(t){return p["\u0275\u0275restoreView"](e),p["\u0275\u0275nextContext"]().onContentRemoving(t)})),p["\u0275\u0275pipe"](13,"async"),p["\u0275\u0275template"](14,ge,6,4,"ng-template",null,20,p["\u0275\u0275templateRefExtractor"]),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementStart"](16,"mat-card-content"),p["\u0275\u0275elementStart"](17,"deja-tiles",21,22),p["\u0275\u0275listener"]("contentAdding",(function(t){return p["\u0275\u0275restoreView"](e),p["\u0275\u0275nextContext"]().onContentAdding(t)}))("contentRemoving",(function(t){return p["\u0275\u0275restoreView"](e),p["\u0275\u0275nextContext"]().onContentRemoving(t)})),p["\u0275\u0275pipe"](19,"async"),p["\u0275\u0275template"](20,pe,6,4,"ng-template",null,20,p["\u0275\u0275templateRefExtractor"]),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"]()}if(2&e){const e=p["\u0275\u0275reference"](8),t=p["\u0275\u0275nextContext"]();p["\u0275\u0275advance"](4),p["\u0275\u0275property"]("ngModel",t.designMode),p["\u0275\u0275advance"](3),p["\u0275\u0275property"]("deja-mouse-droppable",t.getDropContext(e)),p["\u0275\u0275advance"](4),p["\u0275\u0275property"]("models",p["\u0275\u0275pipeBind1"](13,6,t.tiles1$))("deja-mouse-draggable",t.getDragContext()),p["\u0275\u0275advance"](6),p["\u0275\u0275property"]("models",p["\u0275\u0275pipeBind1"](19,8,t.tiles2$))("designMode",t.designMode)}}const fe=ne.f.forChild([{path:"",component:(()=>{class e{constructor(e){this.countriesService=e,this.tabIndex=1,this.designMode=!1,this.message$=new E.a,this.messages$=Object(k.a)(this.message$).pipe(Object(re.a)((e,t)=>[...e,t],[]),Object(oe.a)([]))}ngOnInit(){let e=0,t=0,i=0,s=0;this.countriesMap=new Map;const n=this.countriesService.getCountries$().pipe(Object(H.a)(e=>e));this.tiles1$=n.pipe(Object(V.a)(12),Object(W.a)(i=>{const s=new Q;return s.percentBounds=new P.F(e,t,15,15),s.color=i.color,s.templateModel=i,e+=15,e+15>100&&(e=0,t+=15),this.countriesMap.set(s.id,i),s}),Object(U.a)((e,t)=>[...e,t],[])),this.tiles2$=n.pipe(Object(W.a)(e=>{const t=new Q;return t.percentBounds=new P.F(i,s,15,15),t.color=e.color,t.templateModel=e,i+=15,i+15>100&&(i=0,s+=15),t}),Object(U.a)((e,t)=>[...e,t],[]))}getDragContext(){return{target:"deja-tile",className:"deja-tile-cursor",dragStart:e=>{const t=this.countriesMap.get(e.id),i=new Q;return i.percentBounds=new P.F(0,0,15,15),i.color=t.color,i.templateModel=t,{country:t,DejaTile:i}}}}getDropContext(e){return{dragEnter:e=>({width:200,height:60,className:"country-target-cursor"}),drop:t=>{const i=t.country;e.innerText=`The dropped country is ${i.naqme} - the code is: ${i.code}`}}}onContentAdding(e){this.message$.next({title:"Tiles added",content:e.added.length+" tiles added.",type:"warn",gate:!0,cancel:function(t){this.gate=!1,e.cancel$.next(t)}}),e.preventDefault()}onContentRemoving(e){this.message$.next({title:"Tiles deleted",content:e.removed.length+" tiles deleted.",type:"warn",gate:!0,cancel:function(t){this.gate=!1,e.cancel$.next(t)}}),e.preventDefault()}}return e.\u0275fac=function(t){return new(t||e)(p["\u0275\u0275directiveInject"](ae.a))},e.\u0275cmp=p["\u0275\u0275defineComponent"]({type:e,selectors:[["deja-tiles-demo"]],decls:8,vars:6,consts:[[3,"selectedIndex","selectedTabChange"],["label","API REFERENCE"],["label","EXAMPLES"],["class","demo-card demo-basic",4,"ngIf"],["ngFor","",3,"ngForOf"],[1,"demo-card","demo-basic"],[3,"url"],["alignment","bottom right",3,"duration","onAnimationDone",4,"ngIf"],["alignment","bottom right",3,"duration","onAnimationDone"],[3,"type","title"],["actionsTemplate",""],["mat-raised-button","","color","primary",3,"click"],["mat-raised-button","",3,"click"],["color","primary"],["id","actions"],[3,"ngModel","ngModelChange"],["id","droparea",3,"deja-mouse-droppable"],["dropArea",""],["id","tiles1","maxwidth","100%","tileminwidth","5%","tileminheight","5%","tilemaxheight","50%","tilemaxwidth","50%",3,"models","deja-mouse-draggable","contentAdding","contentRemoving"],["tiles1",""],["tileTemplate",""],["id","tiles2","canDelete","","canCopy","","canCut","","canPaste","","maxwidth","100%","tileminwidth","5%","tileminheight","5%","tilemaxheight","50%","tilemaxwidth","50%",3,"models","designMode","contentAdding","contentRemoving"],["tiles2",""],[1,"tile-content","noselect"],["id","selected"],["id","pressed"]],template:function(e,t){1&e&&(p["\u0275\u0275elementStart"](0,"mat-tab-group",0),p["\u0275\u0275listener"]("selectedTabChange",(function(e){return t.tabIndex=e.index})),p["\u0275\u0275element"](1,"mat-tab",1),p["\u0275\u0275element"](2,"mat-tab",2),p["\u0275\u0275elementEnd"](),p["\u0275\u0275template"](3,le,2,1,"mat-card",3),p["\u0275\u0275template"](4,ue,1,1,"ng-template",4),p["\u0275\u0275pipe"](5,"async"),p["\u0275\u0275template"](6,me,22,10,"mat-card",3),p["\u0275\u0275element"](7,"deja-mouse-dragdrop-cursor")),2&e&&(p["\u0275\u0275property"]("selectedIndex",t.tabIndex),p["\u0275\u0275advance"](3),p["\u0275\u0275property"]("ngIf",0===t.tabIndex),p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("ngForOf",p["\u0275\u0275pipeBind1"](5,4,t.messages$)),p["\u0275\u0275advance"](2),p["\u0275\u0275property"]("ngIf",1===t.tabIndex))},directives:[d.b,d.a,s.n,s.m,c.a,o.a,de.a,u.a,h.a,r.b,l.a,o.c,a.a,n.NgControlStatus,n.NgModel,c.d,te,c.c],pipes:[s.b],styles:["deja-tiles-demo .demo-basic{padding:0}deja-tiles-demo .demo-full-width{width:100%}deja-tiles-demo .demo-icons{font-size:100%;height:inherit;vertical-align:top;width:inherit}deja-tiles-demo .demo-card{margin:16px}deja-tiles-demo .demo-card mat-card-content{display:flex;flex-direction:column;margin:2rem}deja-tiles-demo #actions{display:flex;flex-direction:row;align-items:center;justify-content:space-between}deja-tiles-demo #droparea{height:5rem;background-color:#f57c00;width:50%;display:block}deja-tiles-demo #tiles1{height:370px;display:block}deja-tiles-demo #tiles2{height:1000px;display:block}deja-tiles-demo deja-tile{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}deja-tiles-demo deja-tile #pressed,deja-tiles-demo deja-tile #selected{display:none}deja-tiles-demo deja-tile[pressed] #pressed,deja-tiles-demo deja-tile[selected] #selected{display:block}deja-tiles-demo deja-tile .tile-content{width:100%;height:100%;display:block}@media screen and (min-width:1401px){deja-tiles-demo deja-tiles{font-size:100%}}@media screen and (max-width:1400px){deja-tiles-demo deja-tiles{font-size:90%}}@media screen and (max-width:1200px){deja-tiles-demo deja-tiles{font-size:85%}}@media screen and (max-width:768px){deja-tiles-demo deja-tiles{font-size:80%}}@media screen and (max-width:640px){deja-tiles-demo deja-tiles{font-size:70%}}@media screen and (max-width:320px){deja-tiles-demo deja-tiles{font-size:60%}}.country-target-cursor .tile-content,.deja-tile-cursor .tile-content{width:100%;height:100%;display:block;opacity:.8}.country-target-cursor .tile-content{background-color:#f4a460!important}"],encapsulation:2}),e})()},{path:"**",redirectTo:"",pathMatch:"full"}]);i.d(t,"DejaTilesDemoModule",(function(){return be}));let be=(()=>{class e{}return e.\u0275mod=p["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=p["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},providers:[],imports:[[s.c,n.FormsModule,o.d,d.c,l.b,r.c,a.b,ie,se.a,u.b,c.b,h.b,fe]]}),e})()}}]);