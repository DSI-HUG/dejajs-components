(self.webpackChunkdejajs_component=self.webpackChunkdejajs_component||[]).push([[990],{43990:function(e,t,i){"use strict";i.r(t),i.d(t,{DejaEditorDemoModule:function(){return J}});var n=i(61511),s=i(16073),o=i(15980),r=i(27439),a=i(66283),d=i(26756),l=i(55109),c=i(33104),h=i(31572),u=i(19861),g=i(27312),p=i(67676),f=i(19764),m=i(81110),T=i(55959),x=i(3530),C=i(90611),y=i(66599),b=i(60509),_=i(25416),E=i(65481),v=i(71522);const Z=["host"];let A=(()=>{class e{initDejaEditorLib(){return this._loading||this.init(),this._loader}init(){this._loader=new Promise(e=>{this._loading=!0;const t=window;if(!t.ckeditor){const i=(document.getElementsByTagName("base")[0]||{}).href,n=t.CKEDITOR_BASEPATH||`${i}assets/ckeditor/`,s=document.createElement("script");document.head.appendChild(s),s.type="text/javascript",s.src=`${n}ckeditor.js`,s.addEventListener("load",e)}})}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=h.Yz7({token:e,factory:e.\u0275fac}),e})(),N=(()=>{class e extends g.yl{constructor(e,t,i){super(),this.zone=e,this.changeDetectorRef=t,this.initializer=i,this.change=new h.vpe,this.ready=new h.vpe,this.blur=new h.vpe,this.focus=new h.vpe,this.disabled=new h.vpe,this._inline=!0,this._value=""}set readonly(e){this._readonly=(0,u.Ig)(e)}get readonly(){return this._readonly}set inline(e){this._inline=(0,u.Ig)(e)}get inline(){return this._inline}get value(){return this._value}set value(e){e!==this._value&&(this._value=e)}ngOnChanges(e){e.readonly&&this.instance&&this.instance.setReadOnly(e.readonly.currentValue)}ngOnDestroy(){if(super.ngOnDestroy(),this.focus.complete(),this.blur.complete(),this.change.complete(),this.disabled.complete(),this.instance)if(this.instance.focusManager.blur(!0),this._ready){try{this.instance.destroy()}catch(e){console.warn(e,"Error occurred when destroying ckEditor instance")}this.ready.complete(),this.instance=null}else this.ready.pipe((0,x.P)()).subscribe(()=>{try{this.instance.destroy()}catch(e){console.warn(e,"Error occurred when destroying ckEditor instance")}this.instance=null,this.ready.complete()})}ngAfterViewInit(){(0,f.D)(this.initializer.initDejaEditorLib()).pipe((0,C.q)(1),(0,y.b)(()=>this.ckeditorInit((0,p.Z)(this.config)||{})),(0,b.g)(0),(0,_.R)(this.destroyed$)).subscribe(()=>this.changeDetectorRef.markForCheck())}updateValue(){this.zone.run(()=>{let e=this.instance.getData();e||(e=null),this.value!==e&&(this.value=e,this.onChange(e),this.change.emit(e))})}textAreaChange(){this.zone.run(()=>{const e=this.host.nativeElement.value;this.onChange(e),this.change.emit(e)})}ckeditorInit(e){var t;if("undefined"==typeof CKEDITOR)console.warn("CKEditor 4.x is missing (http://ckeditor.com/)");else{if(this.instance)return;this.readonly&&(e.readOnly=this.readonly);const i=null===(t=e.on)||void 0===t?void 0:t.key;e.on||(e.on={}),e.on.key=e=>{1114177===e.data.code&&(e.cancel(),e.stop(),this.instance.document.$.execCommand("SelectAll")),i&&i(e)},this.instance=this.inline?CKEDITOR.inline(this.host.nativeElement,e):CKEDITOR.replace(this.host.nativeElement,e),this.instance.setData(this.value),this.instance.on("instanceReady",e=>{this._ready=!0,this.ready.emit(e)}),this.instance.on("blur",e=>{this.blur.emit(e),this.onTouched()}),this.instance.on("focus",e=>{this.readonly||this.focus.emit(e)}),this.registerChangeListener()}}writeValue(e){this._value=e,this.destroyed$.closed||(0,m.H)(0).pipe((0,_.R)(this.destroyed$)).subscribe(()=>{var t;this.instance?(null===(t=this.onDataChangeListener)||void 0===t||t.removeListener(),this.instance.setData(e,()=>{this.registerChangeListener()})):this.host.nativeElement.value=e})}onChange(e){}onTouched(){}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouched=e}setDisabledState(e){this.readonly=e,this.disabled.next(e),this._ready?this.instance&&this.instance.setReadOnly(e):this.destroyed$.closed||this.ready.pipe((0,C.q)(1),(0,_.R)(this.destroyed$)).subscribe(()=>{this.instance.setReadOnly(this.readonly)})}getWordAtCursor(){const e=this.instance.getSelection().getRanges(!0)[0];if(!e)return null;const t=this.firstTextNode(e);return(null==t?void 0:t.toReplace)||null}hasActiveSelection(){return!!this.getSelectedText()}getSelectedText(){return this.instance.getSelection().getSelectedText()}replace(e){if(!e)return;if(this.getSelectedText()){const t=this.instance.focus;return this.instance.focus=()=>{},this.instance.insertHtml(e),void(this.instance.focus=t)}const t=this.instance.getSelection().getRanges(!0)[0];if(!t)return void this.instance.insertHtml(e);const i=this.firstTextNode(t);i?this.replaceWord(i,e):this.instance.insertHtml(e),this.updateValue(),this.setFocus()}setFocus(){this.instance?this.instance.focus():this.host.nativeElement.focus()}registerChangeListener(){this.onDataChangeListener=this.instance.on("change",()=>{var e;if(this.debounce){const t=parseInt(this.debounce,10);null===(e=this.debounceTimeout$sub)||void 0===e||e.unsubscribe(),this.debounceTimeout$sub=(0,m.H)(t).pipe((0,_.R)(this.destroyed$)).subscribe(()=>{this.updateValue(),this.debounceTimeout$sub=null})}else this.updateValue()})}hasTextNodeAsChild(e,t=!1){const i=e.getChildren().toArray();if(t)for(let n=i.length-1;n>=0;n--){const e=i[n];if(e.type===CKEDITOR.NODE_TEXT)return e;{const t=this.hasTextNodeAsChild(e);if(t)return t}}else for(const n of i){if(n.type===CKEDITOR.NODE_TEXT)return n;{const e=this.hasTextNodeAsChild(n);if(e)return e}}return null}mergeTextNodeAroundWithDirection(e,t=!1){const i=[];let n=e.getText(),s=e;for(;(s=t?s.getPrevious():s.getNext)&&s.type===CKEDITOR.NODE_TEXT&&!s.getText().charAt(t?s.getText().length-1:0).match(/[\s,;.:!?]/);)t?n=s.getText()+n:n+=s.getText(),i.push(s);i.length>0&&(e.setText(n),i.forEach(e=>e.remove()))}mergeTextNodeAround(e){return this.mergeTextNodeAroundWithDirection(e,!0),this.mergeTextNodeAroundWithDirection(e),e}firstNonEmptyTextNode(e,t=!1){let i=e;for(;i=t?i.getPrevious():i.getNext();){if(i.type!==CKEDITOR.NODE_TEXT)return i;if(""!==i.getText())return i}}trim(e){return e&&(e=e.replace(/[\u200b\u00A0]/g,"").trim()),e}extractFirstWord(e,t=!1){if(!e)return e;if(e.includes(" ")){const i=e.split(" ");return this.trim(i[t?i.length-1:0])}return this.trim(e)}firstTextNodeResult(e,t=!1,i=!1){const n=e.getText();if(this.trim(n)&&this.trim(n.substring(n.length-1))){const n=this.mergeTextNodeAround(e);return{textNode:n,firstNodeIsText:i,toReplace:this.extractFirstWord(n.getText(),t)}}return null}firstTextNodeWithDirection(e,t=!1){const i=e.startContainer;if(t&&i.type===CKEDITOR.NODE_TEXT)return this.firstTextNodeResult(i,t,!0);const n=i.type===CKEDITOR.NODE_TEXT?t&&this.firstNonEmptyTextNode(i,!0)||this.firstNonEmptyTextNode(i):i.getChildren().getItem(e.startOffset-1);if(n){if(n.type===CKEDITOR.NODE_TEXT)return this.firstTextNodeResult(n,t);let e=this.hasTextNodeAsChild(n,t);if(e)return this.firstTextNodeResult(e,t);for(e=n;e=t?e.getPrevious():e.getNext();){if(e.type===CKEDITOR.NODE_TEXT)return this.firstTextNodeResult(e,t);const i=this.hasTextNodeAsChild(e,t);if(i)return this.firstTextNodeResult(i,t)}}return null}firstTextNode(e){let t=this.firstTextNodeWithDirection(e,!0);return t||(t=this.firstTextNodeWithDirection(e)),t}replaceWord(e,t){const i=e.textNode.getText().lastIndexOf(e.toReplace);if(-1!==i){const n=e.textNode.getText().substring(0,i),s=e.textNode.getText().substring(i+e.toReplace.length);e.textNode.setText(n);const o=CKEDITOR.dom.element.createFromHtml(`<span>${CKEDITOR.tools.htmlDecode(CKEDITOR.tools.transformPlainTextToHtml(t,CKEDITOR.ENTER_BR))}</span>`);o.insertAfter(e.textNode),e.textNode.getText().substring(i+e.toReplace.length)&&new CKEDITOR.dom.text(s).insertAfter(o),this.instance.getSelection().selectElement(e.textNode);const r=this.instance.getSelection().getRanges()[0];r.setStartAfter(e.textNode),r.select()}}}return e.\u0275fac=function(t){return new(t||e)(h.Y36(h.R0b),h.Y36(h.sBO),h.Y36(A))},e.\u0275cmp=h.Xpm({type:e,selectors:[["deja-editor"]],viewQuery:function(e,t){if(1&e&&h.Gf(Z,7),2&e){let e;h.iGM(e=h.CRH())&&(t.host=e.first)}},inputs:{config:"config",debounce:"debounce",readonly:"readonly",inline:"inline",value:"value"},outputs:{change:"change",ready:"ready",blur:"blur",focus:"focus",disabled:"disabled"},features:[h._Bn([{provide:s.JU,useExisting:(0,h.Gpc)(()=>e),multi:!0}]),h.qOj,h.TTD],decls:2,vars:0,consts:[[2,"visibility","hidden",3,"onchange"],["host",""]],template:function(e,t){1&e&&(h.TgZ(0,"textarea",0,1),h.NdJ("onchange",function(){return t.textAreaChange()}),h.qZA())},styles:["deja-editor{line-height:normal}deja-editor .cke_textarea_inline>p{margin:0}deja-editor .cke_textarea_inline:focus{outline:none}"],encapsulation:2,changeDetection:0}),e})(),D=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=h.oAB({type:e}),e.\u0275inj=h.cJS({providers:[A],imports:[[n.ez]]}),e})(),O=0,R=(()=>{class e extends E.VG{constructor(e,t,i,n,s,o){super(s,i,n,t),this.editor=e,this.ngControl=t,this.hostElement=o,this.describedBy="",this.stateChanges=new T.xQ,this.controlType="app-editor",this._disabled=!1,this._uid="mat-input-"+O++,this._required=!1}get id(){return this._id}set id(e){this._id=e||this._uid}get required(){return this._required}set required(e){this._required=(0,u.Ig)(e)}get disabled(){var e;return null!==(null===(e=this.ngControl)||void 0===e?void 0:e.disabled)?this.ngControl.disabled:this._disabled}set disabled(e){this._disabled=(0,u.Ig)(e),this.focused&&(this.focused=!1,this.stateChanges.next())}onContainerClick(){this.editor.setFocus()}setDescribedByIds(e){this.describedBy=e.join(" ")}ngOnInit(){this.editor.focus.subscribe(()=>{this.focused=!0,this.stateChanges.next()}),this.editor.blur.subscribe(()=>{this.focused=!1,this.stateChanges.next()}),this.editor.change.subscribe(()=>{this.stateChanges.next()}),this.generatePlaceholder()}ngDoCheck(){this.ngControl&&this.updateErrorState()}ngOnDestroy(){this.stateChanges.complete()}get empty(){return!this.editor.value}get shouldLabelFloat(){return this.focused||!this.empty?(this.empty?this.attachPlaceholder():this.detachPlaceholder(),!0):(this.detachPlaceholder(),!1)}attachPlaceholder(){this._placeholder&&!this._placeholder.parentElement&&this.hostElement.nativeElement.appendChild(this._placeholder)}detachPlaceholder(){var e;(null===(e=this._placeholder)||void 0===e?void 0:e.parentElement)&&this._placeholder.remove()}generatePlaceholder(){if(this.placeholder){this._placeholder=document.createElement("div"),this._placeholder.style.position="absolute",this._placeholder.style.position="absolute",this._placeholder.style.left="0",this._placeholder.style.boxSizing="content-box",this._placeholder.style.width="100%",this._placeholder.style.height="100%",this._placeholder.style.overflow="hidden",this._placeholder.style.pointerEvents="none",this._placeholder.style.top="-0.84375em",this._placeholder.style.paddingTop="0.84375em";const e=document.createElement("div");e.style.color="rgba(0,0,0,0.54)",e.style.top="1.28125em",e.style.position="absolute";const t=document.createTextNode(this.placeholder);e.appendChild(t),this._placeholder.appendChild(e)}}}return e.\u0275fac=function(t){return new(t||e)(h.Y36(N,2),h.Y36(s.a5,10),h.Y36(s.F,8),h.Y36(s.sg,8),h.Y36(v.rD),h.Y36(h.SBq,1))},e.\u0275dir=h.lG2({type:e,selectors:[["deja-editor"]],hostVars:1,hostBindings:function(e,t){2&e&&h.uIk("aria-describedby",t.describedBy)},inputs:{placeholder:"placeholder",id:"id",required:"required",disabled:"disabled"},features:[h._Bn([{provide:a.Eo,useExisting:e}]),h.qOj]}),e})(),I=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=h.oAB({type:e}),e.\u0275inj=h.cJS({imports:[[D,a.lN]]}),e})();var q=i(7631),w=i(71398),M=i(50246);const j=["replaceEditor"];function k(e,t){1&e&&(h.TgZ(0,"mat-card",5),h._UZ(1,"deja-markdown",6),h.qZA()),2&e&&(h.xp6(1),h.Q6J("url","https://raw.githubusercontent.com/DSI-HUG/dejajs-components/develop/projects/deja-js/component/editor/readme.md"))}function S(e,t){if(1&e){const e=h.EpF();h.TgZ(0,"div"),h.TgZ(1,"mat-card",7),h.TgZ(2,"mat-toolbar",8),h._uU(3,"Inline CKEditor with material skin"),h.qZA(),h.TgZ(4,"mat-card-content"),h.TgZ(5,"div",9),h.TgZ(6,"div",10),h.TgZ(7,"h3"),h._uU(8,"Editor :"),h.qZA(),h.TgZ(9,"mat-form-field"),h.TgZ(10,"deja-editor",11),h.NdJ("ngModelChange",function(t){return h.CHM(e),h.oxw().matText=t}),h.qZA(),h.qZA(),h.qZA(),h.TgZ(11,"div",10),h.TgZ(12,"h3"),h._uU(13,"Result :"),h.qZA(),h._UZ(14,"div",12),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(15,"mat-card",7),h.TgZ(16,"mat-toolbar",8),h._uU(17,"Default CKEditor"),h.qZA(),h.TgZ(18,"mat-card-content"),h.TgZ(19,"div",9),h.TgZ(20,"div",10),h.TgZ(21,"h3"),h._uU(22,"Editor :"),h.qZA(),h.TgZ(23,"deja-editor",13),h.NdJ("ngModelChange",function(t){return h.CHM(e),h.oxw().matText=t}),h.qZA(),h.qZA(),h.TgZ(24,"div",10),h.TgZ(25,"h3"),h._uU(26,"Result :"),h.qZA(),h._UZ(27,"div",12),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(28,"mat-card",7),h.TgZ(29,"mat-toolbar",8),h._uU(30,"Replace"),h.qZA(),h.TgZ(31,"mat-card-content"),h.TgZ(32,"div",9),h.TgZ(33,"div",10),h.TgZ(34,"h3"),h._uU(35,"Editor :"),h.qZA(),h._UZ(36,"deja-editor",14,15),h.qZA(),h.TgZ(38,"div",10),h.TgZ(39,"h3"),h._uU(40,"Actions :"),h.qZA(),h.TgZ(41,"div"),h.TgZ(42,"mat-form-field"),h.TgZ(43,"input",16),h.NdJ("ngModelChange",function(t){return h.CHM(e),h.oxw().replaceWith=t}),h.qZA(),h.qZA(),h.TgZ(44,"button",17),h.NdJ("click",function(){return h.CHM(e),h.oxw().replace()}),h._uU(45,"Replace"),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA()}if(2&e){const e=h.oxw();h.xp6(10),h.Q6J("ngModel",e.matText)("config",e.editorConfig),h.xp6(4),h.Q6J("innerHTML",e.matText,h.oJD),h.xp6(9),h.Q6J("ngModel",e.matText)("config",e.editorConfig)("inline",!1),h.xp6(4),h.Q6J("innerHTML",e.matText,h.oJD),h.xp6(9),h.Q6J("config",e.editorConfig)("inline",!1),h.xp6(7),h.Q6J("ngModel",e.replaceWith)}}const P=w.Bz.forChild([{path:"",component:(()=>{class e{constructor(){this.tabIndex=1,this.editorConfig={}}ngOnInit(){this.matText="<b>Inline Editor</b> <ul><li>First item</li><li>Second item</li><ul>",this.editorConfig.extraPlugins="colorbutton,autogrow",this.editorConfig.on={instanceReady:function(){this.dataProcessor.writer.indentationChars="",this.dataProcessor.writer.lineBreakChars=""}},this.editorConfig.title="",this.editorConfig.disableNativeSpellChecker=!0,this.editorConfig.scayt_autoStartup=!0,this.editorConfig.scayt_sLang="fr_FR",this.editorConfig.wsc_lang="fr_FR",this.editorConfig.scayt_disableOptionsStorage="all",this.editorConfig.language="fr",this.editorConfig.enterMode=3,this.editorConfig.contentsCss=["assets/ckeditor/contents.css"],this.editorConfig.autoGrow_onStartup=!0,this.editorConfig.coreStyles_bold={element:"b",overrides:{strong:!0}},this.editorConfig.coreStyles_italic={element:"i",overrides:{em:!0}}}replace(){this.replaceEditor.replace(this.replaceWith)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=h.Xpm({type:e,selectors:[["deja-editor-demo"]],viewQuery:function(e,t){if(1&e&&h.Gf(j,5),2&e){let e;h.iGM(e=h.CRH())&&(t.replaceEditor=e.first)}},decls:5,vars:3,consts:[[3,"selectedIndex","selectedTabChange"],["label","API REFERENCE"],["label","EXAMPLES"],["class","demo-card demo-basic",4,"ngIf"],[4,"ngIf"],[1,"demo-card","demo-basic"],[3,"url"],[1,"demo-card"],["color","primary"],[1,"flexLayout"],[1,"flexAuto"],[3,"ngModel","config","ngModelChange"],[3,"innerHTML"],[1,"inline",3,"ngModel","config","inline","ngModelChange"],[1,"inline",3,"config","inline"],["replaceEditor",""],["matInput","",3,"ngModel","ngModelChange"],["mat-raised-button","",3,"click"]],template:function(e,t){1&e&&(h.TgZ(0,"mat-tab-group",0),h.NdJ("selectedTabChange",function(e){return t.tabIndex=e.index}),h._UZ(1,"mat-tab",1),h._UZ(2,"mat-tab",2),h.qZA(),h.YNc(3,k,2,1,"mat-card",3),h.YNc(4,S,46,10,"div",4)),2&e&&(h.Q6J("selectedIndex",t.tabIndex),h.xp6(3),h.Q6J("ngIf",0===t.tabIndex),h.xp6(1),h.Q6J("ngIf",1===t.tabIndex))},directives:[l.SP,l.uX,n.O5,r.a8,M.F,c.Ye,r.dn,a.KE,R,N,s.JJ,s.On,d.Nt,s.Fj,o.lW],styles:["[_nghost-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:90%}[_nghost-%COMP%]   deja-editor.inline[_ngcontent-%COMP%]{width:90%;display:block}[_nghost-%COMP%]   .flexLayout[_ngcontent-%COMP%]{display:flex}[_nghost-%COMP%]   .flexLayout[_ngcontent-%COMP%]   .flexAuto[_ngcontent-%COMP%]{flex:1 1 0}"]}),e})()},{path:"**",redirectTo:"",pathMatch:"full"}]);let J=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=h.oAB({type:e}),e.\u0275inj=h.cJS({providers:[],imports:[[n.ez,s.u5,o.ot,r.QW,a.lN,d.c,l.Nh,c.g0,I,q.O,P]]}),e})()}}]);