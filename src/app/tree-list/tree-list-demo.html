<mat-tab-group [selectedIndex]="tabIndex" (selectedTabChange)="tabIndex = $event.index">
    <mat-tab label="API REFERENCE"></mat-tab>
    <mat-tab label="SIMPLE EXAMPLES"></mat-tab>
    <mat-tab label="ADVANCED EXAMPLES"></mat-tab>
    <mat-tab label="TEMPLATING"></mat-tab>
    <mat-tab label="PRE-SELECTIONS"></mat-tab>
    <mat-tab label="PRE-EVENTS AND ON_DEMAND"></mat-tab>
    <mat-tab label="PERFORMANCES"></mat-tab>
    <mat-tab label="REACTIVE FORM"></mat-tab>
</mat-tab-group>

<deja-dialog *ngIf="dialogVisible">
    <deja-message-box type="primary" title="Confirm">
        Please confirm your operation!
        <ng-template #actionsTemplate>
            <button id="cancelbtn" mat-raised-button (click)="dialogResponse$.next('cancel')">Cancel</button>
            <button id="okbtn" mat-raised-button color="primary" (click)="dialogResponse$.next('ok')">Ok</button>
        </ng-template>
    </deja-message-box>
</deja-dialog>

<mat-card appearance="outlined" class="demo-card demo-basic" *ngIf="tabIndex === 0">
    <deja-markdown [url]="'https://raw.githubusercontent.com/DSI-HUG/dejajs-components/develop/projects/deja-js/component/tree-list/readme.md'"></deja-markdown>
</mat-card>

<div *ngIf="tabIndex === 1">
    <mat-card appearance="outlined" class="deja-treelist-demo demo-card demo-basic">
        <mat-toolbar color="primary">Simple Usage</mat-toolbar>
        <mat-card-content>
            <div>Just passing an array of objects</div>
            <div class="flexLayout">
                <span class="flex45p flexLayout flexColumn">
                    <deja-tree-list [(ngModel)]="country" textField="naqme" valueField="code" [models]="countries$ | async"></deja-tree-list>
                </span>
                <span class="flex45p flexOffset5p">
                    <h4>Selected country model :</h4>
                    <pre>{{country | json}}</pre>
                </span>
            </div>
        </mat-card-content>
    </mat-card>
    <mat-card appearance="outlined" class="deja-treelist-demo demo-card demo-basic">
        <mat-toolbar color="primary">Keyboard Navigation</mat-toolbar>
        <mat-card-content>
            <div>deja-tree-list has some keyboard navigation feature</div>
            <div class="flexLayout">
                <span class="flex45p flexLayout flexColumn">
                    <deja-tree-list class="flex50p" [(ngModel)]="country" textField="naqme" valueField="code" [models]="countries$ | async"></deja-tree-list>
                </span>
                <ul class="flexOffset5p" id="shortcut-list">
                    <li>Press
                        <span class="keyboard-key">↑</span> to select the previous item</li>
                    <li>Press
                        <span class="keyboard-key">↓</span> to select the next item</li>
                    <li>Press
                        <span class="keyboard-key">Ctrl</span>
                        <span class="keyboard-key">↑</span> to change the current item to the previous</li>
                    <li>Press
                        <span class="keyboard-key">Ctrl</span>
                        <span class="keyboard-key">↓</span> to change the current item to the next</li>
                    <li>Press
                        <span class="keyboard-key">Shift</span>
                        <span class="keyboard-key">↑</span> to change the current item to the previous</li>
                    <li>Press
                        <span class="keyboard-key">Shift</span>
                        <span class="keyboard-key">↓</span> to change the current item to the next</li>
                    <li>Press
                        <span class="keyboard-key">PageUp</span> to select the next page item</li>
                    <li>Press
                        <span class="keyboard-key">PageDown</span> to select the previous page item</li>
                    <li>Press
                        <span class="keyboard-key">Home</span> to select the first item</li>
                    <li>Press
                        <span class="keyboard-key">End</span> to select the last item</li>
                    <li>Press
                        <span class="keyboard-key">Space</span> to collapse/expand a group header or to select/unselect the current item</li>
                    <li>Press
                        <span class="keyboard-key">A</span>..
                        <span class="keyboard-key">Z</span>
                        <span class="keyboard-key">0</span>..
                        <span class="keyboard-key">9</span> to select the next item started with the pressed key</li>
                </ul>
            </div>
        </mat-card-content>
    </mat-card>
    <mat-card appearance="outlined" class="deja-treelist-demo demo-card demo-basic">
        <mat-toolbar color="primary">Treelist with options</mat-toolbar>
        <mat-card-content>
            <div>These treelists has a list coming from html options</div>
            <span class="flexLayout">
                <deja-tree-list class="flex45p demo-half-width optionstl" [(ngModel)]="fruct">
                    <deja-item value="Apricots" text="My preferred fruct is Apricots"></deja-item>
                    <deja-item value="Banana" text="My preferred fruct is Banana"></deja-item>
                    <deja-item value="Cantaloupe" text="My preferred fruct is Cantaloupe"></deja-item>
                    <deja-item value="Cherries" text="My preferred fruct is Cherries"></deja-item>
                    <deja-item value="Coconut" text="My preferred fruct is Coconut"></deja-item>
                    <deja-item value="Cranberries" text="My preferred fruct is Cranberries"></deja-item>
                    <deja-item value="Durian" text="My preferred fruct is Durian"></deja-item>
                    <deja-item value="Grapes" text="My preferred fruct is Grapes"></deja-item>
                    <deja-item value="Lemon" text="My preferred fruct is Lemon"></deja-item>
                    <deja-item value="Mango" text="My preferred fruct is Mango"></deja-item>
                    <deja-item value="Pineapple" text="My preferred fruct is Pineapple"></deja-item>
                    <deja-item value="Watermelon" text="My preferred fruct is Watermelon"></deja-item>
                </deja-tree-list>
                <deja-tree-list class="flex45p flexOffset5p demo-half-width optionstl" multiSelect="true" [selectedModels]="['Mango', 'Apricots', 'Coconut']">
                    <deja-item value="apricots" text="Apricots"></deja-item>
                    <deja-item value="banana" text="Banana"></deja-item>
                    <deja-item value="cantaloupe" text="Cantaloupe"></deja-item>
                    <deja-item value="cherries" text="Cherries"></deja-item>
                    <deja-item value="coconut" text="Coconut"></deja-item>
                    <deja-item value="cranberries" text="Cranberries"></deja-item>
                    <deja-item value="durian" text="Durian"></deja-item>
                    <deja-item value="grapes" text="Grapes"></deja-item>
                    <deja-item value="lemon" text="Lemon"></deja-item>
                    <deja-item value="mango" text="Mango"></deja-item>
                    <deja-item value="pineapple" text="Pineapple"></deja-item>
                    <deja-item value="watermelon" text="Watermelon"></deja-item>
                </deja-tree-list>
            </span>
        </mat-card-content>
    </mat-card>
    <mat-card appearance="outlined" class="deja-treelist-demo demo-card demo-basic">
        <mat-toolbar color="primary">String Array Model</mat-toolbar>
        <mat-card-content>
            <span class="flexLayout flexAlignCenter flexJustifyStart">
                <deja-tree-list class="demo-half-width" [(ngModel)]="fruct" [models]="fructs"></deja-tree-list>
                <span class="flex50p flexOffset5p">Selected fruct model is: {{ fruct }}</span>
            </span>
        </mat-card-content>
    </mat-card>
    <mat-card appearance="outlined" class="deja-treelist-demo demo-card demo-basic">
        <mat-toolbar color="primary">Disabled tree-list</mat-toolbar>
        <mat-card-content>
            <div>
                <mat-checkbox [(ngModel)]="disabled" color="primary">Check me to disable tree-list below</mat-checkbox>
            </div>
            <div class="flexLayout">
                <span class="flex45p flexLayout flexColumn">
                    <deja-tree-list searchArea nodataholder="No record to display" maxHeight="auto" [disabled]="disabled" selectionClearable [(ngModel)]="deepCountry" textField="l1.l2.name" valueField="l1.l2.value" [models]="deepCountries$ | async"></deja-tree-list>
                </span>
                <span class="flex45p flexOffset5p">
                    <h4>Selected deep country model :</h4>
                    <pre>{{deepCountry | json}}</pre>
                </span>
            </div>
        </mat-card-content>
    </mat-card>
    <mat-card appearance="outlined" class="deja-treelist-demo demo-card demo-basic">
        <mat-toolbar color="primary">Multi level</mat-toolbar>
        <mat-card-content>
            <div class="flexLayout">
                <span class="flex45p flexLayout flexColumn">
                    <deja-tree-list nodataholder="No record to display" maxHeight="auto" [models]="folders" textField="label" childrenField="children"></deja-tree-list>
                </span>
            </div>
        </mat-card-content>
    </mat-card>
</div>

<div *ngIf="tabIndex === 2">
    <mat-card appearance="outlined" class="deja-treelist-demo demo-card demo-basic">
        <mat-toolbar color="primary">Multi selection</mat-toolbar>
        <mat-card-content>
            <div>Multi selection example</div>
            <div class="flexLayout">
                <span class="flex45p flexLayout flexColumn">
                    <deja-tree-list sortable multiSelect textField="naqme" valueField="code" [selectedItems]="multiselectModel" (itemDragStart)="onItemDragStart($event)" (selectedChange)="multiselectModelChange($any($event).items)" [items]="countriesForMultiselect">
                    </deja-tree-list>
                </span>
                <span class="flexLayout flexColumn flex45p flexOffset5p">
                    <h4>Multi selection shortcuts :</h4>
                    <ul id="shortcut-list">
                        <li>Press
                            <span class="keyboard-key">Ctrl</span>
                            <span class="keyboard-key">Space</span> to add/remove the current item to the selection</li>
                        <li>Press
                            <span class="keyboard-key">Shift</span>
                            <span class="keyboard-key">↑</span> to select a range orf items</li>
                        <li>Press
                            <span class="keyboard-key">Shift</span>
                            <span class="keyboard-key">↓</span> to select a range orf items</li>
                    </ul>
                    <h4>Selected country model :</h4>
                    <ul>
                        <li *ngFor="let item of multiselectModel">
                            <span>{{ $any(item).naqme }}</span>
                        </li>
                    </ul>
                </span>
            </div>
        </mat-card-content>
        <mat-toolbar color="primary">Grouping and Drag Drop</mat-toolbar>
        <mat-card-content>
            <div>Grouping example</div>
            <div class="flexLayout">
                <span class="flex45p flexLayout flexColumn">
                    <deja-tree-list textField="naqme" valueField="code" [items]="groupedCountries" [deja-mouse-draggable]="getDragContext()">
                        <ng-template #itemTemplate let-item let-flatindex="flatindex">
                            <span [attr.ddid]="item.model.code">{{ item.model.naqme }}</span>
                        </ng-template>
                        <ng-template #parentItemTemplate let-item>
                            <mat-icon id="placeholder-icon">public</mat-icon>&nbsp;
                            <span>{{ item.groupName }}</span>
                        </ng-template>
                    </deja-tree-list>
                </span>
                <span class="flex45p flexOffset5p">
                    <div>You can drag and drop items the the area bellow (That will display a JSON representation of the dropped model) :</div>
                    <div #dropArea [deja-mouse-droppable]="getDropContext(dropArea)" [deja-droppable]="{dragovercallback: onDivDragOver, dragentercallback:onDivDragOver, dropcallback:onDivDropEvent}" style="border:1px solid red;min-height:150px;"></div>
                </span>
            </div>
        </mat-card-content>
        <mat-toolbar color="primary">Autocomplete</mat-toolbar>
        <mat-card-content>
            <div>Autocomplete 2 characters minimum</div>
            <deja-tree-list class="demo-half-width" nodataholder="No record to display" [itemListService]="countriesListService" textField="naqme" valueField="code" min-search-length="2"></deja-tree-list>
        </mat-card-content>
        <mat-toolbar color="primary">Variable Row Size</mat-toolbar>
        <mat-card-content>
            <div>Variable Row height example</div>
            <div class="flexLayout">
                <span class="flex45p flexLayout flexColumn">
                    <deja-tree-list [items]="loremList" multiSelect viewportMode="variable" searchArea sortable></deja-tree-list>
                </span>
            </div>
        </mat-card-content>
    </mat-card>
</div>

<div *ngIf="tabIndex === 3">
    <mat-card appearance="outlined" class="deja-treelist-demo demo-card demo-basic">
        <mat-toolbar color="primary">Templating Examples</mat-toolbar>
        <mat-card-content>
            <h1>Item Template</h1>
            <div>An exemple with auto sized item template</div>
            <deja-tree-list #news class="news" viewportMode="auto" textField="title" searchField="description" [models]="news$">
                <ng-template #itemTemplate let-item let-flatindex="flatindex">
                    <news-card [item]="item.model" (imageLoaded)="imageLoaded(item)"></news-card>
                </ng-template>
            </deja-tree-list>
            <h1>Header Template and Group Template</h1>
            <div>Treelist with an header template</div>
            <div class="flexLayout">
                <span class="flex45p flexLayout flexColumn">
                    <deja-tree-list #headertreelist textField="naqme" valueField="code" [models]="countries$ | async">
                        <ng-template #headerTemplate>
                            <span id="headerTemplateContent" (click)="headertreelist.sort()">
                                <span id="title">
                                    This is a header template, click to sort the list.
                                </span>
                                <deja-sort-indicator [sort-infos]="headertreelist.sortInfos"></deja-sort-indicator>
                            </span>
                        </ng-template>
                    </deja-tree-list>
                </span>
                <span class="flex45p flexLayout flexColumn flexOffset5p">
                    <deja-tree-list textField="naqme" [items]="groupedCountries">
                        <ng-template #parentItemTemplate let-item>
                            <mat-icon id="placeholder-icon">public</mat-icon>&nbsp;
                            <span>{{ item.groupName }}</span>
                        </ng-template>
                    </deja-tree-list>
                </span>
            </div>
            <h1>Search Prefix and Suffix Templates</h1>
            <div class="flexLayout">
                <span class="flex45p flexLayout flexColumn">
                    <deja-tree-list searchArea textField="naqme" valueField="code" [items]="countries$ | async">
                        <ng-template #searchPrefixTemplate>
                            <mat-icon (click)="onFilterTemplateClicked('Prefix')">public</mat-icon>
                        </ng-template>
                        <ng-template #searchSuffixTemplate>
                            <mat-icon (click)="onFilterTemplateClicked('Suffix')">more_vert</mat-icon>
                        </ng-template>
                    </deja-tree-list>
                </span>
            </div>
        </mat-card-content>
    </mat-card>
</div>

<div *ngIf="tabIndex === 4">
    <mat-card appearance="outlined" class="deja-treelist-demo demo-card demo-basic">
        <mat-toolbar color="primary">Pre-Selections from html inputs</mat-toolbar>
        <mat-card-content>
            <div class="flexLayout">
                <div class="flexFixed140px flexLayout flexColumn">
                    <div>Preselection with the input selectedModel</div>
                    <deja-tree-list class="fixed-height" selectedModel="Mango" [models]="fructs"></deja-tree-list>
                </div>
                <div class="flexFixed140px flexLayout flexColumn flexOffset15px">
                    <div>Preselections with the input selectedModels</div>
                    <deja-tree-list class="fixed-height" multiSelect="true" [selectedModels]="['Mango', 'Apricots', 'Coconut']" [models]="fructs"></deja-tree-list>
                </div>
            </div>
            <div class="flexLayout">
                <div class="flexFixed140px flexLayout flexColumn">
                    <div>Preselection with the input selectedItem</div>
                    <deja-tree-list class="fixed-height" selectedItem="mango" [items]="fructItems"></deja-tree-list>
                </div>
                <div class="flexFixed140px flexOffset15px">
                </div>
            </div>
        </mat-card-content>

        <mat-toolbar color="primary">Pre-Selections from javascript</mat-toolbar>
        <mat-card-content>
            <div>The collection fructItemsWithPreSelection has a pre-selected item</div>
            <deja-tree-list class="fixed-height" [items]="fructItemsWithPreSelection"></deja-tree-list>
        </mat-card-content>
    </mat-card>
</div>


<div *ngIf="tabIndex === 5">
    <mat-card appearance="outlined" class="deja-treelist-demo demo-card demo-basic">
        <mat-toolbar color="primary">Pre-Events and on Demand</mat-toolbar>
        <mat-card-content>
            <h1>On Demand Loading </h1>
            <div>The items are loaded from the loading event</div>
            <deja-tree-list #ondemand class="demo-half-width fixed-height" textField="naqme" valueField="code" [loadingItems]="loadingItems()"></deja-tree-list>
            <h1>Confirm Selection</h1>
            <div>A dialog will confirm the selection of an item</div>
            <deja-tree-list class="demo-half-width fixed-height" multiSelect textField="naqme" valueField="code" [selectingItem]="confirmDialog()" [items]="countries$ | async"> </deja-tree-list>
            <h1>Confirm Expand and Collapse </h1>
            <div>A dialog will confirm the expand and collapse or an item if the children are not loaded. The children will be loaded asynchronously after the item expansion.</div>
            <deja-tree-list #onexpand class="demo-half-width fixed-height" textField="naqme" valueField="code" [items]="onDemandGroupedCountries" [expandingItem]="expandingItems()" [collapsingItem]="collapsingItems()"></deja-tree-list>
        </mat-card-content>
    </mat-card>
</div>

<div *ngIf="tabIndex === 6">
    <mat-card appearance="outlined" class="deja-treelist-demo demo-card demo-basic">
        <mat-toolbar color="primary">Performance Examples</mat-toolbar>
        <mat-card-content>
            <h1>10K items with Item Template </h1>
            <div class="flexContainer flexLayout flexAlignCenter flexJustifyStart">
                <span class="flexExtendCollapseAuto">An exemple with 10000 auto sized templatized items</span>
                <mat-form-field class="flexFixedAuto">
                    <input matInput type="number" [(ngModel)]="ensureIndex" autocomplete="off">
                </mat-form-field>
                <button class="flexFixedAuto" mat-button (click)="news.ensureItemVisible(ensureIndex)">Ensure index</button>
            </div>
            <deja-tree-list #news class="news" viewportMode="auto" textField="title" searchField="description" [models]="bigNews$">
                <ng-template #itemTemplate let-item let-flatindex="flatindex">
                    <news-card [item]="item.model" (imageLoaded)="imageLoaded(item)"></news-card>
                </ng-template>
            </deja-tree-list>

            <h1>Fixed size rows 100K items</h1>
            <div>An exemple with 100000 fixed size items</div>
            <span class="flexLayout">
                <deja-tree-list #bigCountries id="bigCountries" class="flex45p" [items]="bigCountries$" textField="naqme" valueField="code"></deja-tree-list>
                <span class="flex45p flexOffset5p">
                    <h4 id="vptitle">Viewport Infos:</h4>
                    <div *ngFor="let info of viewPortInfos">
                        <span class="vpinfoname">{{info.name}}</span>
                        <span>{{info.value}}</span>
                    </div>
                </span>
            </span>
        </mat-card-content>
    </mat-card>
</div>

<div *ngIf="tabIndex === 7">
    <mat-card appearance="outlined" class="deja-treelist-demo demo-card demo-basic">
        <mat-toolbar color="primary">Single selection</mat-toolbar>
        <mat-card-content>
            <form novalidate [formGroup]="fruitForm">
                <div class="flexLayout">
                    <span class="flex45p flexLayout flexColumn">
                        <deja-tree-list [models]="fruits$" formControlName="fruitName"></deja-tree-list>
                    </span>
                    <span class="flex45p flexOffset5p">
                        <h4>Your selection :</h4>
                        <span>{{fruitForm.get('fruitName').value}}</span>
                    </span>
                </div>
            </form>
        </mat-card-content>
    </mat-card>

    <mat-card appearance="outlined" class="deja-treelist-demo demo-card demo-basic">
        <mat-toolbar color="primary">Multi selection</mat-toolbar>
        <mat-card-content>
            <form novalidate [formGroup]="fruitFormModels">
                <div class="flexLayout">
                    <span class="flex45p flexLayout flexColumn">
                        <deja-tree-list multiSelect [models]="fruits$" formControlName="fruitName"></deja-tree-list>
                    </span>
                    <span class="flex45p flexOffset5p">
                        <h4>Your selection :</h4>
                        <span>{{fruitFormModels.get('fruitName').value}}</span>
                    </span>
                </div>
            </form>
        </mat-card-content>
    </mat-card>
</div>